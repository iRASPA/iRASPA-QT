/********************************************************************************************************************
    iRASPA: GPU-accelated visualisation software for materials scientists
    Copyright (c) 2016-2021 David Dubbeldam, Sofia Calero, Thijs J.H. Vlugt.
    D.Dubbeldam@uva.nl            https://www.uva.nl/en/profile/d/u/d.dubbeldam/d.dubbeldam.html
    S.Calero@tue.nl               https://www.tue.nl/en/research/researchers/sofia-calero/
    t.j.h.vlugt@tudelft.nl        http://homepage.tudelft.nl/v9k6y

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
 ********************************************************************************************************************/

#include "openglenergyvolumerenderedsurface.h"
#include "glgeterror.h"
#include "cubegeometry.h"
#include "rkrenderuniforms.h"
#include <QDebug>

OpenGLEnergyVolumeRenderedSurface::OpenGLEnergyVolumeRenderedSurface()
{

}

void OpenGLEnergyVolumeRenderedSurface::setLogReportingWidget(LogReporting *logReporting)
{
  _logReporter = logReporting;
}

void OpenGLEnergyVolumeRenderedSurface::invalidateIsosurface(std::vector<std::shared_ptr<RKRenderObject>> structures)
{
  for(const std::shared_ptr<RKRenderObject> &structure : structures)
  {
    for(QCache<RKRenderObject*, std::vector<float4>> & cache: _caches)
    {
      cache.remove(structure.get());
    }
  }
}

void OpenGLEnergyVolumeRenderedSurface::deleteBuffers()
{
  for(size_t i=0;i<_renderStructures.size();i++)
  {
    int size = static_cast<GLsizei>(_renderStructures[i].size());
    glDeleteBuffers(size, _vertexBuffer[i].data());
    glDeleteBuffers(size, _indexBuffer[i].data());

    glDeleteVertexArrays(size, _vertexArrayObject[i].data());

    glDeleteTextures(size, _volumeTextures[i].data());
  }
}

void OpenGLEnergyVolumeRenderedSurface::generateBuffers()
{
  _numberOfIndices.resize(_renderStructures.size());

  _volumeTextures.resize(_renderStructures.size());

  _vertexBuffer.resize(_renderStructures.size());
  _indexBuffer.resize(_renderStructures.size());

  _vertexArrayObject.resize(_renderStructures.size());

  for(size_t i=0l;i<_renderStructures.size();i++)
  {
    _numberOfIndices[i].resize(_renderStructures[i].size());

    _volumeTextures[i].resize(_renderStructures[i].size());

    _vertexBuffer[i].resize(_renderStructures[i].size());
    _indexBuffer[i].resize(_renderStructures[i].size());

    _vertexArrayObject[i].resize(_renderStructures[i].size());
  }

  for(size_t i=0;i<_renderStructures.size();i++)
  {
    int size = static_cast<GLsizei>(_renderStructures[i].size());
    glGenBuffers(size, _vertexBuffer[i].data());
    glGenBuffers(size, _indexBuffer[i].data());

    glGenTextures(size, _volumeTextures[i].data());

    glGenVertexArrays(size, _vertexArrayObject[i].data());
  }
}

void OpenGLEnergyVolumeRenderedSurface::setRenderStructures(std::vector<std::vector<std::shared_ptr<RKRenderObject>>> structures)
{
  deleteBuffers();
  _renderStructures = structures;
  generateBuffers();
}



void OpenGLEnergyVolumeRenderedSurface::paintGLOpaque(GLuint structureUniformBuffer, GLuint isosurfaceUniformBuffer, GLuint depthTexture)
{
  glEnable(GL_CULL_FACE);
  glCullFace(GL_BACK);

  glDepthMask(GL_TRUE);
  glEnable(GL_BLEND);
  glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_ALPHA);
  glEnable(GL_DEPTH_TEST);
  glEnable(GL_DEPTH_CLAMP);

  glUseProgram(_program);
  check_gl_error();

  int index = 0;
  for(size_t i=0;i<_renderStructures.size();i++)
  {
    for(size_t j=0;j<_renderStructures[i].size();j++)
    {
      if (RKRenderObject* renderStructure = dynamic_cast<RKRenderObject*>(_renderStructures[i][j].get()))
      if (RKRenderVolumetricDataSource* source = dynamic_cast<RKRenderVolumetricDataSource*>(_renderStructures[i][j].get()))
      {
        if (_renderStructures[i][j]->isVisible() && source->drawAdsorptionSurface() &&
            source->adsorptionSurfaceRenderingMethod() == RKEnergySurfaceType::volumeRendering &&
            source->adsorptionVolumeTransferFunction() == RKPredefinedVolumeRenderingTransferFunction::RASPA_PES )
        {
          glActiveTexture(GL_TEXTURE0);
          glBindTexture(GL_TEXTURE_3D, _volumeTextures[i][j]);
          check_gl_error();
          glUniform1i(_volumeTextureUniformLocation, 0);
          check_gl_error();

          glActiveTexture(GL_TEXTURE1);
          glBindTexture(GL_TEXTURE_2D, depthTexture);
          check_gl_error();
          glUniform1i(_depthTextureUniformLocation, 1);
          check_gl_error();


          glActiveTexture(GL_TEXTURE2);
          glBindTexture(GL_TEXTURE_1D_ARRAY, _transferFunctionTexture);
          check_gl_error();
          glUniform1i(_transferFunctionUniformLocation, 2);
          check_gl_error();

          glBindBufferRange(GL_UNIFORM_BUFFER, 1, structureUniformBuffer, static_cast<GLintptr>(index * sizeof(RKStructureUniforms)), sizeof(RKStructureUniforms));
          glBindBufferRange(GL_UNIFORM_BUFFER, 2, isosurfaceUniformBuffer, static_cast<GLintptr>(index * sizeof(RKIsosurfaceUniforms)), sizeof(RKIsosurfaceUniforms));
          check_gl_error();

          glBindVertexArray(_vertexArrayObject[i][j]);
          check_gl_error();
          glDrawElements(GL_TRIANGLE_STRIP, static_cast<GLsizei>(_numberOfIndices[i][j]), GL_UNSIGNED_SHORT, nullptr);
          check_gl_error();
          glBindVertexArray(0);
        }
      }
      index++;
    }
  }
  glUseProgram(0);

  glDisable(GL_BLEND);
  glDepthMask(GL_TRUE);
  glEnable(GL_DEPTH_TEST);
  glDisable(GL_DEPTH_CLAMP);
}

void OpenGLEnergyVolumeRenderedSurface::paintGLTransparent(GLuint structureUniformBuffer, GLuint isosurfaceUniformBuffer, GLuint depthTexture)
{
  glEnable(GL_CULL_FACE);
  glCullFace(GL_BACK);

  glDepthMask(GL_FALSE);
  glEnable(GL_BLEND);
  glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_ALPHA);
  glDisable(GL_DEPTH_TEST);
  glEnable(GL_DEPTH_CLAMP);

  glUseProgram(_program);
  check_gl_error();

  int index = 0;
  for(size_t i=0;i<_renderStructures.size();i++)
  {
    for(size_t j=0;j<_renderStructures[i].size();j++)
    {
      if (RKRenderObject* renderStructure = dynamic_cast<RKRenderObject*>(_renderStructures[i][j].get()))
      if (RKRenderVolumetricDataSource* source = dynamic_cast<RKRenderVolumetricDataSource*>(_renderStructures[i][j].get()))
      {
        if (_renderStructures[i][j]->isVisible() && source->drawAdsorptionSurface() &&
            source->adsorptionSurfaceRenderingMethod() == RKEnergySurfaceType::volumeRendering &&
            source->adsorptionVolumeTransferFunction() != RKPredefinedVolumeRenderingTransferFunction::RASPA_PES )
        {
          glActiveTexture(GL_TEXTURE0);
          glBindTexture(GL_TEXTURE_3D, _volumeTextures[i][j]);
          check_gl_error();
          glUniform1i(_volumeTextureUniformLocation, 0);
          check_gl_error();

          glActiveTexture(GL_TEXTURE1);
          glBindTexture(GL_TEXTURE_2D, depthTexture);
          check_gl_error();
          glUniform1i(_depthTextureUniformLocation, 1);
          check_gl_error();


          glActiveTexture(GL_TEXTURE2);
          glBindTexture(GL_TEXTURE_1D_ARRAY, _transferFunctionTexture);
          check_gl_error();
          glUniform1i(_transferFunctionUniformLocation, 2);
          check_gl_error();

          glBindBufferRange(GL_UNIFORM_BUFFER, 1, structureUniformBuffer, static_cast<GLintptr>(index * sizeof(RKStructureUniforms)), sizeof(RKStructureUniforms));
          glBindBufferRange(GL_UNIFORM_BUFFER, 2, isosurfaceUniformBuffer, static_cast<GLintptr>(index * sizeof(RKIsosurfaceUniforms)), sizeof(RKIsosurfaceUniforms));
          check_gl_error();

          glBindVertexArray(_vertexArrayObject[i][j]);
          check_gl_error();
          glDrawElements(GL_TRIANGLE_STRIP, static_cast<GLsizei>(_numberOfIndices[i][j]), GL_UNSIGNED_SHORT, nullptr);
          check_gl_error();
          glBindVertexArray(0);
        }
      }
      index++;
    }
  }
  glUseProgram(0);

  glDisable(GL_BLEND);
  glDepthMask(GL_TRUE);
  glEnable(GL_DEPTH_TEST);
  glDisable(GL_DEPTH_CLAMP);
}


void OpenGLEnergyVolumeRenderedSurface::reloadData()
{
  initializeVertexArrayObject();
  initializeTransferFunctionTexture();
}


void OpenGLEnergyVolumeRenderedSurface::initializeTransferFunctionTexture()
{
  glDeleteTextures(1, &_transferFunctionTexture);
  check_gl_error();
  glGenTextures(1, &_transferFunctionTexture);
  check_gl_error();
  glBindTexture(GL_TEXTURE_1D_ARRAY, _transferFunctionTexture);
  glTexParameteri(GL_TEXTURE_1D_ARRAY, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
  glTexParameteri(GL_TEXTURE_1D_ARRAY, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
  glTexParameteri(GL_TEXTURE_1D_ARRAY, GL_TEXTURE_MAG_FILTER, GL_LINEAR);

  glTexImage2D(GL_TEXTURE_1D_ARRAY, 0, GL_RGBA32F, 256, 23, 0, GL_RGBA, GL_FLOAT, nullptr);
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 0, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::RASPA_PES_TransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 1, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::CoolWarmTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 2, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::XrayTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 3, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::GrayTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 4, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::RainbowTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 5, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::TurboTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 6, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::GnuplotTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 7, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::SpectralTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 8, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::CoolTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 9, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::ViridisTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 10, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::PlasmaTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 11, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::InfernoTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 12, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::MagmaTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 13, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::CividisTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 14, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::SpringTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 15, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::SummerTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 16, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::AutumnTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 17, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::WinterTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 18, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::RedsTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 19, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::GreensTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 20, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::BluesTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 21, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::PurplesTransferFunction.data());
  glTexSubImage2D(GL_TEXTURE_1D_ARRAY, 0, 0, 22, 256, 1,  GL_RGBA, GL_FLOAT, OpenGLEnergyVolumeRenderedSurface::OrangesTransferFunction.data());
  glBindTexture(GL_TEXTURE_1D_ARRAY, 0);
}

void OpenGLEnergyVolumeRenderedSurface::initializeVertexArrayObject()
{
  CubeGeometry sphere = CubeGeometry();

  for(size_t i=0;i<_renderStructures.size();i++)
  {
    for(size_t j=0;j<_renderStructures[i].size();j++)
    {
      if (RKRenderObject* renderStructure = dynamic_cast<RKRenderObject*>(_renderStructures[i][j].get()))
      {
        if (RKRenderVolumetricDataSource* source = dynamic_cast<RKRenderVolumetricDataSource*>(_renderStructures[i][j].get()))
        {
          if (source->drawAdsorptionSurface() && source->adsorptionSurfaceRenderingMethod() == RKEnergySurfaceType::volumeRendering )
          {
            int3 dimensions = source->dimensions();
            int largestSize = std::max({dimensions.x,dimensions.y,dimensions.z});
            int powerOfTwo = 1;
            while(largestSize > pow(2,powerOfTwo))
            {
              powerOfTwo += 1;
            }
            int size = pow(2,powerOfTwo);

            std::vector<float4> *textureData{};

            if(_caches[powerOfTwo].contains(_renderStructures[i][j].get()))
            {
               std::clock_t beginTime = clock();
               textureData = _caches[powerOfTwo].object(_renderStructures[i][j].get());
               std::clock_t endTime = clock();
               double elapsedTime = double(endTime - beginTime) * 1000.0 / CLOCKS_PER_SEC;
               _logReporter->logMessage(LogReporting::ErrorLevel::verbose, "Elapsed time for grid-cache lookup " + _renderStructures[i][j]->displayName() + ": " + QString::number(elapsedTime) + " milliseconds.");
            }
            else
            {
              std::clock_t beginTime = clock();

              std::vector<float4> gridData = source->gridValueAndGradientData();
              if (gridData.empty()) return;

              textureData = new std::vector<float4>();
              *textureData = std::move(gridData);

              _caches[powerOfTwo].insert(_renderStructures[i][j].get(),textureData);
              std::clock_t endTime = clock();
              double elapsedTime = double(endTime - beginTime) * 1000.0 / CLOCKS_PER_SEC;
              _logReporter->logMessage(LogReporting::ErrorLevel::verbose, "Elapsed time computing grid " + _renderStructures[i][j]->displayName() + ": " + QString::number(elapsedTime) + " milliseconds.");
            }

            glBindTexture(GL_TEXTURE_3D, _volumeTextures[i][j]);
            glTexParameteri(GL_TEXTURE_3D, GL_TEXTURE_WRAP_S, GL_REPEAT);
            glTexParameteri(GL_TEXTURE_3D, GL_TEXTURE_WRAP_T, GL_REPEAT);
            glTexParameteri(GL_TEXTURE_3D, GL_TEXTURE_WRAP_R, GL_REPEAT);
            glTexParameteri(GL_TEXTURE_3D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
            glTexParameteri(GL_TEXTURE_3D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
            check_gl_error();
            glPixelStorei(GL_UNPACK_ALIGNMENT, 1);  // The array on the host has 1 byte alignment

            glTexImage3D(GL_TEXTURE_3D, 0, GL_RGBA32F, size, size, size, 0, GL_RGBA, GL_FLOAT, textureData->data());
            check_gl_error();
            glBindTexture(GL_TEXTURE_3D, 0);
            check_gl_error();

            glBindVertexArray(_vertexArrayObject[i][j]);
            check_gl_error();

            _numberOfIndices[i][j] = sphere.indices().size();

            glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer[i][j]);
            check_gl_error();

            if(sphere.vertices().size()>0)
            {
              glBufferData(GL_ARRAY_BUFFER, sphere.vertices().size() * sizeof(RKVertex), sphere.vertices().data(), GL_DYNAMIC_DRAW);
            }
            check_gl_error();

            glVertexAttribPointer(_vertexPositionAttributeLocation, 4, GL_FLOAT, GL_FALSE, sizeof(RKVertex), (GLvoid *)offsetof(RKVertex,position));
            check_gl_error();

            glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, _indexBuffer[i][j]);
            check_gl_error();
            if(sphere.indices().size()>0)
            {
              glBufferData(GL_ELEMENT_ARRAY_BUFFER, sphere.indices().size() * sizeof(GLshort), sphere.indices().data(), GL_DYNAMIC_DRAW);
            }
            check_gl_error();

            glEnableVertexAttribArray(_vertexPositionAttributeLocation);
            check_gl_error();

            glBindBuffer(GL_ARRAY_BUFFER, 0);
            glBindVertexArray(0);
          }
        }
      }
    }
  }
}

void OpenGLEnergyVolumeRenderedSurface::loadShader(void)
{
  GLuint vertexShader;
  GLuint fragmentShader;
  vertexShader=compileShaderOfType(GL_VERTEX_SHADER,OpenGLEnergyVolumeRenderedSurface::_vertexShaderSource.c_str());
  fragmentShader=compileShaderOfType(GL_FRAGMENT_SHADER,OpenGLEnergyVolumeRenderedSurface::_fragmentShaderSource.c_str());

  if (0 != vertexShader && 0 != fragmentShader)
  {
    _program = glCreateProgram();
    check_gl_error();

    glAttachShader(_program, vertexShader);
    check_gl_error();
    glAttachShader(_program, fragmentShader);
    check_gl_error();

    glBindFragDataLocation(_program, 0, "vFragColor");

    linkProgram(_program);

    _vertexPositionAttributeLocation = glGetAttribLocation(_program, "vertexPosition");

    _transferFunctionUniformLocation   = glGetUniformLocation(_program, "transferFunction");
    _volumeTextureUniformLocation   = glGetUniformLocation(_program, "volume");
    _depthTextureUniformLocation   = glGetUniformLocation(_program, "depthTexture");

    _stepLengthUniformLocation   = glGetUniformLocation(_program, "step_length");

    if (_vertexPositionAttributeLocation < 0) qDebug() << "Shader did not contain the 'vertexPosition' attribute.";
    if (_transferFunctionUniformLocation < 0) qDebug() << "Shader did not contain the 'transferFunction' uniform.";
    if (_volumeTextureUniformLocation < 0) qDebug() << "Shader did not contain the 'volume' uniform.";

    glDeleteShader(vertexShader);
    check_gl_error();
    glDeleteShader(fragmentShader);
    check_gl_error();
  }
}

void OpenGLEnergyVolumeRenderedSurface::initializeTransformUniforms()
{
  glUniformBlockBinding(_program, glGetUniformBlockIndex(_program, "FrameUniformBlock"), 0);
}

void OpenGLEnergyVolumeRenderedSurface::initializeStructureUniforms()
{
  glUniformBlockBinding(_program, glGetUniformBlockIndex(_program, "StructureUniformBlock"), 1);
}

void OpenGLEnergyVolumeRenderedSurface::initializeIsosurfaceUniforms()
{
  glUniformBlockBinding(_program, glGetUniformBlockIndex(_program, "IsosurfaceUniformBlock"), 2);
  check_gl_error();
}

void OpenGLEnergyVolumeRenderedSurface::initializeLightUniforms()
{
  glUniformBlockBinding(_program, glGetUniformBlockIndex(_program, "LightsUniformBlock"), 3);
}


// Based on: page 168 "Real-Time Volume Graphics", Klaus Engels et al.

const std::string  OpenGLEnergyVolumeRenderedSurface::_vertexShaderSource =
OpenGLVersionStringLiteral +
OpenGLFrameUniformBlockStringLiteral +
OpenGLStructureUniformBlockStringLiteral +
OpenGLIsosurfaceUniformBlockStringLiteral +
OpenGLLightUniformBlockStringLiteral +
R"foo(
in vec4 vertexPosition;

// Inputs from vertex shader
out VS_OUT
{
  smooth vec3 UV;
  smooth vec3 position;
  smooth vec3 L;
  smooth vec4 clipPosition;
} vs_out;

void main()
{
  vec4 pos = structureUniforms.modelMatrix * structureUniforms.boxMatrix * vertexPosition;
  vs_out.position = pos.xyz;
  vs_out.clipPosition = frameUniforms.mvpMatrix * pos;
  vs_out.UV =  vertexPosition.xyz;

  vec4 P = frameUniforms.viewMatrix *  pos;

  // Calculate light vector
  vec4 dir = lightUniforms.lights[0].position - P*lightUniforms.lights[0].position.w;

  gl_Position = frameUniforms.mvpMatrix * pos;
}
)foo";

const std::string  OpenGLEnergyVolumeRenderedSurface::_fragmentShaderSource =
OpenGLVersionStringLiteral +
OpenGLFrameUniformBlockStringLiteral +
OpenGLStructureUniformBlockStringLiteral +
OpenGLIsosurfaceUniformBlockStringLiteral +
OpenGLLightUniformBlockStringLiteral +
R"foo(
out vec4 vFragColor;
// Input from vertex shader

in VS_OUT
{
  smooth vec3 UV;
  smooth vec3 position;
  smooth vec3 L;
  smooth vec4 clipPosition;
} fs_in;

uniform sampler3D volume;
uniform sampler1DArray transferFunction;
uniform sampler2D depthTexture;

// Ray
struct Ray
{
  vec3 origin;
  vec3 direction;
};

// Axis-aligned bounding box
struct AABB
{
  vec3 top;
  vec3 bottom;
};

// Slab method for ray-box intersection
void ray_box_intersection(Ray ray, AABB box, out float t_0, out float t_1)
{
  vec3 direction_inv = 1.0 / ray.direction;
  vec3 t_top = direction_inv * (box.top - ray.origin);
  vec3 t_bottom = direction_inv * (box.bottom - ray.origin);
  vec3 t_min = min(t_top, t_bottom);
  vec2 t = max(t_min.xx, t_min.yz);
  t_0 = max(0.0, max(t.x, t.y));
  vec3 t_max = max(t_top, t_bottom);
  t = min(t_max.xx, t_max.yz);
  t_1 = min(t.x, t.y);
}


// A very simple colour transfer function
vec4 colour_transfer(float intensity)
{
  vec3 high = vec3(1.0, 1.0, 1.0);
  vec3 low = vec3(0.0, 0.0, 0.0);
  float alpha = (exp(intensity) - 1.0) / (exp(1.0) - 1.0);
  return vec4(intensity * high + (1.0 - intensity) * low, alpha);
}

vec3 rgb2hsv(vec3 c)
{
  vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
  vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
  vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));

  float d = q.x - min(q.w, q.y);
  float e = 1.0e-10;
  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);
}

vec3 hsv2rgb(vec3 c)
{
  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}


const int numSamples = 100000;

void main()
{
  vec3 ambient, diffuse, specular;
  vec3 numberOfReplicas = structureUniforms.numberOfReplicas.xyz;
  vec3 direction = normalize(fs_in.position.xyz - frameUniforms.cameraPosition.xyz);
  vec4 dir = vec4(direction.x,direction.y,direction.z,0.0);
  vec3 ray_direction = (structureUniforms.inverseBoxMatrix * structureUniforms.inverseModelMatrix * dir).xyz;

  vec3 ray_origin = fs_in.UV;

  float stepLength = isosurfaceUniforms.stepLength/numberOfReplicas.z;

  float t_0, t_1;
  Ray casting_ray = Ray(ray_origin, ray_direction);
  AABB bounding_box = AABB(vec3(1.0,1.0,1.0), vec3(0.0,0.0,0.0));
  ray_box_intersection(casting_ray, bounding_box, t_0, t_1);

  vec3 ray_start = ray_origin + ray_direction * t_0;
  vec3 ray_stop = ray_origin + ray_direction * t_1;

  vec3 ray = ray_stop - ray_start;
  float ray_length = length(ray);
  vec3 step_vector = stepLength * ray / ray_length;

  float depth = texelFetch(depthTexture, ivec2(gl_FragCoord.xy),0).r;
  //gl_FragDepth = depth;  // at least write a value once (required)
  float newDepth = 1.0;
  mat4 m = frameUniforms.mvpMatrix * structureUniforms.modelMatrix * isosurfaceUniforms.boxMatrix;

  vec4 scaleToEncompassing = isosurfaceUniforms.scaleToEncompassing;

  vec4 colour = vec4(0.0,0.0,0.0,0.0);
  vec3 position = ray_start;
  for (int i=0; i < numSamples && ray_length > 0 && colour.a < 1.0; i++)
  {
    vec4 values = texture(volume,numberOfReplicas * (scaleToEncompassing.xyz * position));
    vec3 normal = normalize((structureUniforms.modelMatrix * transpose(structureUniforms.inverseBoxMatrix) * vec4(values.gba,0.0)).rgb);
    vec4 c = texture(transferFunction, vec2(values.r, isosurfaceUniforms.transferFunctionIndex));

    // allow to "zoom in" using the transparency
    c.a = smoothstep(isosurfaceUniforms.transparencyThreshold, 1.0, c.a);

    vec3 R = reflect(-direction, normal);
    ambient = vec3(0.1,0.1,0.1);
    float dotProduct = dot(normal, direction);

    if(dotProduct < 0)
    {
      ambient = isosurfaceUniforms.ambientBackSide.rgb;
      diffuse = vec3(max(abs(dotProduct),0.0)) * isosurfaceUniforms.diffuseBackSide.rgb;
      specular = vec3(pow(max(dot(R, direction), 0.0), isosurfaceUniforms.shininessBackSide)) * isosurfaceUniforms.specularBackSide.rgb;
      vec3 totalColor = (ambient+diffuse+specular).rgb;

      if (isosurfaceUniforms.backHDR)
      {
        totalColor = 1.0 - exp2(-totalColor * isosurfaceUniforms.backHDRExposure);
      }

      // Alpha-blending
      c.a = 1.0 - pow(1.0f - c.a, stepLength*2000.0f);
      colour.rgb += (1.0f - colour.a) * c.a * c.rgb * totalColor.rgb;
      colour.a += (1.0f - colour.a) * c.a;
    }
    else
    {
      ambient = isosurfaceUniforms.ambientFrontSide.rgb;
      diffuse = vec3(max(abs(dotProduct),0.0)) * isosurfaceUniforms.diffuseFrontSide.rgb;
      specular = vec3(pow(max(dot(R, direction), 0.0), isosurfaceUniforms.shininessFrontSide)) * isosurfaceUniforms.specularFrontSide.rgb;
      vec3 totalColor = (ambient+diffuse+specular).rgb;

      if (isosurfaceUniforms.frontHDR)
      {
        totalColor = 1.0 - exp2(-totalColor * isosurfaceUniforms.frontHDRExposure);
      }

      // Alpha-blending
      c.a = 1.0 - pow(1.0f - c.a, stepLength*2000.0f);
      colour.rgb += (1.0f - colour.a) * c.a * c.rgb * totalColor.rgb;
      colour.a += (1.0f - colour.a) * c.a;
    }

    position = position + step_vector;
    ray_length -= stepLength;

    vec4 clipPosition = m * vec4(position,1.0);
    newDepth = 0.5*(clipPosition.z / clipPosition.w)+0.5;
    if(newDepth>depth)
    {
      break;
    }
  }

  if(colour.a<0.5)
  {
    newDepth = depth;
  }

  gl_FragDepth = newDepth;

  vec3 hsv = rgb2hsv(colour.xyz);
  hsv.x = hsv.x * isosurfaceUniforms.hue;
  hsv.y = hsv.y * isosurfaceUniforms.saturation;
  hsv.z = hsv.z * isosurfaceUniforms.value;
  vFragColor = vec4(hsv2rgb(hsv) * isosurfaceUniforms.diffuseFrontSide.w * colour.a,isosurfaceUniforms.diffuseFrontSide.w * colour.a);
}
)foo";



std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::RASPA_PES_TransferFunction
{
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 1, 0, 0),
  float4(1, 0.994764, 0.00392727, 0),
  float4(1, 0.985455, 0.0109091, 0),
  float4(1, 0.976145, 0.0178909, 0),
  float4(1, 0.966836, 0.0248727, 0),
  float4(1, 0.957527, 0.0318545, 0),
  float4(1, 0.948218, 0.0388364, 0),
  float4(1, 0.938909, 0.0458182, 0),
  float4(1, 0.9296, 0.0528, 0),
  float4(1, 0.920291, 0.0597818, 0),
  float4(1, 0.910982, 0.0667636, 0),
  float4(1, 0.901673, 0.0737455, 0),
  float4(1, 0.892364, 0.0807273, 0),
  float4(1, 0.883055, 0.0877091, 0),
  float4(1, 0.873745, 0.0946909, 0),
  float4(1, 0.864436, 0.101673, 0),
  float4(1, 0.855127, 0.108655, 0),
  float4(1, 0.845818, 0.115636, 0.0288),
  float4(1, 0.836509, 0.122618, 0.05952),
  float4(1, 0.8272, 0.1296, 0.09024),
  float4(1, 0.817891, 0.136582, 0.12096),
  float4(1, 0.808582, 0.143564, 0.15168),
  float4(1, 0.799273, 0.150545, 0.1824),
  float4(1, 0.789964, 0.157527, 0.21312),
  float4(1, 0.780655, 0.164509, 0.24384),
  float4(1, 0.771345, 0.171491, 0.27456),
  float4(1, 0.762036, 0.178473, 0.30528),
  float4(1, 0.752727, 0.185455, 0.336),
  float4(1, 0.743418, 0.192436, 0.36672),
  float4(1, 0.734109, 0.199418, 0.39744),
  float4(1, 0.7248, 0.2064, 0.42816),
  float4(1, 0.715491, 0.213382, 0.45888),
  float4(1, 0.706182, 0.220364, 0.4896),
  float4(1, 0.696873, 0.227345, 0.52032),
  float4(1, 0.687564, 0.234327, 0.55104),
  float4(1, 0.678255, 0.241309, 0.58176),
  float4(1, 0.668945, 0.248291, 0.6),
  float4(1, 0.659636, 0.255273, 0.6),
  float4(1, 0.650327, 0.262255, 0.6),
  float4(1, 0.641018, 0.269236, 0.6),
  float4(1, 0.631709, 0.276218, 0.6),
  float4(1, 0.6224, 0.2832, 0.6),
  float4(1, 0.613091, 0.290182, 0.6),
  float4(1, 0.603782, 0.297164, 0.6),
  float4(1, 0.605527, 0.295855, 0.6),
  float4(1, 0.614836, 0.288873, 0.6),
  float4(1, 0.624145, 0.281891, 0.6),
  float4(1, 0.633455, 0.274909, 0.6),
  float4(1, 0.642764, 0.267927, 0.6),
  float4(1, 0.652073, 0.260945, 0.6),
  float4(1, 0.661382, 0.253964, 0.6),
  float4(1, 0.670691, 0.246982, 0.6),
  float4(1, 0.68, 0.24, 0.6),
  float4(1, 0.689309, 0.233018, 0.6),
  float4(1, 0.698618, 0.226036, 0.6),
  float4(1, 0.707927, 0.219055, 0.6),
  float4(1, 0.717236, 0.212073, 0.60672),
  float4(1, 0.726545, 0.205091, 0.6144),
  float4(1, 0.735855, 0.198109, 0.62208),
  float4(1, 0.745164, 0.191127, 0.62976),
  float4(1, 0.754473, 0.184145, 0.63744),
  float4(1, 0.763782, 0.177164, 0.64512),
  float4(1, 0.773091, 0.170182, 0.6528),
  float4(1, 0.7824, 0.1632, 0.66048),
  float4(1, 0.791709, 0.156218, 0.66816),
  float4(1, 0.801018, 0.149236, 0.67584),
  float4(1, 0.810327, 0.142255, 0.68352),
  float4(1, 0.819636, 0.135273, 0.6912),
  float4(1, 0.828945, 0.128291, 0.69888),
  float4(1, 0.838255, 0.121309, 0.70656),
  float4(1, 0.847564, 0.114327, 0.71424),
  float4(1, 0.856873, 0.107345, 0.72192),
  float4(1, 0.866182, 0.100364, 0.7296),
  float4(1, 0.875491, 0.0933818, 0.73728),
  float4(1, 0.8848, 0.0864, 0.74496),
  float4(1, 0.894109, 0.0794182, 0.75264),
  float4(1, 0.903418, 0.0724364, 0.76032),
  float4(1, 0.912727, 0.0654545, 0.768),
  float4(1, 0.922036, 0.0584727, 0.77568),
  float4(1, 0.931345, 0.0514909, 0.78336),
  float4(1, 0.940655, 0.0445091, 0.79104),
  float4(1, 0.949964, 0.0375273, 0.79872),
  float4(1, 0.959273, 0.0305455, 0.8064),
  float4(1, 0.968582, 0.0235636, 0.81408),
  float4(1, 0.977891, 0.0165818, 0.82176),
  float4(1, 0.9872, 0.0096, 0.82944),
  float4(1, 0.996509, 0.00261818, 0.83712),
  float4(0.904, 1, 0.096, 0.8448),
  float4(0.7504, 1, 0.2496, 0.85248),
  float4(0.5968, 1, 0.4032, 0.86016),
  float4(0.4432, 1, 0.5568, 0.86784),
  float4(0.3816, 0.9448, 0.5816, 0.87552),
  float4(0.356, 0.868, 0.556, 0.8832),
  float4(0.3304, 0.7912, 0.5304, 0.89088),
  float4(0.3048, 0.7144, 0.5048, 0.89856),
  float4(0.3, 0.698829, 0.502927, 0.900693),
  float4(0.3, 0.697389, 0.506529, 0.901547),
  float4(0.3, 0.695948, 0.510131, 0.9024),
  float4(0.3, 0.694507, 0.513733, 0.903253),
  float4(0.3, 0.693066, 0.517335, 0.904107),
  float4(0.3, 0.691625, 0.520937, 0.90496),
  float4(0.3, 0.690185, 0.524538, 0.905813),
  float4(0.3, 0.688744, 0.52814, 0.906667),
  float4(0.3, 0.687303, 0.531742, 0.90752),
  float4(0.3, 0.685862, 0.535344, 0.908373),
  float4(0.3, 0.684421, 0.538946, 0.909227),
  float4(0.3, 0.682981, 0.542548, 0.91008),
  float4(0.3, 0.68154, 0.54615, 0.910933),
  float4(0.3, 0.680099, 0.549752, 0.911787),
  float4(0.3, 0.678658, 0.553354, 0.91264),
  float4(0.3, 0.677217, 0.556956, 0.913493),
  float4(0.3, 0.675777, 0.560558, 0.914347),
  float4(0.3, 0.674336, 0.56416, 0.9152),
  float4(0.3, 0.672895, 0.567762, 0.916053),
  float4(0.3, 0.671454, 0.571364, 0.916907),
  float4(0.3, 0.670014, 0.574966, 0.91776),
  float4(0.3, 0.668573, 0.578568, 0.918613),
  float4(0.3, 0.667132, 0.58217, 0.919467),
  float4(0.3, 0.665691, 0.585772, 0.92032),
  float4(0.3, 0.66425, 0.589374, 0.921173),
  float4(0.3, 0.66281, 0.592976, 0.922027),
  float4(0.3, 0.661369, 0.596578, 0.92288),
  float4(0.3, 0.659928, 0.60018, 0.923733),
  float4(0.3, 0.658487, 0.603782, 0.924587),
  float4(0.3, 0.657046, 0.607384, 0.92544),
  float4(0.3, 0.655606, 0.610986, 0.926293),
  float4(0.3, 0.654165, 0.614588, 0.927147),
  float4(0.3, 0.652724, 0.61819, 0.928),
  float4(0.3, 0.651283, 0.621792, 0.928853),
  float4(0.3, 0.649842, 0.625394, 0.929707),
  float4(0.3, 0.648402, 0.628996, 0.93056),
  float4(0.3, 0.646961, 0.632598, 0.931413),
  float4(0.3, 0.64552, 0.6362, 0.932267),
  float4(0.3, 0.644079, 0.639802, 0.93312),
  float4(0.3, 0.642638, 0.643404, 0.933973),
  float4(0.3, 0.641198, 0.647006, 0.934827),
  float4(0.3, 0.639757, 0.650608, 0.93568),
  float4(0.3, 0.638316, 0.65421, 0.936533),
  float4(0.3, 0.636875, 0.657812, 0.937387),
  float4(0.3, 0.635434, 0.661414, 0.93824),
  float4(0.3, 0.633994, 0.665016, 0.939093),
  float4(0.3, 0.632553, 0.668618, 0.939947),
  float4(0.3, 0.631112, 0.67222, 0.9408),
  float4(0.3, 0.629671, 0.675822, 0.941653),
  float4(0.3, 0.628231, 0.679424, 0.942507),
  float4(0.3, 0.62679, 0.683026, 0.94336),
  float4(0.3, 0.625349, 0.686628, 0.944213),
  float4(0.3, 0.623908, 0.69023, 0.945067),
  float4(0.3, 0.622467, 0.693832, 0.94592),
  float4(0.3, 0.621027, 0.697434, 0.946773),
  float4(0.3, 0.619586, 0.701036, 0.947627),
  float4(0.3, 0.618145, 0.704638, 0.94848),
  float4(0.3, 0.616704, 0.70824, 0.949333),
  float4(0.3, 0.615263, 0.711842, 0.950187),
  float4(0.3, 0.613823, 0.715443, 0.95104),
  float4(0.3, 0.612382, 0.719045, 0.951893),
  float4(0.3, 0.610941, 0.722647, 0.952747),
  float4(0.3, 0.6095, 0.726249, 0.9536),
  float4(0.3, 0.608059, 0.729851, 0.954453),
  float4(0.3, 0.606619, 0.733453, 0.955307),
  float4(0.3, 0.605178, 0.737055, 0.95616),
  float4(0.3, 0.603737, 0.740657, 0.957013),
  float4(0.3, 0.602296, 0.744259, 0.957867),
  float4(0.3, 0.600855, 0.747861, 0.95872),
  float4(0.3, 0.599415, 0.751463, 0.959573),
  float4(0.3, 0.597974, 0.755065, 0.960427),
  float4(0.3, 0.596533, 0.758667, 0.96128),
  float4(0.3, 0.595092, 0.762269, 0.962133),
  float4(0.3, 0.593652, 0.765871, 0.962987),
  float4(0.3, 0.592211, 0.769473, 0.96384),
  float4(0.3, 0.59077, 0.773075, 0.964693),
  float4(0.3, 0.589329, 0.776677, 0.965547),
  float4(0.3, 0.587888, 0.780279, 0.9664),
  float4(0.3, 0.586448, 0.783881, 0.967253),
  float4(0.3, 0.585007, 0.787483, 0.968107),
  float4(0.3, 0.583566, 0.791085, 0.96896),
  float4(0.3, 0.582125, 0.794687, 0.969813),
  float4(0.3, 0.580684, 0.798289, 0.970667),
  float4(0.3, 0.579244, 0.801891, 0.97152),
  float4(0.3, 0.577803, 0.805493, 0.972373),
  float4(0.3, 0.576362, 0.809095, 0.973227),
  float4(0.3, 0.574921, 0.812697, 0.97408),
  float4(0.3, 0.57348, 0.816299, 0.974933),
  float4(0.3, 0.57204, 0.819901, 0.975787),
  float4(0.3, 0.570599, 0.823503, 0.97664),
  float4(0.3, 0.569158, 0.827105, 0.977493),
  float4(0.3, 0.567717, 0.830707, 0.978347),
  float4(0.3, 0.566276, 0.834309, 0.9792),
  float4(0.3, 0.564836, 0.837911, 0.980053),
  float4(0.3, 0.563395, 0.841513, 0.980907),
  float4(0.3, 0.561954, 0.845115, 0.98176),
  float4(0.3, 0.560513, 0.848717, 0.982613),
  float4(0.3, 0.559072, 0.852319, 0.983467),
  float4(0.3, 0.557632, 0.855921, 0.98432),
  float4(0.3, 0.556191, 0.859523, 0.985173),
  float4(0.3, 0.55475, 0.863125, 0.986027),
  float4(0.3, 0.553309, 0.866727, 0.98688),
  float4(0.3, 0.551869, 0.870329, 0.987733),
  float4(0.3, 0.550428, 0.873931, 0.988587),
  float4(0.3, 0.548987, 0.877533, 0.98944),
  float4(0.3, 0.547546, 0.881135, 0.990293),
  float4(0.3, 0.546105, 0.884737, 0.991147),
  float4(0.3, 0.544665, 0.888339, 0.992),
  float4(0.3, 0.543224, 0.891941, 0.992853),
  float4(0.3, 0.541783, 0.895543, 0.993707),
  float4(0.3, 0.540342, 0.899145, 0.99456),
  float4(0.3, 0.538901, 0.902747, 0.995413),
  float4(0.3, 0.537461, 0.906348, 0.996267),
  float4(0.3, 0.53602, 0.90995, 0.99712),
  float4(0.3, 0.534579, 0.913552, 0.997973),
  float4(0.3, 0.533138, 0.917154, 0.998827),
  float4(0.3, 0.531697, 0.920756, 0.99968),
  float4(0.3, 0.530257, 0.924358, 0.968),
  float4(0.3, 0.528816, 0.92796, 0.9168),
  float4(0.3, 0.527375, 0.931562, 0.8656),
  float4(0.3, 0.525934, 0.935164, 0.8144),
  float4(0.3, 0.524493, 0.938766, 0.7632),
  float4(0.3, 0.523053, 0.942368, 0.712),
  float4(0.3, 0.521612, 0.94597, 0.6608),
  float4(0.3, 0.520171, 0.949572, 0.6096),
  float4(0.3, 0.51873, 0.953174, 0.5584),
  float4(0.3, 0.51729, 0.956776, 0.5072),
  float4(0.3, 0.515849, 0.960378, 0.456),
  float4(0.3, 0.514408, 0.96398, 0.4048),
  float4(0.3, 0.512967, 0.967582, 0.3536),
  float4(0.3, 0.511526, 0.971184, 0.3024),
  float4(0.3, 0.510086, 0.974786, 0.2512),
  float4(0.3, 0.508645, 0.978388, 0.2),
  float4(0.3, 0.507204, 0.98199, 0.1488),
  float4(0.3, 0.505763, 0.985592, 0.0976),
  float4(0.3, 0.504322, 0.989194, 0.0464),
  float4(0.3, 0.502882, 0.992796, 0.0),
  float4(0.3, 0.501441, 0.996398, 0.0)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::CoolWarmTransferFunction
{
  float4(0.229806, 0.298718, 0.753683, 0.000000),
  float4(0.234377, 0.305542, 0.759680, 0.003906),
  float4(0.238948, 0.312365, 0.765676, 0.007812),
  float4(0.243520, 0.319189, 0.771672, 0.011719),
  float4(0.248091, 0.326013, 0.777669, 0.015625),
  float4(0.252663, 0.332837, 0.783665, 0.019531),
  float4(0.257234, 0.339661, 0.789661, 0.023438),
  float4(0.261805, 0.346484, 0.795658, 0.027344),
  float4(0.266381, 0.353304, 0.801637, 0.031250),
  float4(0.271104, 0.360011, 0.807095, 0.035156),
  float4(0.275827, 0.366717, 0.812553, 0.039062),
  float4(0.280550, 0.373423, 0.818011, 0.042969),
  float4(0.285273, 0.380129, 0.823469, 0.046875),
  float4(0.289996, 0.386836, 0.828926, 0.050781),
  float4(0.294718, 0.393542, 0.834384, 0.054688),
  float4(0.299441, 0.400248, 0.839842, 0.058594),
  float4(0.304174, 0.406945, 0.845263, 0.062500),
  float4(0.309060, 0.413498, 0.850128, 0.066406),
  float4(0.313946, 0.420052, 0.854993, 0.070312),
  float4(0.318832, 0.426605, 0.859857, 0.074219),
  float4(0.323718, 0.433158, 0.864722, 0.078125),
  float4(0.328604, 0.439712, 0.869587, 0.082031),
  float4(0.333490, 0.446265, 0.874452, 0.085938),
  float4(0.338377, 0.452819, 0.879317, 0.089844),
  float4(0.343278, 0.459354, 0.884122, 0.093750),
  float4(0.348323, 0.465711, 0.888346, 0.097656),
  float4(0.353369, 0.472069, 0.892570, 0.101562),
  float4(0.358415, 0.478426, 0.896795, 0.105469),
  float4(0.363461, 0.484784, 0.901019, 0.109375),
  float4(0.368507, 0.491141, 0.905243, 0.113281),
  float4(0.373552, 0.497499, 0.909467, 0.117188),
  float4(0.378598, 0.503856, 0.913692, 0.121094),
  float4(0.383662, 0.510183, 0.917831, 0.125000),
  float4(0.388852, 0.516298, 0.921373, 0.128906),
  float4(0.394042, 0.522413, 0.924916, 0.132812),
  float4(0.399231, 0.528528, 0.928459, 0.136719),
  float4(0.404421, 0.534643, 0.932002, 0.140625),
  float4(0.409611, 0.540759, 0.935545, 0.144531),
  float4(0.414801, 0.546874, 0.939088, 0.148438),
  float4(0.419991, 0.552989, 0.942630, 0.152344),
  float4(0.425199, 0.559058, 0.946061, 0.156250),
  float4(0.430507, 0.564883, 0.948889, 0.160156),
  float4(0.435815, 0.570707, 0.951717, 0.164062),
  float4(0.441123, 0.576532, 0.954545, 0.167969),
  float4(0.446431, 0.582356, 0.957373, 0.171875),
  float4(0.451739, 0.588181, 0.960201, 0.175781),
  float4(0.457046, 0.594006, 0.963029, 0.179688),
  float4(0.462354, 0.599830, 0.965857, 0.183594),
  float4(0.467678, 0.605591, 0.968546, 0.187500),
  float4(0.473070, 0.611077, 0.970634, 0.191406),
  float4(0.478462, 0.616564, 0.972721, 0.195312),
  float4(0.483854, 0.622050, 0.974808, 0.199219),
  float4(0.489246, 0.627536, 0.976896, 0.203125),
  float4(0.494638, 0.633022, 0.978983, 0.207031),
  float4(0.500031, 0.638508, 0.981070, 0.210938),
  float4(0.505423, 0.643995, 0.983157, 0.214844),
  float4(0.510824, 0.649397, 0.985079, 0.218750),
  float4(0.516260, 0.654498, 0.986407, 0.222656),
  float4(0.521696, 0.659599, 0.987736, 0.226562),
  float4(0.527132, 0.664700, 0.989065, 0.230469),
  float4(0.532568, 0.669801, 0.990393, 0.234375),
  float4(0.538004, 0.674902, 0.991722, 0.238281),
  float4(0.543440, 0.680003, 0.993051, 0.242188),
  float4(0.548876, 0.685104, 0.994379, 0.246094),
  float4(0.554312, 0.690097, 0.995516, 0.250000),
  float4(0.559747, 0.694768, 0.996075, 0.253906),
  float4(0.565182, 0.699438, 0.996635, 0.257812),
  float4(0.570616, 0.704109, 0.997195, 0.261719),
  float4(0.576051, 0.708780, 0.997755, 0.265625),
  float4(0.581486, 0.713451, 0.998314, 0.269531),
  float4(0.586921, 0.718121, 0.998874, 0.273438),
  float4(0.592356, 0.722792, 0.999434, 0.277344),
  float4(0.597777, 0.727330, 0.999777, 0.281250),
  float4(0.603162, 0.731527, 0.999565, 0.285156),
  float4(0.608547, 0.735725, 0.999354, 0.289062),
  float4(0.613933, 0.739923, 0.999142, 0.292969),
  float4(0.619318, 0.744121, 0.998931, 0.296875),
  float4(0.624703, 0.748318, 0.998719, 0.300781),
  float4(0.630089, 0.752516, 0.998508, 0.304688),
  float4(0.635474, 0.756714, 0.998297, 0.308594),
  float4(0.640828, 0.760752, 0.997846, 0.312500),
  float4(0.646113, 0.764436, 0.996868, 0.316406),
  float4(0.651398, 0.768121, 0.995891, 0.320312),
  float4(0.656683, 0.771806, 0.994914, 0.324219),
  float4(0.661968, 0.775491, 0.993937, 0.328125),
  float4(0.667253, 0.779176, 0.992959, 0.332031),
  float4(0.672538, 0.782861, 0.991982, 0.335938),
  float4(0.677823, 0.786546, 0.991005, 0.339844),
  float4(0.683056, 0.790043, 0.989768, 0.343750),
  float4(0.688188, 0.793178, 0.988038, 0.347656),
  float4(0.693321, 0.796314, 0.986308, 0.351562),
  float4(0.698454, 0.799450, 0.984577, 0.355469),
  float4(0.703587, 0.802586, 0.982847, 0.359375),
  float4(0.708720, 0.805721, 0.981117, 0.363281),
  float4(0.713852, 0.808857, 0.979386, 0.367188),
  float4(0.718985, 0.811993, 0.977656, 0.371094),
  float4(0.724041, 0.814910, 0.975651, 0.375000),
  float4(0.728970, 0.817464, 0.973188, 0.378906),
  float4(0.733898, 0.820018, 0.970724, 0.382812),
  float4(0.738826, 0.822572, 0.968261, 0.386719),
  float4(0.743754, 0.825125, 0.965798, 0.390625),
  float4(0.748682, 0.827679, 0.963334, 0.394531),
  float4(0.753611, 0.830233, 0.960871, 0.398438),
  float4(0.758539, 0.832787, 0.958408, 0.402344),
  float4(0.763363, 0.835092, 0.955658, 0.406250),
  float4(0.768034, 0.837035, 0.952488, 0.410156),
  float4(0.772706, 0.838978, 0.949319, 0.414062),
  float4(0.777378, 0.840921, 0.946149, 0.417969),
  float4(0.782049, 0.842864, 0.942980, 0.421875),
  float4(0.786721, 0.844807, 0.939810, 0.425781),
  float4(0.791392, 0.846750, 0.936641, 0.429688),
  float4(0.796064, 0.848693, 0.933471, 0.433594),
  float4(0.800601, 0.850358, 0.930008, 0.437500),
  float4(0.804965, 0.851666, 0.926165, 0.441406),
  float4(0.809329, 0.852974, 0.922323, 0.445312),
  float4(0.813693, 0.854282, 0.918480, 0.449219),
  float4(0.818056, 0.855590, 0.914638, 0.453125),
  float4(0.822420, 0.856898, 0.910795, 0.457031),
  float4(0.826784, 0.858205, 0.906953, 0.460938),
  float4(0.831148, 0.859513, 0.903110, 0.464844),
  float4(0.835345, 0.860514, 0.898970, 0.468750),
  float4(0.839351, 0.861167, 0.894494, 0.472656),
  float4(0.843358, 0.861820, 0.890017, 0.476562),
  float4(0.847365, 0.862472, 0.885540, 0.480469),
  float4(0.851372, 0.863125, 0.881064, 0.484375),
  float4(0.855378, 0.863778, 0.876587, 0.488281),
  float4(0.859385, 0.864431, 0.872111, 0.492188),
  float4(0.863392, 0.865084, 0.867634, 0.496094),
  float4(0.867428, 0.864377, 0.862602, 0.500000),
  float4(0.871493, 0.862309, 0.857016, 0.503906),
  float4(0.875557, 0.860242, 0.851430, 0.507812),
  float4(0.879622, 0.858175, 0.845844, 0.511719),
  float4(0.883687, 0.856108, 0.840258, 0.515625),
  float4(0.887752, 0.854040, 0.834671, 0.519531),
  float4(0.891817, 0.851973, 0.829085, 0.523438),
  float4(0.895882, 0.849906, 0.823499, 0.527344),
  float4(0.899543, 0.847500, 0.817789, 0.531250),
  float4(0.902849, 0.844796, 0.811970, 0.535156),
  float4(0.906154, 0.842091, 0.806151, 0.539062),
  float4(0.909460, 0.839386, 0.800331, 0.542969),
  float4(0.912765, 0.836682, 0.794512, 0.546875),
  float4(0.916071, 0.833977, 0.788693, 0.550781),
  float4(0.919376, 0.831273, 0.782874, 0.554688),
  float4(0.922681, 0.828568, 0.777054, 0.558594),
  float4(0.925563, 0.825517, 0.771136, 0.562500),
  float4(0.928116, 0.822197, 0.765141, 0.566406),
  float4(0.930669, 0.818877, 0.759146, 0.570312),
  float4(0.933221, 0.815557, 0.753151, 0.574219),
  float4(0.935774, 0.812237, 0.747156, 0.578125),
  float4(0.938326, 0.808917, 0.741162, 0.582031),
  float4(0.940879, 0.805596, 0.735167, 0.585938),
  float4(0.943432, 0.802276, 0.729172, 0.589844),
  float4(0.945540, 0.798606, 0.723105, 0.593750),
  float4(0.947345, 0.794695, 0.716991, 0.597656),
  float4(0.949151, 0.790785, 0.710876, 0.601562),
  float4(0.950956, 0.786875, 0.704761, 0.605469),
  float4(0.952761, 0.782965, 0.698646, 0.609375),
  float4(0.954566, 0.779055, 0.692531, 0.613281),
  float4(0.956371, 0.775144, 0.686416, 0.617188),
  float4(0.958176, 0.771234, 0.680301, 0.621094),
  float4(0.959518, 0.766973, 0.674145, 0.625000),
  float4(0.960581, 0.762501, 0.667964, 0.628906),
  float4(0.961645, 0.758029, 0.661782, 0.632812),
  float4(0.962708, 0.753557, 0.655601, 0.636719),
  float4(0.963772, 0.749086, 0.649420, 0.640625),
  float4(0.964835, 0.744614, 0.643239, 0.644531),
  float4(0.965899, 0.740142, 0.637058, 0.648438),
  float4(0.966962, 0.735670, 0.630877, 0.652344),
  float4(0.967544, 0.730850, 0.624685, 0.656250),
  float4(0.967874, 0.725847, 0.618489, 0.660156),
  float4(0.968203, 0.720844, 0.612293, 0.664062),
  float4(0.968533, 0.715841, 0.606097, 0.667969),
  float4(0.968862, 0.710838, 0.599900, 0.671875),
  float4(0.969192, 0.705836, 0.593704, 0.675781),
  float4(0.969522, 0.700833, 0.587508, 0.679688),
  float4(0.969851, 0.695830, 0.581312, 0.683594),
  float4(0.969683, 0.690484, 0.575138, 0.687500),
  float4(0.969289, 0.684982, 0.568975, 0.691406),
  float4(0.968894, 0.679480, 0.562812, 0.695312),
  float4(0.968500, 0.673977, 0.556649, 0.699219),
  float4(0.968105, 0.668475, 0.550486, 0.703125),
  float4(0.967711, 0.662973, 0.544323, 0.707031),
  float4(0.967317, 0.657471, 0.538160, 0.710938),
  float4(0.966922, 0.651969, 0.531997, 0.714844),
  float4(0.966017, 0.646130, 0.525890, 0.718750),
  float4(0.964911, 0.640159, 0.519806, 0.722656),
  float4(0.963806, 0.634188, 0.513721, 0.726562),
  float4(0.962701, 0.628218, 0.507636, 0.730469),
  float4(0.961595, 0.622247, 0.501551, 0.734375),
  float4(0.960490, 0.616276, 0.495467, 0.738281),
  float4(0.959385, 0.610306, 0.489382, 0.742188),
  float4(0.958279, 0.604335, 0.483297, 0.746094),
  float4(0.956653, 0.598034, 0.477302, 0.750000),
  float4(0.954853, 0.591622, 0.471337, 0.753906),
  float4(0.953054, 0.585211, 0.465373, 0.757812),
  float4(0.951254, 0.578799, 0.459408, 0.761719),
  float4(0.949454, 0.572388, 0.453443, 0.765625),
  float4(0.947654, 0.565976, 0.447478, 0.769531),
  float4(0.945854, 0.559565, 0.441513, 0.773438),
  float4(0.944055, 0.553153, 0.435548, 0.777344),
  float4(0.941728, 0.546413, 0.429707, 0.781250),
  float4(0.939254, 0.539581, 0.423900, 0.785156),
  float4(0.936780, 0.532749, 0.418093, 0.789062),
  float4(0.934305, 0.525918, 0.412286, 0.792969),
  float4(0.931831, 0.519086, 0.406480, 0.796875),
  float4(0.929357, 0.512254, 0.400673, 0.800781),
  float4(0.926883, 0.505422, 0.394866, 0.804688),
  float4(0.924409, 0.498590, 0.389059, 0.808594),
  float4(0.921406, 0.491420, 0.383408, 0.812500),
  float4(0.918282, 0.484173, 0.377794, 0.816406),
  float4(0.915157, 0.476927, 0.372179, 0.820312),
  float4(0.912033, 0.469680, 0.366565, 0.824219),
  float4(0.908908, 0.462433, 0.360950, 0.828125),
  float4(0.905783, 0.455186, 0.355336, 0.832031),
  float4(0.902659, 0.447939, 0.349721, 0.835938),
  float4(0.899534, 0.440692, 0.344107, 0.839844),
  float4(0.895885, 0.433075, 0.338681, 0.843750),
  float4(0.892138, 0.425389, 0.333289, 0.847656),
  float4(0.888390, 0.417703, 0.327898, 0.851562),
  float4(0.884643, 0.410017, 0.322507, 0.855469),
  float4(0.880896, 0.402331, 0.317115, 0.859375),
  float4(0.877149, 0.394645, 0.311724, 0.863281),
  float4(0.873402, 0.386960, 0.306332, 0.867188),
  float4(0.869655, 0.379274, 0.300941, 0.871094),
  float4(0.865391, 0.371128, 0.295769, 0.875000),
  float4(0.861054, 0.362916, 0.290628, 0.878906),
  float4(0.856716, 0.354704, 0.285487, 0.882812),
  float4(0.852378, 0.346492, 0.280346, 0.886719),
  float4(0.848040, 0.338280, 0.275206, 0.890625),
  float4(0.843703, 0.330068, 0.270065, 0.894531),
  float4(0.839365, 0.321856, 0.264924, 0.898438),
  float4(0.835027, 0.313644, 0.259783, 0.902344),
  float4(0.830187, 0.304733, 0.254891, 0.906250),
  float4(0.825294, 0.295749, 0.250025, 0.910156),
  float4(0.820401, 0.286765, 0.245160, 0.914062),
  float4(0.815508, 0.277781, 0.240294, 0.917969),
  float4(0.810616, 0.268797, 0.235428, 0.921875),
  float4(0.805723, 0.259813, 0.230562, 0.925781),
  float4(0.800830, 0.250829, 0.225696, 0.929688),
  float4(0.795938, 0.241845, 0.220830, 0.933594),
  float4(0.790562, 0.231397, 0.216242, 0.937500),
  float4(0.785153, 0.220851, 0.211673, 0.941406),
  float4(0.779745, 0.210305, 0.207104, 0.945312),
  float4(0.774337, 0.199759, 0.202535, 0.949219),
  float4(0.768929, 0.189213, 0.197965, 0.953125),
  float4(0.763520, 0.178667, 0.193396, 0.957031),
  float4(0.758112, 0.168122, 0.188827, 0.960938),
  float4(0.752704, 0.157576, 0.184258, 0.964844),
  float4(0.746838, 0.140021, 0.179996, 0.968750),
  float4(0.740957, 0.122240, 0.175744, 0.972656),
  float4(0.735077, 0.104460, 0.171492, 0.976562),
  float4(0.729196, 0.086679, 0.167240, 0.980469),
  float4(0.723315, 0.068898, 0.162989, 0.984375),
  float4(0.717435, 0.051118, 0.158737, 0.988281),
  float4(0.711554, 0.033337, 0.154485, 0.992188),
  float4(0.705673, 0.015556, 0.150233, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::XrayTransferFunction
{
  float4(1.000000, 1.000000, 1.000000, 0.000000),
  float4(0.996078, 0.996078, 0.996078, 0.003906),
  float4(0.992157, 0.992157, 0.992157, 0.007812),
  float4(0.988235, 0.988235, 0.988235, 0.011719),
  float4(0.984314, 0.984314, 0.984314, 0.015625),
  float4(0.980392, 0.980392, 0.980392, 0.019531),
  float4(0.976471, 0.976471, 0.976471, 0.023438),
  float4(0.972549, 0.972549, 0.972549, 0.027344),
  float4(0.968627, 0.968627, 0.968627, 0.031250),
  float4(0.964706, 0.964706, 0.964706, 0.035156),
  float4(0.960784, 0.960784, 0.960784, 0.039062),
  float4(0.956863, 0.956863, 0.956863, 0.042969),
  float4(0.952941, 0.952941, 0.952941, 0.046875),
  float4(0.949020, 0.949020, 0.949020, 0.050781),
  float4(0.945098, 0.945098, 0.945098, 0.054688),
  float4(0.941176, 0.941176, 0.941176, 0.058594),
  float4(0.937255, 0.937255, 0.937255, 0.062500),
  float4(0.933333, 0.933333, 0.933333, 0.066406),
  float4(0.929412, 0.929412, 0.929412, 0.070312),
  float4(0.925490, 0.925490, 0.925490, 0.074219),
  float4(0.921569, 0.921569, 0.921569, 0.078125),
  float4(0.917647, 0.917647, 0.917647, 0.082031),
  float4(0.913725, 0.913725, 0.913725, 0.085938),
  float4(0.909804, 0.909804, 0.909804, 0.089844),
  float4(0.905882, 0.905882, 0.905882, 0.093750),
  float4(0.901961, 0.901961, 0.901961, 0.097656),
  float4(0.898039, 0.898039, 0.898039, 0.101562),
  float4(0.894118, 0.894118, 0.894118, 0.105469),
  float4(0.890196, 0.890196, 0.890196, 0.109375),
  float4(0.886275, 0.886275, 0.886275, 0.113281),
  float4(0.882353, 0.882353, 0.882353, 0.117188),
  float4(0.878431, 0.878431, 0.878431, 0.121094),
  float4(0.874510, 0.874510, 0.874510, 0.125000),
  float4(0.870588, 0.870588, 0.870588, 0.128906),
  float4(0.866667, 0.866667, 0.866667, 0.132812),
  float4(0.862745, 0.862745, 0.862745, 0.136719),
  float4(0.858824, 0.858824, 0.858824, 0.140625),
  float4(0.854902, 0.854902, 0.854902, 0.144531),
  float4(0.850980, 0.850980, 0.850980, 0.148438),
  float4(0.847059, 0.847059, 0.847059, 0.152344),
  float4(0.843137, 0.843137, 0.843137, 0.156250),
  float4(0.839216, 0.839216, 0.839216, 0.160156),
  float4(0.835294, 0.835294, 0.835294, 0.164062),
  float4(0.831373, 0.831373, 0.831373, 0.167969),
  float4(0.827451, 0.827451, 0.827451, 0.171875),
  float4(0.823529, 0.823529, 0.823529, 0.175781),
  float4(0.819608, 0.819608, 0.819608, 0.179688),
  float4(0.815686, 0.815686, 0.815686, 0.183594),
  float4(0.811765, 0.811765, 0.811765, 0.187500),
  float4(0.807843, 0.807843, 0.807843, 0.191406),
  float4(0.803922, 0.803922, 0.803922, 0.195312),
  float4(0.800000, 0.800000, 0.800000, 0.199219),
  float4(0.796078, 0.796078, 0.796078, 0.203125),
  float4(0.792157, 0.792157, 0.792157, 0.207031),
  float4(0.788235, 0.788235, 0.788235, 0.210938),
  float4(0.784314, 0.784314, 0.784314, 0.214844),
  float4(0.780392, 0.780392, 0.780392, 0.218750),
  float4(0.776471, 0.776471, 0.776471, 0.222656),
  float4(0.772549, 0.772549, 0.772549, 0.226562),
  float4(0.768627, 0.768627, 0.768627, 0.230469),
  float4(0.764706, 0.764706, 0.764706, 0.234375),
  float4(0.760784, 0.760784, 0.760784, 0.238281),
  float4(0.756863, 0.756863, 0.756863, 0.242188),
  float4(0.752941, 0.752941, 0.752941, 0.246094),
  float4(0.749020, 0.749020, 0.749020, 0.250000),
  float4(0.745098, 0.745098, 0.745098, 0.253906),
  float4(0.741176, 0.741176, 0.741176, 0.257812),
  float4(0.737255, 0.737255, 0.737255, 0.261719),
  float4(0.733333, 0.733333, 0.733333, 0.265625),
  float4(0.729412, 0.729412, 0.729412, 0.269531),
  float4(0.725490, 0.725490, 0.725490, 0.273438),
  float4(0.721569, 0.721569, 0.721569, 0.277344),
  float4(0.717647, 0.717647, 0.717647, 0.281250),
  float4(0.713725, 0.713725, 0.713725, 0.285156),
  float4(0.709804, 0.709804, 0.709804, 0.289062),
  float4(0.705882, 0.705882, 0.705882, 0.292969),
  float4(0.701961, 0.701961, 0.701961, 0.296875),
  float4(0.698039, 0.698039, 0.698039, 0.300781),
  float4(0.694118, 0.694118, 0.694118, 0.304688),
  float4(0.690196, 0.690196, 0.690196, 0.308594),
  float4(0.686275, 0.686275, 0.686275, 0.312500),
  float4(0.682353, 0.682353, 0.682353, 0.316406),
  float4(0.678431, 0.678431, 0.678431, 0.320312),
  float4(0.674510, 0.674510, 0.674510, 0.324219),
  float4(0.670588, 0.670588, 0.670588, 0.328125),
  float4(0.666667, 0.666667, 0.666667, 0.332031),
  float4(0.662745, 0.662745, 0.662745, 0.335938),
  float4(0.658824, 0.658824, 0.658824, 0.339844),
  float4(0.654902, 0.654902, 0.654902, 0.343750),
  float4(0.650980, 0.650980, 0.650980, 0.347656),
  float4(0.647059, 0.647059, 0.647059, 0.351562),
  float4(0.643137, 0.643137, 0.643137, 0.355469),
  float4(0.639216, 0.639216, 0.639216, 0.359375),
  float4(0.635294, 0.635294, 0.635294, 0.363281),
  float4(0.631373, 0.631373, 0.631373, 0.367188),
  float4(0.627451, 0.627451, 0.627451, 0.371094),
  float4(0.623529, 0.623529, 0.623529, 0.375000),
  float4(0.619608, 0.619608, 0.619608, 0.378906),
  float4(0.615686, 0.615686, 0.615686, 0.382812),
  float4(0.611765, 0.611765, 0.611765, 0.386719),
  float4(0.607843, 0.607843, 0.607843, 0.390625),
  float4(0.603922, 0.603922, 0.603922, 0.394531),
  float4(0.600000, 0.600000, 0.600000, 0.398438),
  float4(0.596078, 0.596078, 0.596078, 0.402344),
  float4(0.592157, 0.592157, 0.592157, 0.406250),
  float4(0.588235, 0.588235, 0.588235, 0.410156),
  float4(0.584314, 0.584314, 0.584314, 0.414062),
  float4(0.580392, 0.580392, 0.580392, 0.417969),
  float4(0.576471, 0.576471, 0.576471, 0.421875),
  float4(0.572549, 0.572549, 0.572549, 0.425781),
  float4(0.568627, 0.568627, 0.568627, 0.429688),
  float4(0.564706, 0.564706, 0.564706, 0.433594),
  float4(0.560784, 0.560784, 0.560784, 0.437500),
  float4(0.556863, 0.556863, 0.556863, 0.441406),
  float4(0.552941, 0.552941, 0.552941, 0.445312),
  float4(0.549020, 0.549020, 0.549020, 0.449219),
  float4(0.545098, 0.545098, 0.545098, 0.453125),
  float4(0.541176, 0.541176, 0.541176, 0.457031),
  float4(0.537255, 0.537255, 0.537255, 0.460938),
  float4(0.533333, 0.533333, 0.533333, 0.464844),
  float4(0.529412, 0.529412, 0.529412, 0.468750),
  float4(0.525490, 0.525490, 0.525490, 0.472656),
  float4(0.521569, 0.521569, 0.521569, 0.476562),
  float4(0.517647, 0.517647, 0.517647, 0.480469),
  float4(0.513725, 0.513725, 0.513725, 0.484375),
  float4(0.509804, 0.509804, 0.509804, 0.488281),
  float4(0.505882, 0.505882, 0.505882, 0.492188),
  float4(0.501961, 0.501961, 0.501961, 0.496094),
  float4(0.498039, 0.498039, 0.498039, 0.500000),
  float4(0.494118, 0.494118, 0.494118, 0.503906),
  float4(0.490196, 0.490196, 0.490196, 0.507812),
  float4(0.486275, 0.486275, 0.486275, 0.511719),
  float4(0.482353, 0.482353, 0.482353, 0.515625),
  float4(0.478431, 0.478431, 0.478431, 0.519531),
  float4(0.474510, 0.474510, 0.474510, 0.523438),
  float4(0.470588, 0.470588, 0.470588, 0.527344),
  float4(0.466667, 0.466667, 0.466667, 0.531250),
  float4(0.462745, 0.462745, 0.462745, 0.535156),
  float4(0.458824, 0.458824, 0.458824, 0.539062),
  float4(0.454902, 0.454902, 0.454902, 0.542969),
  float4(0.450980, 0.450980, 0.450980, 0.546875),
  float4(0.447059, 0.447059, 0.447059, 0.550781),
  float4(0.443137, 0.443137, 0.443137, 0.554688),
  float4(0.439216, 0.439216, 0.439216, 0.558594),
  float4(0.435294, 0.435294, 0.435294, 0.562500),
  float4(0.431373, 0.431373, 0.431373, 0.566406),
  float4(0.427451, 0.427451, 0.427451, 0.570312),
  float4(0.423529, 0.423529, 0.423529, 0.574219),
  float4(0.419608, 0.419608, 0.419608, 0.578125),
  float4(0.415686, 0.415686, 0.415686, 0.582031),
  float4(0.411765, 0.411765, 0.411765, 0.585938),
  float4(0.407843, 0.407843, 0.407843, 0.589844),
  float4(0.403922, 0.403922, 0.403922, 0.593750),
  float4(0.400000, 0.400000, 0.400000, 0.597656),
  float4(0.396078, 0.396078, 0.396078, 0.601562),
  float4(0.392157, 0.392157, 0.392157, 0.605469),
  float4(0.388235, 0.388235, 0.388235, 0.609375),
  float4(0.384314, 0.384314, 0.384314, 0.613281),
  float4(0.380392, 0.380392, 0.380392, 0.617188),
  float4(0.376471, 0.376471, 0.376471, 0.621094),
  float4(0.372549, 0.372549, 0.372549, 0.625000),
  float4(0.368627, 0.368627, 0.368627, 0.628906),
  float4(0.364706, 0.364706, 0.364706, 0.632812),
  float4(0.360784, 0.360784, 0.360784, 0.636719),
  float4(0.356863, 0.356863, 0.356863, 0.640625),
  float4(0.352941, 0.352941, 0.352941, 0.644531),
  float4(0.349020, 0.349020, 0.349020, 0.648438),
  float4(0.345098, 0.345098, 0.345098, 0.652344),
  float4(0.341176, 0.341176, 0.341176, 0.656250),
  float4(0.337255, 0.337255, 0.337255, 0.660156),
  float4(0.333333, 0.333333, 0.333333, 0.664062),
  float4(0.329412, 0.329412, 0.329412, 0.667969),
  float4(0.325490, 0.325490, 0.325490, 0.671875),
  float4(0.321569, 0.321569, 0.321569, 0.675781),
  float4(0.317647, 0.317647, 0.317647, 0.679688),
  float4(0.313725, 0.313725, 0.313725, 0.683594),
  float4(0.309804, 0.309804, 0.309804, 0.687500),
  float4(0.305882, 0.305882, 0.305882, 0.691406),
  float4(0.301961, 0.301961, 0.301961, 0.695312),
  float4(0.298039, 0.298039, 0.298039, 0.699219),
  float4(0.294118, 0.294118, 0.294118, 0.703125),
  float4(0.290196, 0.290196, 0.290196, 0.707031),
  float4(0.286275, 0.286275, 0.286275, 0.710938),
  float4(0.282353, 0.282353, 0.282353, 0.714844),
  float4(0.278431, 0.278431, 0.278431, 0.718750),
  float4(0.274510, 0.274510, 0.274510, 0.722656),
  float4(0.270588, 0.270588, 0.270588, 0.726562),
  float4(0.266667, 0.266667, 0.266667, 0.730469),
  float4(0.262745, 0.262745, 0.262745, 0.734375),
  float4(0.258824, 0.258824, 0.258824, 0.738281),
  float4(0.254902, 0.254902, 0.254902, 0.742188),
  float4(0.250980, 0.250980, 0.250980, 0.746094),
  float4(0.247059, 0.247059, 0.247059, 0.750000),
  float4(0.243137, 0.243137, 0.243137, 0.753906),
  float4(0.239216, 0.239216, 0.239216, 0.757812),
  float4(0.235294, 0.235294, 0.235294, 0.761719),
  float4(0.231373, 0.231373, 0.231373, 0.765625),
  float4(0.227451, 0.227451, 0.227451, 0.769531),
  float4(0.223529, 0.223529, 0.223529, 0.773438),
  float4(0.219608, 0.219608, 0.219608, 0.777344),
  float4(0.215686, 0.215686, 0.215686, 0.781250),
  float4(0.211765, 0.211765, 0.211765, 0.785156),
  float4(0.207843, 0.207843, 0.207843, 0.789062),
  float4(0.203922, 0.203922, 0.203922, 0.792969),
  float4(0.200000, 0.200000, 0.200000, 0.796875),
  float4(0.196078, 0.196078, 0.196078, 0.800781),
  float4(0.192157, 0.192157, 0.192157, 0.804688),
  float4(0.188235, 0.188235, 0.188235, 0.808594),
  float4(0.184314, 0.184314, 0.184314, 0.812500),
  float4(0.180392, 0.180392, 0.180392, 0.816406),
  float4(0.176471, 0.176471, 0.176471, 0.820312),
  float4(0.172549, 0.172549, 0.172549, 0.824219),
  float4(0.168627, 0.168627, 0.168627, 0.828125),
  float4(0.164706, 0.164706, 0.164706, 0.832031),
  float4(0.160784, 0.160784, 0.160784, 0.835938),
  float4(0.156863, 0.156863, 0.156863, 0.839844),
  float4(0.152941, 0.152941, 0.152941, 0.843750),
  float4(0.149020, 0.149020, 0.149020, 0.847656),
  float4(0.145098, 0.145098, 0.145098, 0.851562),
  float4(0.141176, 0.141176, 0.141176, 0.855469),
  float4(0.137255, 0.137255, 0.137255, 0.859375),
  float4(0.133333, 0.133333, 0.133333, 0.863281),
  float4(0.129412, 0.129412, 0.129412, 0.867188),
  float4(0.125490, 0.125490, 0.125490, 0.871094),
  float4(0.121569, 0.121569, 0.121569, 0.875000),
  float4(0.117647, 0.117647, 0.117647, 0.878906),
  float4(0.113725, 0.113725, 0.113725, 0.882812),
  float4(0.109804, 0.109804, 0.109804, 0.886719),
  float4(0.105882, 0.105882, 0.105882, 0.890625),
  float4(0.101961, 0.101961, 0.101961, 0.894531),
  float4(0.098039, 0.098039, 0.098039, 0.898438),
  float4(0.094118, 0.094118, 0.094118, 0.902344),
  float4(0.090196, 0.090196, 0.090196, 0.906250),
  float4(0.086275, 0.086275, 0.086275, 0.910156),
  float4(0.082353, 0.082353, 0.082353, 0.914062),
  float4(0.078431, 0.078431, 0.078431, 0.917969),
  float4(0.074510, 0.074510, 0.074510, 0.921875),
  float4(0.070588, 0.070588, 0.070588, 0.925781),
  float4(0.066667, 0.066667, 0.066667, 0.929688),
  float4(0.062745, 0.062745, 0.062745, 0.933594),
  float4(0.058824, 0.058824, 0.058824, 0.937500),
  float4(0.054902, 0.054902, 0.054902, 0.941406),
  float4(0.050980, 0.050980, 0.050980, 0.945312),
  float4(0.047059, 0.047059, 0.047059, 0.949219),
  float4(0.043137, 0.043137, 0.043137, 0.953125),
  float4(0.039216, 0.039216, 0.039216, 0.957031),
  float4(0.035294, 0.035294, 0.035294, 0.960938),
  float4(0.031373, 0.031373, 0.031373, 0.964844),
  float4(0.027451, 0.027451, 0.027451, 0.968750),
  float4(0.023529, 0.023529, 0.023529, 0.972656),
  float4(0.019608, 0.019608, 0.019608, 0.976562),
  float4(0.015686, 0.015686, 0.015686, 0.980469),
  float4(0.011765, 0.011765, 0.011765, 0.984375),
  float4(0.007843, 0.007843, 0.007843, 0.988281),
  float4(0.003922, 0.003922, 0.003922, 0.992188),
  float4(0.000000, 0.000000, 0.000000, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::GrayTransferFunction
{
  float4(0.000000, 0.000000, 0.000000, 0.000000),
  float4(0.003922, 0.003922, 0.003922, 0.003906),
  float4(0.007843, 0.007843, 0.007843, 0.007812),
  float4(0.011765, 0.011765, 0.011765, 0.011719),
  float4(0.015686, 0.015686, 0.015686, 0.015625),
  float4(0.019608, 0.019608, 0.019608, 0.019531),
  float4(0.023529, 0.023529, 0.023529, 0.023438),
  float4(0.027451, 0.027451, 0.027451, 0.027344),
  float4(0.031373, 0.031373, 0.031373, 0.031250),
  float4(0.035294, 0.035294, 0.035294, 0.035156),
  float4(0.039216, 0.039216, 0.039216, 0.039062),
  float4(0.043137, 0.043137, 0.043137, 0.042969),
  float4(0.047059, 0.047059, 0.047059, 0.046875),
  float4(0.050980, 0.050980, 0.050980, 0.050781),
  float4(0.054902, 0.054902, 0.054902, 0.054688),
  float4(0.058824, 0.058824, 0.058824, 0.058594),
  float4(0.062745, 0.062745, 0.062745, 0.062500),
  float4(0.066667, 0.066667, 0.066667, 0.066406),
  float4(0.070588, 0.070588, 0.070588, 0.070312),
  float4(0.074510, 0.074510, 0.074510, 0.074219),
  float4(0.078431, 0.078431, 0.078431, 0.078125),
  float4(0.082353, 0.082353, 0.082353, 0.082031),
  float4(0.086275, 0.086275, 0.086275, 0.085938),
  float4(0.090196, 0.090196, 0.090196, 0.089844),
  float4(0.094118, 0.094118, 0.094118, 0.093750),
  float4(0.098039, 0.098039, 0.098039, 0.097656),
  float4(0.101961, 0.101961, 0.101961, 0.101562),
  float4(0.105882, 0.105882, 0.105882, 0.105469),
  float4(0.109804, 0.109804, 0.109804, 0.109375),
  float4(0.113725, 0.113725, 0.113725, 0.113281),
  float4(0.117647, 0.117647, 0.117647, 0.117188),
  float4(0.121569, 0.121569, 0.121569, 0.121094),
  float4(0.125490, 0.125490, 0.125490, 0.125000),
  float4(0.129412, 0.129412, 0.129412, 0.128906),
  float4(0.133333, 0.133333, 0.133333, 0.132812),
  float4(0.137255, 0.137255, 0.137255, 0.136719),
  float4(0.141176, 0.141176, 0.141176, 0.140625),
  float4(0.145098, 0.145098, 0.145098, 0.144531),
  float4(0.149020, 0.149020, 0.149020, 0.148438),
  float4(0.152941, 0.152941, 0.152941, 0.152344),
  float4(0.156863, 0.156863, 0.156863, 0.156250),
  float4(0.160784, 0.160784, 0.160784, 0.160156),
  float4(0.164706, 0.164706, 0.164706, 0.164062),
  float4(0.168627, 0.168627, 0.168627, 0.167969),
  float4(0.172549, 0.172549, 0.172549, 0.171875),
  float4(0.176471, 0.176471, 0.176471, 0.175781),
  float4(0.180392, 0.180392, 0.180392, 0.179688),
  float4(0.184314, 0.184314, 0.184314, 0.183594),
  float4(0.188235, 0.188235, 0.188235, 0.187500),
  float4(0.192157, 0.192157, 0.192157, 0.191406),
  float4(0.196078, 0.196078, 0.196078, 0.195312),
  float4(0.200000, 0.200000, 0.200000, 0.199219),
  float4(0.203922, 0.203922, 0.203922, 0.203125),
  float4(0.207843, 0.207843, 0.207843, 0.207031),
  float4(0.211765, 0.211765, 0.211765, 0.210938),
  float4(0.215686, 0.215686, 0.215686, 0.214844),
  float4(0.219608, 0.219608, 0.219608, 0.218750),
  float4(0.223529, 0.223529, 0.223529, 0.222656),
  float4(0.227451, 0.227451, 0.227451, 0.226562),
  float4(0.231373, 0.231373, 0.231373, 0.230469),
  float4(0.235294, 0.235294, 0.235294, 0.234375),
  float4(0.239216, 0.239216, 0.239216, 0.238281),
  float4(0.243137, 0.243137, 0.243137, 0.242188),
  float4(0.247059, 0.247059, 0.247059, 0.246094),
  float4(0.250980, 0.250980, 0.250980, 0.250000),
  float4(0.254902, 0.254902, 0.254902, 0.253906),
  float4(0.258824, 0.258824, 0.258824, 0.257812),
  float4(0.262745, 0.262745, 0.262745, 0.261719),
  float4(0.266667, 0.266667, 0.266667, 0.265625),
  float4(0.270588, 0.270588, 0.270588, 0.269531),
  float4(0.274510, 0.274510, 0.274510, 0.273438),
  float4(0.278431, 0.278431, 0.278431, 0.277344),
  float4(0.282353, 0.282353, 0.282353, 0.281250),
  float4(0.286275, 0.286275, 0.286275, 0.285156),
  float4(0.290196, 0.290196, 0.290196, 0.289062),
  float4(0.294118, 0.294118, 0.294118, 0.292969),
  float4(0.298039, 0.298039, 0.298039, 0.296875),
  float4(0.301961, 0.301961, 0.301961, 0.300781),
  float4(0.305882, 0.305882, 0.305882, 0.304688),
  float4(0.309804, 0.309804, 0.309804, 0.308594),
  float4(0.313725, 0.313725, 0.313725, 0.312500),
  float4(0.317647, 0.317647, 0.317647, 0.316406),
  float4(0.321569, 0.321569, 0.321569, 0.320312),
  float4(0.325490, 0.325490, 0.325490, 0.324219),
  float4(0.329412, 0.329412, 0.329412, 0.328125),
  float4(0.333333, 0.333333, 0.333333, 0.332031),
  float4(0.337255, 0.337255, 0.337255, 0.335938),
  float4(0.341176, 0.341176, 0.341176, 0.339844),
  float4(0.345098, 0.345098, 0.345098, 0.343750),
  float4(0.349020, 0.349020, 0.349020, 0.347656),
  float4(0.352941, 0.352941, 0.352941, 0.351562),
  float4(0.356863, 0.356863, 0.356863, 0.355469),
  float4(0.360784, 0.360784, 0.360784, 0.359375),
  float4(0.364706, 0.364706, 0.364706, 0.363281),
  float4(0.368627, 0.368627, 0.368627, 0.367188),
  float4(0.372549, 0.372549, 0.372549, 0.371094),
  float4(0.376471, 0.376471, 0.376471, 0.375000),
  float4(0.380392, 0.380392, 0.380392, 0.378906),
  float4(0.384314, 0.384314, 0.384314, 0.382812),
  float4(0.388235, 0.388235, 0.388235, 0.386719),
  float4(0.392157, 0.392157, 0.392157, 0.390625),
  float4(0.396078, 0.396078, 0.396078, 0.394531),
  float4(0.400000, 0.400000, 0.400000, 0.398438),
  float4(0.403922, 0.403922, 0.403922, 0.402344),
  float4(0.407843, 0.407843, 0.407843, 0.406250),
  float4(0.411765, 0.411765, 0.411765, 0.410156),
  float4(0.415686, 0.415686, 0.415686, 0.414062),
  float4(0.419608, 0.419608, 0.419608, 0.417969),
  float4(0.423529, 0.423529, 0.423529, 0.421875),
  float4(0.427451, 0.427451, 0.427451, 0.425781),
  float4(0.431373, 0.431373, 0.431373, 0.429688),
  float4(0.435294, 0.435294, 0.435294, 0.433594),
  float4(0.439216, 0.439216, 0.439216, 0.437500),
  float4(0.443137, 0.443137, 0.443137, 0.441406),
  float4(0.447059, 0.447059, 0.447059, 0.445312),
  float4(0.450980, 0.450980, 0.450980, 0.449219),
  float4(0.454902, 0.454902, 0.454902, 0.453125),
  float4(0.458824, 0.458824, 0.458824, 0.457031),
  float4(0.462745, 0.462745, 0.462745, 0.460938),
  float4(0.466667, 0.466667, 0.466667, 0.464844),
  float4(0.470588, 0.470588, 0.470588, 0.468750),
  float4(0.474510, 0.474510, 0.474510, 0.472656),
  float4(0.478431, 0.478431, 0.478431, 0.476562),
  float4(0.482353, 0.482353, 0.482353, 0.480469),
  float4(0.486275, 0.486275, 0.486275, 0.484375),
  float4(0.490196, 0.490196, 0.490196, 0.488281),
  float4(0.494118, 0.494118, 0.494118, 0.492188),
  float4(0.498039, 0.498039, 0.498039, 0.496094),
  float4(0.501961, 0.501961, 0.501961, 0.500000),
  float4(0.505882, 0.505882, 0.505882, 0.503906),
  float4(0.509804, 0.509804, 0.509804, 0.507812),
  float4(0.513725, 0.513725, 0.513725, 0.511719),
  float4(0.517647, 0.517647, 0.517647, 0.515625),
  float4(0.521569, 0.521569, 0.521569, 0.519531),
  float4(0.525490, 0.525490, 0.525490, 0.523438),
  float4(0.529412, 0.529412, 0.529412, 0.527344),
  float4(0.533333, 0.533333, 0.533333, 0.531250),
  float4(0.537255, 0.537255, 0.537255, 0.535156),
  float4(0.541176, 0.541176, 0.541176, 0.539062),
  float4(0.545098, 0.545098, 0.545098, 0.542969),
  float4(0.549020, 0.549020, 0.549020, 0.546875),
  float4(0.552941, 0.552941, 0.552941, 0.550781),
  float4(0.556863, 0.556863, 0.556863, 0.554688),
  float4(0.560784, 0.560784, 0.560784, 0.558594),
  float4(0.564706, 0.564706, 0.564706, 0.562500),
  float4(0.568627, 0.568627, 0.568627, 0.566406),
  float4(0.572549, 0.572549, 0.572549, 0.570312),
  float4(0.576471, 0.576471, 0.576471, 0.574219),
  float4(0.580392, 0.580392, 0.580392, 0.578125),
  float4(0.584314, 0.584314, 0.584314, 0.582031),
  float4(0.588235, 0.588235, 0.588235, 0.585938),
  float4(0.592157, 0.592157, 0.592157, 0.589844),
  float4(0.596078, 0.596078, 0.596078, 0.593750),
  float4(0.600000, 0.600000, 0.600000, 0.597656),
  float4(0.603922, 0.603922, 0.603922, 0.601562),
  float4(0.607843, 0.607843, 0.607843, 0.605469),
  float4(0.611765, 0.611765, 0.611765, 0.609375),
  float4(0.615686, 0.615686, 0.615686, 0.613281),
  float4(0.619608, 0.619608, 0.619608, 0.617188),
  float4(0.623529, 0.623529, 0.623529, 0.621094),
  float4(0.627451, 0.627451, 0.627451, 0.625000),
  float4(0.631373, 0.631373, 0.631373, 0.628906),
  float4(0.635294, 0.635294, 0.635294, 0.632812),
  float4(0.639216, 0.639216, 0.639216, 0.636719),
  float4(0.643137, 0.643137, 0.643137, 0.640625),
  float4(0.647059, 0.647059, 0.647059, 0.644531),
  float4(0.650980, 0.650980, 0.650980, 0.648438),
  float4(0.654902, 0.654902, 0.654902, 0.652344),
  float4(0.658824, 0.658824, 0.658824, 0.656250),
  float4(0.662745, 0.662745, 0.662745, 0.660156),
  float4(0.666667, 0.666667, 0.666667, 0.664062),
  float4(0.670588, 0.670588, 0.670588, 0.667969),
  float4(0.674510, 0.674510, 0.674510, 0.671875),
  float4(0.678431, 0.678431, 0.678431, 0.675781),
  float4(0.682353, 0.682353, 0.682353, 0.679688),
  float4(0.686275, 0.686275, 0.686275, 0.683594),
  float4(0.690196, 0.690196, 0.690196, 0.687500),
  float4(0.694118, 0.694118, 0.694118, 0.691406),
  float4(0.698039, 0.698039, 0.698039, 0.695312),
  float4(0.701961, 0.701961, 0.701961, 0.699219),
  float4(0.705882, 0.705882, 0.705882, 0.703125),
  float4(0.709804, 0.709804, 0.709804, 0.707031),
  float4(0.713725, 0.713725, 0.713725, 0.710938),
  float4(0.717647, 0.717647, 0.717647, 0.714844),
  float4(0.721569, 0.721569, 0.721569, 0.718750),
  float4(0.725490, 0.725490, 0.725490, 0.722656),
  float4(0.729412, 0.729412, 0.729412, 0.726562),
  float4(0.733333, 0.733333, 0.733333, 0.730469),
  float4(0.737255, 0.737255, 0.737255, 0.734375),
  float4(0.741176, 0.741176, 0.741176, 0.738281),
  float4(0.745098, 0.745098, 0.745098, 0.742188),
  float4(0.749020, 0.749020, 0.749020, 0.746094),
  float4(0.752941, 0.752941, 0.752941, 0.750000),
  float4(0.756863, 0.756863, 0.756863, 0.753906),
  float4(0.760784, 0.760784, 0.760784, 0.757812),
  float4(0.764706, 0.764706, 0.764706, 0.761719),
  float4(0.768627, 0.768627, 0.768627, 0.765625),
  float4(0.772549, 0.772549, 0.772549, 0.769531),
  float4(0.776471, 0.776471, 0.776471, 0.773438),
  float4(0.780392, 0.780392, 0.780392, 0.777344),
  float4(0.784314, 0.784314, 0.784314, 0.781250),
  float4(0.788235, 0.788235, 0.788235, 0.785156),
  float4(0.792157, 0.792157, 0.792157, 0.789062),
  float4(0.796078, 0.796078, 0.796078, 0.792969),
  float4(0.800000, 0.800000, 0.800000, 0.796875),
  float4(0.803922, 0.803922, 0.803922, 0.800781),
  float4(0.807843, 0.807843, 0.807843, 0.804688),
  float4(0.811765, 0.811765, 0.811765, 0.808594),
  float4(0.815686, 0.815686, 0.815686, 0.812500),
  float4(0.819608, 0.819608, 0.819608, 0.816406),
  float4(0.823529, 0.823529, 0.823529, 0.820312),
  float4(0.827451, 0.827451, 0.827451, 0.824219),
  float4(0.831373, 0.831373, 0.831373, 0.828125),
  float4(0.835294, 0.835294, 0.835294, 0.832031),
  float4(0.839216, 0.839216, 0.839216, 0.835938),
  float4(0.843137, 0.843137, 0.843137, 0.839844),
  float4(0.847059, 0.847059, 0.847059, 0.843750),
  float4(0.850980, 0.850980, 0.850980, 0.847656),
  float4(0.854902, 0.854902, 0.854902, 0.851562),
  float4(0.858824, 0.858824, 0.858824, 0.855469),
  float4(0.862745, 0.862745, 0.862745, 0.859375),
  float4(0.866667, 0.866667, 0.866667, 0.863281),
  float4(0.870588, 0.870588, 0.870588, 0.867188),
  float4(0.874510, 0.874510, 0.874510, 0.871094),
  float4(0.878431, 0.878431, 0.878431, 0.875000),
  float4(0.882353, 0.882353, 0.882353, 0.878906),
  float4(0.886275, 0.886275, 0.886275, 0.882812),
  float4(0.890196, 0.890196, 0.890196, 0.886719),
  float4(0.894118, 0.894118, 0.894118, 0.890625),
  float4(0.898039, 0.898039, 0.898039, 0.894531),
  float4(0.901961, 0.901961, 0.901961, 0.898438),
  float4(0.905882, 0.905882, 0.905882, 0.902344),
  float4(0.909804, 0.909804, 0.909804, 0.906250),
  float4(0.913725, 0.913725, 0.913725, 0.910156),
  float4(0.917647, 0.917647, 0.917647, 0.914062),
  float4(0.921569, 0.921569, 0.921569, 0.917969),
  float4(0.925490, 0.925490, 0.925490, 0.921875),
  float4(0.929412, 0.929412, 0.929412, 0.925781),
  float4(0.933333, 0.933333, 0.933333, 0.929688),
  float4(0.937255, 0.937255, 0.937255, 0.933594),
  float4(0.941176, 0.941176, 0.941176, 0.937500),
  float4(0.945098, 0.945098, 0.945098, 0.941406),
  float4(0.949020, 0.949020, 0.949020, 0.945312),
  float4(0.952941, 0.952941, 0.952941, 0.949219),
  float4(0.956863, 0.956863, 0.956863, 0.953125),
  float4(0.960784, 0.960784, 0.960784, 0.957031),
  float4(0.964706, 0.964706, 0.964706, 0.960938),
  float4(0.968627, 0.968627, 0.968627, 0.964844),
  float4(0.972549, 0.972549, 0.972549, 0.968750),
  float4(0.976471, 0.976471, 0.976471, 0.972656),
  float4(0.980392, 0.980392, 0.980392, 0.976562),
  float4(0.984314, 0.984314, 0.984314, 0.980469),
  float4(0.988235, 0.988235, 0.988235, 0.984375),
  float4(0.992157, 0.992157, 0.992157, 0.988281),
  float4(0.996078, 0.996078, 0.996078, 0.992188),
  float4(1.000000, 1.000000, 1.000000, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::RainbowTransferFunction
{
  float4(0.500000, 0.000000, 1.000000, 0.000000),
  float4(0.492157, 0.012320, 0.999981, 0.003906),
  float4(0.484314, 0.024637, 0.999924, 0.007812),
  float4(0.476471, 0.036951, 0.999829, 0.011719),
  float4(0.468627, 0.049260, 0.999696, 0.015625),
  float4(0.460784, 0.061561, 0.999526, 0.019531),
  float4(0.452941, 0.073853, 0.999317, 0.023438),
  float4(0.445098, 0.086133, 0.999070, 0.027344),
  float4(0.437255, 0.098400, 0.998786, 0.031250),
  float4(0.429412, 0.110653, 0.998464, 0.035156),
  float4(0.421569, 0.122888, 0.998103, 0.039062),
  float4(0.413725, 0.135105, 0.997705, 0.042969),
  float4(0.405882, 0.147302, 0.997269, 0.046875),
  float4(0.398039, 0.159476, 0.996795, 0.050781),
  float4(0.390196, 0.171626, 0.996284, 0.054688),
  float4(0.382353, 0.183750, 0.995734, 0.058594),
  float4(0.374510, 0.195845, 0.995147, 0.062500),
  float4(0.366667, 0.207912, 0.994522, 0.066406),
  float4(0.358824, 0.219946, 0.993859, 0.070312),
  float4(0.350980, 0.231948, 0.993159, 0.074219),
  float4(0.343137, 0.243914, 0.992421, 0.078125),
  float4(0.335294, 0.255843, 0.991645, 0.082031),
  float4(0.327451, 0.267733, 0.990831, 0.085938),
  float4(0.319608, 0.279583, 0.989980, 0.089844),
  float4(0.311765, 0.291390, 0.989092, 0.093750),
  float4(0.303922, 0.303153, 0.988165, 0.097656),
  float4(0.296078, 0.314870, 0.987202, 0.101562),
  float4(0.288235, 0.326539, 0.986201, 0.105469),
  float4(0.280392, 0.338158, 0.985162, 0.109375),
  float4(0.272549, 0.349727, 0.984086, 0.113281),
  float4(0.264706, 0.361242, 0.982973, 0.117188),
  float4(0.256863, 0.372702, 0.981823, 0.121094),
  float4(0.249020, 0.384106, 0.980635, 0.125000),
  float4(0.241176, 0.395451, 0.979410, 0.128906),
  float4(0.233333, 0.406737, 0.978148, 0.132812),
  float4(0.225490, 0.417960, 0.976848, 0.136719),
  float4(0.217647, 0.429121, 0.975512, 0.140625),
  float4(0.209804, 0.440216, 0.974139, 0.144531),
  float4(0.201961, 0.451244, 0.972728, 0.148438),
  float4(0.194118, 0.462204, 0.971281, 0.152344),
  float4(0.186275, 0.473094, 0.969797, 0.156250),
  float4(0.178431, 0.483911, 0.968276, 0.160156),
  float4(0.170588, 0.494656, 0.966718, 0.164062),
  float4(0.162745, 0.505325, 0.965124, 0.167969),
  float4(0.154902, 0.515918, 0.963493, 0.171875),
  float4(0.147059, 0.526432, 0.961826, 0.175781),
  float4(0.139216, 0.536867, 0.960122, 0.179688),
  float4(0.131373, 0.547220, 0.958381, 0.183594),
  float4(0.123529, 0.557489, 0.956604, 0.187500),
  float4(0.115686, 0.567675, 0.954791, 0.191406),
  float4(0.107843, 0.577774, 0.952942, 0.195312),
  float4(0.100000, 0.587785, 0.951057, 0.199219),
  float4(0.092157, 0.597707, 0.949135, 0.203125),
  float4(0.084314, 0.607539, 0.947177, 0.207031),
  float4(0.076471, 0.617278, 0.945184, 0.210938),
  float4(0.068627, 0.626924, 0.943154, 0.214844),
  float4(0.060784, 0.636474, 0.941089, 0.218750),
  float4(0.052941, 0.645928, 0.938988, 0.222656),
  float4(0.045098, 0.655284, 0.936852, 0.226562),
  float4(0.037255, 0.664540, 0.934680, 0.230469),
  float4(0.029412, 0.673696, 0.932472, 0.234375),
  float4(0.021569, 0.682749, 0.930229, 0.238281),
  float4(0.013725, 0.691698, 0.927951, 0.242188),
  float4(0.005882, 0.700543, 0.925638, 0.246094),
  float4(0.001961, 0.709281, 0.923289, 0.250000),
  float4(0.009804, 0.717912, 0.920906, 0.253906),
  float4(0.017647, 0.726434, 0.918487, 0.257812),
  float4(0.025490, 0.734845, 0.916034, 0.261719),
  float4(0.033333, 0.743145, 0.913545, 0.265625),
  float4(0.041176, 0.751332, 0.911023, 0.269531),
  float4(0.049020, 0.759405, 0.908465, 0.273438),
  float4(0.056863, 0.767363, 0.905873, 0.277344),
  float4(0.064706, 0.775204, 0.903247, 0.281250),
  float4(0.072549, 0.782928, 0.900587, 0.285156),
  float4(0.080392, 0.790532, 0.897892, 0.289062),
  float4(0.088235, 0.798017, 0.895163, 0.292969),
  float4(0.096078, 0.805381, 0.892401, 0.296875),
  float4(0.103922, 0.812622, 0.889604, 0.300781),
  float4(0.111765, 0.819740, 0.886774, 0.304688),
  float4(0.119608, 0.826734, 0.883910, 0.308594),
  float4(0.127451, 0.833602, 0.881012, 0.312500),
  float4(0.135294, 0.840344, 0.878081, 0.316406),
  float4(0.143137, 0.846958, 0.875117, 0.320312),
  float4(0.150980, 0.853444, 0.872120, 0.324219),
  float4(0.158824, 0.859800, 0.869089, 0.328125),
  float4(0.166667, 0.866025, 0.866025, 0.332031),
  float4(0.174510, 0.872120, 0.862929, 0.335938),
  float4(0.182353, 0.878081, 0.859800, 0.339844),
  float4(0.190196, 0.883910, 0.856638, 0.343750),
  float4(0.198039, 0.889604, 0.853444, 0.347656),
  float4(0.205882, 0.895163, 0.850217, 0.351562),
  float4(0.213725, 0.900587, 0.846958, 0.355469),
  float4(0.221569, 0.905873, 0.843667, 0.359375),
  float4(0.229412, 0.911023, 0.840344, 0.363281),
  float4(0.237255, 0.916034, 0.836989, 0.367188),
  float4(0.245098, 0.920906, 0.833602, 0.371094),
  float4(0.252941, 0.925638, 0.830184, 0.375000),
  float4(0.260784, 0.930229, 0.826734, 0.378906),
  float4(0.268627, 0.934680, 0.823253, 0.382812),
  float4(0.276471, 0.938988, 0.819740, 0.386719),
  float4(0.284314, 0.943154, 0.816197, 0.390625),
  float4(0.292157, 0.947177, 0.812622, 0.394531),
  float4(0.300000, 0.951057, 0.809017, 0.398438),
  float4(0.307843, 0.954791, 0.805381, 0.402344),
  float4(0.315686, 0.958381, 0.801714, 0.406250),
  float4(0.323529, 0.961826, 0.798017, 0.410156),
  float4(0.331373, 0.965124, 0.794290, 0.414062),
  float4(0.339216, 0.968276, 0.790532, 0.417969),
  float4(0.347059, 0.971281, 0.786745, 0.421875),
  float4(0.354902, 0.974139, 0.782928, 0.425781),
  float4(0.362745, 0.976848, 0.779081, 0.429688),
  float4(0.370588, 0.979410, 0.775204, 0.433594),
  float4(0.378431, 0.981823, 0.771298, 0.437500),
  float4(0.386275, 0.984086, 0.767363, 0.441406),
  float4(0.394118, 0.986201, 0.763398, 0.445312),
  float4(0.401961, 0.988165, 0.759405, 0.449219),
  float4(0.409804, 0.989980, 0.755383, 0.453125),
  float4(0.417647, 0.991645, 0.751332, 0.457031),
  float4(0.425490, 0.993159, 0.747253, 0.460938),
  float4(0.433333, 0.994522, 0.743145, 0.464844),
  float4(0.441176, 0.995734, 0.739009, 0.468750),
  float4(0.449020, 0.996795, 0.734845, 0.472656),
  float4(0.456863, 0.997705, 0.730653, 0.476562),
  float4(0.464706, 0.998464, 0.726434, 0.480469),
  float4(0.472549, 0.999070, 0.722186, 0.484375),
  float4(0.480392, 0.999526, 0.717912, 0.488281),
  float4(0.488235, 0.999829, 0.713610, 0.492188),
  float4(0.496078, 0.999981, 0.709281, 0.496094),
  float4(0.503922, 0.999981, 0.704926, 0.500000),
  float4(0.511765, 0.999829, 0.700543, 0.503906),
  float4(0.519608, 0.999526, 0.696134, 0.507812),
  float4(0.527451, 0.999070, 0.691698, 0.511719),
  float4(0.535294, 0.998464, 0.687237, 0.515625),
  float4(0.543137, 0.997705, 0.682749, 0.519531),
  float4(0.550980, 0.996795, 0.678235, 0.523438),
  float4(0.558824, 0.995734, 0.673696, 0.527344),
  float4(0.566667, 0.994522, 0.669131, 0.531250),
  float4(0.574510, 0.993159, 0.664540, 0.535156),
  float4(0.582353, 0.991645, 0.659925, 0.539062),
  float4(0.590196, 0.989980, 0.655284, 0.542969),
  float4(0.598039, 0.988165, 0.650618, 0.546875),
  float4(0.605882, 0.986201, 0.645928, 0.550781),
  float4(0.613725, 0.984086, 0.641213, 0.554688),
  float4(0.621569, 0.981823, 0.636474, 0.558594),
  float4(0.629412, 0.979410, 0.631711, 0.562500),
  float4(0.637255, 0.976848, 0.626924, 0.566406),
  float4(0.645098, 0.974139, 0.622113, 0.570312),
  float4(0.652941, 0.971281, 0.617278, 0.574219),
  float4(0.660784, 0.968276, 0.612420, 0.578125),
  float4(0.668627, 0.965124, 0.607539, 0.582031),
  float4(0.676471, 0.961826, 0.602635, 0.585938),
  float4(0.684314, 0.958381, 0.597707, 0.589844),
  float4(0.692157, 0.954791, 0.592758, 0.593750),
  float4(0.700000, 0.951057, 0.587785, 0.597656),
  float4(0.707843, 0.947177, 0.582791, 0.601562),
  float4(0.715686, 0.943154, 0.577774, 0.605469),
  float4(0.723529, 0.938988, 0.572735, 0.609375),
  float4(0.731373, 0.934680, 0.567675, 0.613281),
  float4(0.739216, 0.930229, 0.562593, 0.617188),
  float4(0.747059, 0.925638, 0.557489, 0.621094),
  float4(0.754902, 0.920906, 0.552365, 0.625000),
  float4(0.762745, 0.916034, 0.547220, 0.628906),
  float4(0.770588, 0.911023, 0.542053, 0.632812),
  float4(0.778431, 0.905873, 0.536867, 0.636719),
  float4(0.786275, 0.900587, 0.531659, 0.640625),
  float4(0.794118, 0.895163, 0.526432, 0.644531),
  float4(0.801961, 0.889604, 0.521185, 0.648438),
  float4(0.809804, 0.883910, 0.515918, 0.652344),
  float4(0.817647, 0.878081, 0.510631, 0.656250),
  float4(0.825490, 0.872120, 0.505325, 0.660156),
  float4(0.833333, 0.866025, 0.500000, 0.664062),
  float4(0.841176, 0.859800, 0.494656, 0.667969),
  float4(0.849020, 0.853444, 0.489293, 0.671875),
  float4(0.856863, 0.846958, 0.483911, 0.675781),
  float4(0.864706, 0.840344, 0.478512, 0.679688),
  float4(0.872549, 0.833602, 0.473094, 0.683594),
  float4(0.880392, 0.826734, 0.467658, 0.687500),
  float4(0.888235, 0.819740, 0.462204, 0.691406),
  float4(0.896078, 0.812622, 0.456733, 0.695312),
  float4(0.903922, 0.805381, 0.451244, 0.699219),
  float4(0.911765, 0.798017, 0.445738, 0.703125),
  float4(0.919608, 0.790532, 0.440216, 0.707031),
  float4(0.927451, 0.782928, 0.434676, 0.710938),
  float4(0.935294, 0.775204, 0.429121, 0.714844),
  float4(0.943137, 0.767363, 0.423549, 0.718750),
  float4(0.950980, 0.759405, 0.417960, 0.722656),
  float4(0.958824, 0.751332, 0.412356, 0.726562),
  float4(0.966667, 0.743145, 0.406737, 0.730469),
  float4(0.974510, 0.734845, 0.401102, 0.734375),
  float4(0.982353, 0.726434, 0.395451, 0.738281),
  float4(0.990196, 0.717912, 0.389786, 0.742188),
  float4(0.998039, 0.709281, 0.384106, 0.746094),
  float4(1.000000, 0.700543, 0.378411, 0.750000),
  float4(1.000000, 0.691698, 0.372702, 0.753906),
  float4(1.000000, 0.682749, 0.366979, 0.757812),
  float4(1.000000, 0.673696, 0.361242, 0.761719),
  float4(1.000000, 0.664540, 0.355491, 0.765625),
  float4(1.000000, 0.655284, 0.349727, 0.769531),
  float4(1.000000, 0.645928, 0.343949, 0.773438),
  float4(1.000000, 0.636474, 0.338158, 0.777344),
  float4(1.000000, 0.626924, 0.332355, 0.781250),
  float4(1.000000, 0.617278, 0.326539, 0.785156),
  float4(1.000000, 0.607539, 0.320710, 0.789062),
  float4(1.000000, 0.597707, 0.314870, 0.792969),
  float4(1.000000, 0.587785, 0.309017, 0.796875),
  float4(1.000000, 0.577774, 0.303153, 0.800781),
  float4(1.000000, 0.567675, 0.297277, 0.804688),
  float4(1.000000, 0.557489, 0.291390, 0.808594),
  float4(1.000000, 0.547220, 0.285492, 0.812500),
  float4(1.000000, 0.536867, 0.279583, 0.816406),
  float4(1.000000, 0.526432, 0.273663, 0.820312),
  float4(1.000000, 0.515918, 0.267733, 0.824219),
  float4(1.000000, 0.505325, 0.261793, 0.828125),
  float4(1.000000, 0.494656, 0.255843, 0.832031),
  float4(1.000000, 0.483911, 0.249883, 0.835938),
  float4(1.000000, 0.473094, 0.243914, 0.839844),
  float4(1.000000, 0.462204, 0.237935, 0.843750),
  float4(1.000000, 0.451244, 0.231948, 0.847656),
  float4(1.000000, 0.440216, 0.225951, 0.851562),
  float4(1.000000, 0.429121, 0.219946, 0.855469),
  float4(1.000000, 0.417960, 0.213933, 0.859375),
  float4(1.000000, 0.406737, 0.207912, 0.863281),
  float4(1.000000, 0.395451, 0.201882, 0.867188),
  float4(1.000000, 0.384106, 0.195845, 0.871094),
  float4(1.000000, 0.372702, 0.189801, 0.875000),
  float4(1.000000, 0.361242, 0.183750, 0.878906),
  float4(1.000000, 0.349727, 0.177691, 0.882812),
  float4(1.000000, 0.338158, 0.171626, 0.886719),
  float4(1.000000, 0.326539, 0.165554, 0.890625),
  float4(1.000000, 0.314870, 0.159476, 0.894531),
  float4(1.000000, 0.303153, 0.153392, 0.898438),
  float4(1.000000, 0.291390, 0.147302, 0.902344),
  float4(1.000000, 0.279583, 0.141206, 0.906250),
  float4(1.000000, 0.267733, 0.135105, 0.910156),
  float4(1.000000, 0.255843, 0.128999, 0.914062),
  float4(1.000000, 0.243914, 0.122888, 0.917969),
  float4(1.000000, 0.231948, 0.116773, 0.921875),
  float4(1.000000, 0.219946, 0.110653, 0.925781),
  float4(1.000000, 0.207912, 0.104528, 0.929688),
  float4(1.000000, 0.195845, 0.098400, 0.933594),
  float4(1.000000, 0.183750, 0.092268, 0.937500),
  float4(1.000000, 0.171626, 0.086133, 0.941406),
  float4(1.000000, 0.159476, 0.079994, 0.945312),
  float4(1.000000, 0.147302, 0.073853, 0.949219),
  float4(1.000000, 0.135105, 0.067708, 0.953125),
  float4(1.000000, 0.122888, 0.061561, 0.957031),
  float4(1.000000, 0.110653, 0.055411, 0.960938),
  float4(1.000000, 0.098400, 0.049260, 0.964844),
  float4(1.000000, 0.086133, 0.043107, 0.968750),
  float4(1.000000, 0.073853, 0.036951, 0.972656),
  float4(1.000000, 0.061561, 0.030795, 0.976562),
  float4(1.000000, 0.049260, 0.024637, 0.980469),
  float4(1.000000, 0.036951, 0.018479, 0.984375),
  float4(1.000000, 0.024637, 0.012320, 0.988281),
  float4(1.000000, 0.012320, 0.006160, 0.992188),
  float4(1.000000, 0.000000, 0.000000, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::TurboTransferFunction
{
  float4(0.189950, 0.071760, 0.232170, 0.000000),
  float4(0.194830, 0.083390, 0.261490, 0.003906),
  float4(0.199560, 0.094980, 0.290240, 0.007812),
  float4(0.204150, 0.106520, 0.318440, 0.011719),
  float4(0.208600, 0.118020, 0.346070, 0.015625),
  float4(0.212910, 0.129470, 0.373140, 0.019531),
  float4(0.217080, 0.140870, 0.399640, 0.023438),
  float4(0.221110, 0.152230, 0.425580, 0.027344),
  float4(0.225000, 0.163540, 0.450960, 0.031250),
  float4(0.228750, 0.174810, 0.475780, 0.035156),
  float4(0.232360, 0.186030, 0.500040, 0.039062),
  float4(0.235820, 0.197200, 0.523730, 0.042969),
  float4(0.239150, 0.208330, 0.546860, 0.046875),
  float4(0.242340, 0.219410, 0.569420, 0.050781),
  float4(0.245390, 0.230440, 0.591420, 0.054688),
  float4(0.248300, 0.241430, 0.612860, 0.058594),
  float4(0.251070, 0.252370, 0.633740, 0.062500),
  float4(0.253690, 0.263270, 0.654060, 0.066406),
  float4(0.256180, 0.274120, 0.673810, 0.070312),
  float4(0.258530, 0.284920, 0.693000, 0.074219),
  float4(0.260740, 0.295680, 0.711620, 0.078125),
  float4(0.262800, 0.306390, 0.729680, 0.082031),
  float4(0.264730, 0.317060, 0.747180, 0.085938),
  float4(0.266520, 0.327680, 0.764120, 0.089844),
  float4(0.268160, 0.338250, 0.780500, 0.093750),
  float4(0.269670, 0.348780, 0.796310, 0.097656),
  float4(0.271030, 0.359260, 0.811560, 0.101562),
  float4(0.272260, 0.369700, 0.826240, 0.105469),
  float4(0.273340, 0.380080, 0.840370, 0.109375),
  float4(0.274290, 0.390430, 0.853930, 0.113281),
  float4(0.275090, 0.400720, 0.866920, 0.117188),
  float4(0.275760, 0.410970, 0.879360, 0.121094),
  float4(0.276280, 0.421180, 0.891230, 0.125000),
  float4(0.276670, 0.431340, 0.902540, 0.128906),
  float4(0.276910, 0.441450, 0.913280, 0.132812),
  float4(0.277010, 0.451520, 0.923470, 0.136719),
  float4(0.276980, 0.461530, 0.933090, 0.140625),
  float4(0.276800, 0.471510, 0.942140, 0.144531),
  float4(0.276480, 0.481440, 0.950640, 0.148438),
  float4(0.276030, 0.491320, 0.958570, 0.152344),
  float4(0.275430, 0.501150, 0.965940, 0.156250),
  float4(0.274690, 0.510940, 0.972750, 0.160156),
  float4(0.273810, 0.520690, 0.978990, 0.164062),
  float4(0.272730, 0.530400, 0.984610, 0.167969),
  float4(0.271060, 0.540150, 0.989300, 0.171875),
  float4(0.268780, 0.549950, 0.993030, 0.175781),
  float4(0.265920, 0.559790, 0.995830, 0.179688),
  float4(0.262520, 0.569670, 0.997730, 0.183594),
  float4(0.258620, 0.579580, 0.998760, 0.187500),
  float4(0.254250, 0.589500, 0.998960, 0.191406),
  float4(0.249460, 0.599430, 0.998350, 0.195312),
  float4(0.244270, 0.609370, 0.996970, 0.199219),
  float4(0.238740, 0.619310, 0.994850, 0.203125),
  float4(0.232880, 0.629230, 0.992020, 0.207031),
  float4(0.226760, 0.639130, 0.988510, 0.210938),
  float4(0.220390, 0.649010, 0.984360, 0.214844),
  float4(0.213820, 0.658860, 0.979590, 0.218750),
  float4(0.207080, 0.668660, 0.974230, 0.222656),
  float4(0.200210, 0.678420, 0.968330, 0.226562),
  float4(0.193260, 0.688120, 0.961900, 0.230469),
  float4(0.186250, 0.697750, 0.954980, 0.234375),
  float4(0.179230, 0.707320, 0.947610, 0.238281),
  float4(0.172230, 0.716800, 0.939810, 0.242188),
  float4(0.165290, 0.726200, 0.931610, 0.246094),
  float4(0.158440, 0.735510, 0.923050, 0.250000),
  float4(0.151730, 0.744720, 0.914160, 0.253906),
  float4(0.145190, 0.753810, 0.904960, 0.257812),
  float4(0.138860, 0.762790, 0.895500, 0.261719),
  float4(0.132780, 0.771650, 0.885800, 0.265625),
  float4(0.126980, 0.780370, 0.875900, 0.269531),
  float4(0.121510, 0.788960, 0.865810, 0.273438),
  float4(0.116390, 0.797400, 0.855590, 0.277344),
  float4(0.111670, 0.805690, 0.845250, 0.281250),
  float4(0.107380, 0.813810, 0.834840, 0.285156),
  float4(0.103570, 0.821770, 0.824370, 0.289062),
  float4(0.100260, 0.829550, 0.813890, 0.292969),
  float4(0.097500, 0.837140, 0.803420, 0.296875),
  float4(0.095320, 0.844550, 0.792990, 0.300781),
  float4(0.093770, 0.851750, 0.782640, 0.304688),
  float4(0.092870, 0.858750, 0.772400, 0.308594),
  float4(0.092670, 0.865540, 0.762300, 0.312500),
  float4(0.093200, 0.872110, 0.752370, 0.316406),
  float4(0.094510, 0.878440, 0.742650, 0.320312),
  float4(0.096620, 0.884540, 0.733160, 0.324219),
  float4(0.099580, 0.890400, 0.723930, 0.328125),
  float4(0.103420, 0.896000, 0.715000, 0.332031),
  float4(0.108150, 0.901420, 0.705990, 0.335938),
  float4(0.113740, 0.906730, 0.696510, 0.339844),
  float4(0.120140, 0.911930, 0.686600, 0.343750),
  float4(0.127330, 0.917010, 0.676270, 0.347656),
  float4(0.135260, 0.921970, 0.665560, 0.351562),
  float4(0.143910, 0.926800, 0.654480, 0.355469),
  float4(0.153230, 0.931510, 0.643080, 0.359375),
  float4(0.163190, 0.936090, 0.631370, 0.363281),
  float4(0.173770, 0.940530, 0.619380, 0.367188),
  float4(0.184910, 0.944840, 0.607130, 0.371094),
  float4(0.196590, 0.949010, 0.594660, 0.375000),
  float4(0.208770, 0.953040, 0.581990, 0.378906),
  float4(0.221420, 0.956920, 0.569140, 0.382812),
  float4(0.234490, 0.960650, 0.556140, 0.386719),
  float4(0.247970, 0.964230, 0.543030, 0.390625),
  float4(0.261800, 0.967650, 0.529810, 0.394531),
  float4(0.275970, 0.970920, 0.516530, 0.398438),
  float4(0.290420, 0.974030, 0.503210, 0.402344),
  float4(0.305130, 0.976970, 0.489870, 0.406250),
  float4(0.320060, 0.979740, 0.476540, 0.410156),
  float4(0.335170, 0.982340, 0.463250, 0.414062),
  float4(0.350430, 0.984770, 0.450020, 0.417969),
  float4(0.365810, 0.987020, 0.436880, 0.421875),
  float4(0.381270, 0.989090, 0.423860, 0.425781),
  float4(0.396780, 0.990980, 0.410980, 0.429688),
  float4(0.412290, 0.992680, 0.398260, 0.433594),
  float4(0.427780, 0.994190, 0.385750, 0.437500),
  float4(0.443210, 0.995510, 0.373450, 0.441406),
  float4(0.458540, 0.996630, 0.361400, 0.445312),
  float4(0.473750, 0.997550, 0.349630, 0.449219),
  float4(0.488790, 0.998280, 0.338160, 0.453125),
  float4(0.503620, 0.998790, 0.327010, 0.457031),
  float4(0.518220, 0.999100, 0.316220, 0.460938),
  float4(0.532550, 0.999190, 0.305810, 0.464844),
  float4(0.546580, 0.999070, 0.295810, 0.468750),
  float4(0.560260, 0.998730, 0.286230, 0.472656),
  float4(0.573570, 0.998170, 0.277120, 0.476562),
  float4(0.586460, 0.997390, 0.268490, 0.480469),
  float4(0.598910, 0.996380, 0.260380, 0.484375),
  float4(0.610880, 0.995140, 0.252800, 0.488281),
  float4(0.622330, 0.993660, 0.245790, 0.492188),
  float4(0.633230, 0.991950, 0.239370, 0.496094),
  float4(0.643620, 0.989990, 0.233560, 0.500000),
  float4(0.653940, 0.987750, 0.228350, 0.503906),
  float4(0.664280, 0.985240, 0.223700, 0.507812),
  float4(0.674620, 0.982460, 0.219600, 0.511719),
  float4(0.684940, 0.979410, 0.216020, 0.515625),
  float4(0.695250, 0.976100, 0.212940, 0.519531),
  float4(0.705530, 0.972550, 0.210320, 0.523438),
  float4(0.715770, 0.968750, 0.208150, 0.527344),
  float4(0.725960, 0.964700, 0.206400, 0.531250),
  float4(0.736100, 0.960430, 0.205040, 0.535156),
  float4(0.746170, 0.955930, 0.204060, 0.539062),
  float4(0.756170, 0.951210, 0.203430, 0.542969),
  float4(0.766080, 0.946270, 0.203110, 0.546875),
  float4(0.775910, 0.941130, 0.203100, 0.550781),
  float4(0.785630, 0.935790, 0.203360, 0.554688),
  float4(0.795240, 0.930250, 0.203860, 0.558594),
  float4(0.804730, 0.924520, 0.204590, 0.562500),
  float4(0.814100, 0.918610, 0.205520, 0.566406),
  float4(0.823330, 0.912530, 0.206630, 0.570312),
  float4(0.832410, 0.906270, 0.207880, 0.574219),
  float4(0.841330, 0.899860, 0.209260, 0.578125),
  float4(0.850100, 0.893280, 0.210740, 0.582031),
  float4(0.858680, 0.886550, 0.212300, 0.585938),
  float4(0.867090, 0.879680, 0.213910, 0.589844),
  float4(0.875300, 0.872670, 0.215550, 0.593750),
  float4(0.883310, 0.865530, 0.217190, 0.597656),
  float4(0.891120, 0.858260, 0.218800, 0.601562),
  float4(0.898700, 0.850870, 0.220380, 0.605469),
  float4(0.906050, 0.843370, 0.221880, 0.609375),
  float4(0.913170, 0.835760, 0.223280, 0.613281),
  float4(0.920040, 0.828060, 0.224560, 0.617188),
  float4(0.926660, 0.820250, 0.225700, 0.621094),
  float4(0.933010, 0.812360, 0.226670, 0.625000),
  float4(0.939090, 0.804390, 0.227440, 0.628906),
  float4(0.944890, 0.796340, 0.228000, 0.632812),
  float4(0.950390, 0.788230, 0.228310, 0.636719),
  float4(0.955600, 0.780050, 0.228360, 0.640625),
  float4(0.960490, 0.771810, 0.228110, 0.644531),
  float4(0.965070, 0.763520, 0.227540, 0.648438),
  float4(0.969310, 0.755190, 0.226630, 0.652344),
  float4(0.973230, 0.746820, 0.225360, 0.656250),
  float4(0.976790, 0.738420, 0.223690, 0.660156),
  float4(0.980000, 0.730000, 0.221610, 0.664062),
  float4(0.982890, 0.721400, 0.219180, 0.667969),
  float4(0.985490, 0.712500, 0.216500, 0.671875),
  float4(0.987810, 0.703300, 0.213580, 0.675781),
  float4(0.989860, 0.693820, 0.210430, 0.679688),
  float4(0.991630, 0.684080, 0.207060, 0.683594),
  float4(0.993140, 0.674080, 0.203480, 0.687500),
  float4(0.994380, 0.663860, 0.199710, 0.691406),
  float4(0.995350, 0.653410, 0.195770, 0.695312),
  float4(0.996070, 0.642770, 0.191650, 0.699219),
  float4(0.996540, 0.631930, 0.187380, 0.703125),
  float4(0.996750, 0.620930, 0.182970, 0.707031),
  float4(0.996720, 0.609770, 0.178420, 0.710938),
  float4(0.996440, 0.598460, 0.173760, 0.714844),
  float4(0.995930, 0.587030, 0.168990, 0.718750),
  float4(0.995170, 0.575490, 0.164120, 0.722656),
  float4(0.994190, 0.563860, 0.159180, 0.726562),
  float4(0.992970, 0.552140, 0.154170, 0.730469),
  float4(0.991530, 0.540360, 0.149100, 0.734375),
  float4(0.989870, 0.528540, 0.143980, 0.738281),
  float4(0.987990, 0.516670, 0.138830, 0.742188),
  float4(0.985900, 0.504790, 0.133670, 0.746094),
  float4(0.983600, 0.492910, 0.128490, 0.750000),
  float4(0.981080, 0.481040, 0.123320, 0.753906),
  float4(0.978370, 0.469200, 0.118170, 0.757812),
  float4(0.975450, 0.457400, 0.113050, 0.761719),
  float4(0.972340, 0.445650, 0.107970, 0.765625),
  float4(0.969040, 0.433990, 0.102940, 0.769531),
  float4(0.965550, 0.422410, 0.097980, 0.773438),
  float4(0.961870, 0.410930, 0.093100, 0.777344),
  float4(0.958010, 0.399580, 0.088310, 0.781250),
  float4(0.953980, 0.388360, 0.083620, 0.785156),
  float4(0.949770, 0.377290, 0.079050, 0.789062),
  float4(0.945380, 0.366380, 0.074610, 0.792969),
  float4(0.940840, 0.355660, 0.070310, 0.796875),
  float4(0.936120, 0.345130, 0.066160, 0.800781),
  float4(0.931250, 0.334820, 0.062180, 0.804688),
  float4(0.926230, 0.324730, 0.058370, 0.808594),
  float4(0.921050, 0.314890, 0.054750, 0.812500),
  float4(0.915720, 0.305300, 0.051340, 0.816406),
  float4(0.910240, 0.295990, 0.048140, 0.820312),
  float4(0.904630, 0.286960, 0.045160, 0.824219),
  float4(0.898880, 0.278240, 0.042430, 0.828125),
  float4(0.892980, 0.269810, 0.039930, 0.832031),
  float4(0.886910, 0.261520, 0.037530, 0.835938),
  float4(0.880660, 0.253340, 0.035210, 0.839844),
  float4(0.874220, 0.245260, 0.032970, 0.843750),
  float4(0.867600, 0.237300, 0.030820, 0.847656),
  float4(0.860790, 0.229450, 0.028750, 0.851562),
  float4(0.853800, 0.221700, 0.026770, 0.855469),
  float4(0.846620, 0.214070, 0.024870, 0.859375),
  float4(0.839260, 0.206540, 0.023050, 0.863281),
  float4(0.831720, 0.199120, 0.021310, 0.867188),
  float4(0.823990, 0.191820, 0.019660, 0.871094),
  float4(0.816080, 0.184620, 0.018090, 0.875000),
  float4(0.807990, 0.177530, 0.016600, 0.878906),
  float4(0.799710, 0.170550, 0.015200, 0.882812),
  float4(0.791250, 0.163680, 0.013870, 0.886719),
  float4(0.782600, 0.156930, 0.012640, 0.890625),
  float4(0.773770, 0.150280, 0.011480, 0.894531),
  float4(0.764760, 0.143740, 0.010410, 0.898438),
  float4(0.755560, 0.137310, 0.009420, 0.902344),
  float4(0.746170, 0.130980, 0.008510, 0.906250),
  float4(0.736610, 0.124770, 0.007690, 0.910156),
  float4(0.726860, 0.118670, 0.006950, 0.914062),
  float4(0.716920, 0.112680, 0.006290, 0.917969),
  float4(0.706800, 0.106800, 0.005710, 0.921875),
  float4(0.696500, 0.101020, 0.005220, 0.925781),
  float4(0.686020, 0.095360, 0.004810, 0.929688),
  float4(0.675350, 0.089800, 0.004490, 0.933594),
  float4(0.664490, 0.084360, 0.004240, 0.937500),
  float4(0.653450, 0.079020, 0.004080, 0.941406),
  float4(0.642230, 0.073800, 0.004010, 0.945312),
  float4(0.630820, 0.068680, 0.004010, 0.949219),
  float4(0.619230, 0.063670, 0.004100, 0.953125),
  float4(0.607460, 0.058780, 0.004270, 0.957031),
  float4(0.595500, 0.053990, 0.004530, 0.960938),
  float4(0.583360, 0.049310, 0.004860, 0.964844),
  float4(0.571030, 0.044740, 0.005290, 0.968750),
  float4(0.558520, 0.040280, 0.005790, 0.972656),
  float4(0.545830, 0.035930, 0.006380, 0.976562),
  float4(0.532950, 0.031690, 0.007050, 0.980469),
  float4(0.519890, 0.027560, 0.007800, 0.984375),
  float4(0.506640, 0.023540, 0.008630, 0.988281),
  float4(0.493210, 0.019630, 0.009550, 0.992188),
  float4(0.479600, 0.015830, 0.010550, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::GnuplotTransferFunction
{
  float4(0.000000, 0.000000, 0.000000, 0.000000),
   float4(0.000000, 0.000000, 0.015686, 0.003906),
   float4(0.000000, 0.000000, 0.031373, 0.007812),
   float4(0.000000, 0.000000, 0.047059, 0.011719),
   float4(0.000000, 0.000000, 0.062745, 0.015625),
   float4(0.000000, 0.000000, 0.078431, 0.019531),
   float4(0.000000, 0.000000, 0.094118, 0.023438),
   float4(0.000000, 0.000000, 0.109804, 0.027344),
   float4(0.000000, 0.000000, 0.125490, 0.031250),
   float4(0.000000, 0.000000, 0.141176, 0.035156),
   float4(0.000000, 0.000000, 0.156863, 0.039062),
   float4(0.000000, 0.000000, 0.172549, 0.042969),
   float4(0.000000, 0.000000, 0.188235, 0.046875),
   float4(0.000000, 0.000000, 0.203922, 0.050781),
   float4(0.000000, 0.000000, 0.219608, 0.054688),
   float4(0.000000, 0.000000, 0.235294, 0.058594),
   float4(0.000000, 0.000000, 0.250980, 0.062500),
   float4(0.000000, 0.000000, 0.266667, 0.066406),
   float4(0.000000, 0.000000, 0.282353, 0.070312),
   float4(0.000000, 0.000000, 0.298039, 0.074219),
   float4(0.000000, 0.000000, 0.313725, 0.078125),
   float4(0.000000, 0.000000, 0.329412, 0.082031),
   float4(0.000000, 0.000000, 0.345098, 0.085938),
   float4(0.000000, 0.000000, 0.360784, 0.089844),
   float4(0.000000, 0.000000, 0.376471, 0.093750),
   float4(0.000000, 0.000000, 0.392157, 0.097656),
   float4(0.000000, 0.000000, 0.407843, 0.101562),
   float4(0.000000, 0.000000, 0.423529, 0.105469),
   float4(0.000000, 0.000000, 0.439216, 0.109375),
   float4(0.000000, 0.000000, 0.454902, 0.113281),
   float4(0.000000, 0.000000, 0.470588, 0.117188),
   float4(0.000000, 0.000000, 0.486275, 0.121094),
   float4(0.000000, 0.000000, 0.501961, 0.125000),
   float4(0.000000, 0.000000, 0.517647, 0.128906),
   float4(0.000000, 0.000000, 0.533333, 0.132812),
   float4(0.000000, 0.000000, 0.549020, 0.136719),
   float4(0.000000, 0.000000, 0.564706, 0.140625),
   float4(0.000000, 0.000000, 0.580392, 0.144531),
   float4(0.000000, 0.000000, 0.596078, 0.148438),
   float4(0.000000, 0.000000, 0.611765, 0.152344),
   float4(0.000000, 0.000000, 0.627451, 0.156250),
   float4(0.000000, 0.000000, 0.643137, 0.160156),
   float4(0.000000, 0.000000, 0.658824, 0.164062),
   float4(0.000000, 0.000000, 0.674510, 0.167969),
   float4(0.000000, 0.000000, 0.690196, 0.171875),
   float4(0.000000, 0.000000, 0.705882, 0.175781),
   float4(0.000000, 0.000000, 0.721569, 0.179688),
   float4(0.000000, 0.000000, 0.737255, 0.183594),
   float4(0.000000, 0.000000, 0.752941, 0.187500),
   float4(0.000000, 0.000000, 0.768627, 0.191406),
   float4(0.000000, 0.000000, 0.784314, 0.195312),
   float4(0.000000, 0.000000, 0.800000, 0.199219),
   float4(0.000000, 0.000000, 0.815686, 0.203125),
   float4(0.000000, 0.000000, 0.831373, 0.207031),
   float4(0.000000, 0.000000, 0.847059, 0.210938),
   float4(0.000000, 0.000000, 0.862745, 0.214844),
   float4(0.000000, 0.000000, 0.878431, 0.218750),
   float4(0.000000, 0.000000, 0.894118, 0.222656),
   float4(0.000000, 0.000000, 0.909804, 0.226562),
   float4(0.000000, 0.000000, 0.925490, 0.230469),
   float4(0.000000, 0.000000, 0.941176, 0.234375),
   float4(0.000000, 0.000000, 0.956863, 0.238281),
   float4(0.000000, 0.000000, 0.972549, 0.242188),
   float4(0.000000, 0.000000, 0.988235, 0.246094),
   float4(0.003064, 0.000000, 1.000000, 0.250000),
   float4(0.015319, 0.000000, 1.000000, 0.253906),
   float4(0.027574, 0.000000, 1.000000, 0.257812),
   float4(0.039828, 0.000000, 1.000000, 0.261719),
   float4(0.052083, 0.000000, 1.000000, 0.265625),
   float4(0.064338, 0.000000, 1.000000, 0.269531),
   float4(0.076593, 0.000000, 1.000000, 0.273438),
   float4(0.088848, 0.000000, 1.000000, 0.277344),
   float4(0.101103, 0.000000, 1.000000, 0.281250),
   float4(0.113358, 0.000000, 1.000000, 0.285156),
   float4(0.125613, 0.000000, 1.000000, 0.289062),
   float4(0.137868, 0.000000, 1.000000, 0.292969),
   float4(0.150123, 0.000000, 1.000000, 0.296875),
   float4(0.162377, 0.000000, 1.000000, 0.300781),
   float4(0.174632, 0.000000, 1.000000, 0.304688),
   float4(0.186887, 0.000000, 1.000000, 0.308594),
   float4(0.199142, 0.000000, 1.000000, 0.312500),
   float4(0.211397, 0.000000, 1.000000, 0.316406),
   float4(0.223652, 0.000000, 1.000000, 0.320312),
   float4(0.235907, 0.000000, 1.000000, 0.324219),
   float4(0.248162, 0.000000, 1.000000, 0.328125),
   float4(0.260417, 0.000000, 1.000000, 0.332031),
   float4(0.272672, 0.000000, 1.000000, 0.335938),
   float4(0.284926, 0.000000, 1.000000, 0.339844),
   float4(0.297181, 0.000000, 1.000000, 0.343750),
   float4(0.309436, 0.000000, 1.000000, 0.347656),
   float4(0.321691, 0.000000, 1.000000, 0.351562),
   float4(0.333946, 0.000000, 1.000000, 0.355469),
   float4(0.346201, 0.000000, 1.000000, 0.359375),
   float4(0.358456, 0.000000, 1.000000, 0.363281),
   float4(0.370711, 0.000000, 1.000000, 0.367188),
   float4(0.382966, 0.000000, 1.000000, 0.371094),
   float4(0.395221, 0.000000, 1.000000, 0.375000),
   float4(0.407475, 0.000000, 1.000000, 0.378906),
   float4(0.419730, 0.000000, 1.000000, 0.382812),
   float4(0.431985, 0.000000, 1.000000, 0.386719),
   float4(0.444240, 0.000000, 1.000000, 0.390625),
   float4(0.456495, 0.000000, 1.000000, 0.394531),
   float4(0.468750, 0.000000, 1.000000, 0.398438),
   float4(0.481005, 0.000000, 1.000000, 0.402344),
   float4(0.493260, 0.000000, 1.000000, 0.406250),
   float4(0.505515, 0.000000, 1.000000, 0.410156),
   float4(0.517770, 0.000000, 1.000000, 0.414062),
   float4(0.530025, 0.000000, 1.000000, 0.417969),
   float4(0.542279, 0.007059, 0.992941, 0.421875),
   float4(0.554534, 0.014902, 0.985098, 0.425781),
   float4(0.566789, 0.022745, 0.977255, 0.429688),
   float4(0.579044, 0.030588, 0.969412, 0.433594),
   float4(0.591299, 0.038431, 0.961569, 0.437500),
   float4(0.603554, 0.046275, 0.953725, 0.441406),
   float4(0.615809, 0.054118, 0.945882, 0.445312),
   float4(0.628064, 0.061961, 0.938039, 0.449219),
   float4(0.640319, 0.069804, 0.930196, 0.453125),
   float4(0.652574, 0.077647, 0.922353, 0.457031),
   float4(0.664828, 0.085490, 0.914510, 0.460938),
   float4(0.677083, 0.093333, 0.906667, 0.464844),
   float4(0.689338, 0.101176, 0.898824, 0.468750),
   float4(0.701593, 0.109020, 0.890980, 0.472656),
   float4(0.713848, 0.116863, 0.883137, 0.476562),
   float4(0.726103, 0.124706, 0.875294, 0.480469),
   float4(0.738358, 0.132549, 0.867451, 0.484375),
   float4(0.750613, 0.140392, 0.859608, 0.488281),
   float4(0.762868, 0.148235, 0.851765, 0.492188),
   float4(0.775123, 0.156078, 0.843922, 0.496094),
   float4(0.787377, 0.163922, 0.836078, 0.500000),
   float4(0.799632, 0.171765, 0.828235, 0.503906),
   float4(0.811887, 0.179608, 0.820392, 0.507812),
   float4(0.824142, 0.187451, 0.812549, 0.511719),
   float4(0.836397, 0.195294, 0.804706, 0.515625),
   float4(0.848652, 0.203137, 0.796863, 0.519531),
   float4(0.860907, 0.210980, 0.789020, 0.523438),
   float4(0.873162, 0.218824, 0.781176, 0.527344),
   float4(0.885417, 0.226667, 0.773333, 0.531250),
   float4(0.897672, 0.234510, 0.765490, 0.535156),
   float4(0.909926, 0.242353, 0.757647, 0.539062),
   float4(0.922181, 0.250196, 0.749804, 0.542969),
   float4(0.934436, 0.258039, 0.741961, 0.546875),
   float4(0.946691, 0.265882, 0.734118, 0.550781),
   float4(0.958946, 0.273725, 0.726275, 0.554688),
   float4(0.971201, 0.281569, 0.718431, 0.558594),
   float4(0.983456, 0.289412, 0.710588, 0.562500),
   float4(0.995711, 0.297255, 0.702745, 0.566406),
   float4(1.000000, 0.305098, 0.694902, 0.570312),
   float4(1.000000, 0.312941, 0.687059, 0.574219),
   float4(1.000000, 0.320784, 0.679216, 0.578125),
   float4(1.000000, 0.328627, 0.671373, 0.582031),
   float4(1.000000, 0.336471, 0.663529, 0.585938),
   float4(1.000000, 0.344314, 0.655686, 0.589844),
   float4(1.000000, 0.352157, 0.647843, 0.593750),
   float4(1.000000, 0.360000, 0.640000, 0.597656),
   float4(1.000000, 0.367843, 0.632157, 0.601562),
   float4(1.000000, 0.375686, 0.624314, 0.605469),
   float4(1.000000, 0.383529, 0.616471, 0.609375),
   float4(1.000000, 0.391373, 0.608627, 0.613281),
   float4(1.000000, 0.399216, 0.600784, 0.617188),
   float4(1.000000, 0.407059, 0.592941, 0.621094),
   float4(1.000000, 0.414902, 0.585098, 0.625000),
   float4(1.000000, 0.422745, 0.577255, 0.628906),
   float4(1.000000, 0.430588, 0.569412, 0.632812),
   float4(1.000000, 0.438431, 0.561569, 0.636719),
   float4(1.000000, 0.446275, 0.553725, 0.640625),
   float4(1.000000, 0.454118, 0.545882, 0.644531),
   float4(1.000000, 0.461961, 0.538039, 0.648438),
   float4(1.000000, 0.469804, 0.530196, 0.652344),
   float4(1.000000, 0.477647, 0.522353, 0.656250),
   float4(1.000000, 0.485490, 0.514510, 0.660156),
   float4(1.000000, 0.493333, 0.506667, 0.664062),
   float4(1.000000, 0.501176, 0.498824, 0.667969),
   float4(1.000000, 0.509020, 0.490980, 0.671875),
   float4(1.000000, 0.516863, 0.483137, 0.675781),
   float4(1.000000, 0.524706, 0.475294, 0.679688),
   float4(1.000000, 0.532549, 0.467451, 0.683594),
   float4(1.000000, 0.540392, 0.459608, 0.687500),
   float4(1.000000, 0.548235, 0.451765, 0.691406),
   float4(1.000000, 0.556078, 0.443922, 0.695312),
   float4(1.000000, 0.563922, 0.436078, 0.699219),
   float4(1.000000, 0.571765, 0.428235, 0.703125),
   float4(1.000000, 0.579608, 0.420392, 0.707031),
   float4(1.000000, 0.587451, 0.412549, 0.710938),
   float4(1.000000, 0.595294, 0.404706, 0.714844),
   float4(1.000000, 0.603137, 0.396863, 0.718750),
   float4(1.000000, 0.610980, 0.389020, 0.722656),
   float4(1.000000, 0.618824, 0.381176, 0.726562),
   float4(1.000000, 0.626667, 0.373333, 0.730469),
   float4(1.000000, 0.634510, 0.365490, 0.734375),
   float4(1.000000, 0.642353, 0.357647, 0.738281),
   float4(1.000000, 0.650196, 0.349804, 0.742188),
   float4(1.000000, 0.658039, 0.341961, 0.746094),
   float4(1.000000, 0.665882, 0.334118, 0.750000),
   float4(1.000000, 0.673725, 0.326275, 0.753906),
   float4(1.000000, 0.681569, 0.318431, 0.757812),
   float4(1.000000, 0.689412, 0.310588, 0.761719),
   float4(1.000000, 0.697255, 0.302745, 0.765625),
   float4(1.000000, 0.705098, 0.294902, 0.769531),
   float4(1.000000, 0.712941, 0.287059, 0.773438),
   float4(1.000000, 0.720784, 0.279216, 0.777344),
   float4(1.000000, 0.728627, 0.271373, 0.781250),
   float4(1.000000, 0.736471, 0.263529, 0.785156),
   float4(1.000000, 0.744314, 0.255686, 0.789062),
   float4(1.000000, 0.752157, 0.247843, 0.792969),
   float4(1.000000, 0.760000, 0.240000, 0.796875),
   float4(1.000000, 0.767843, 0.232157, 0.800781),
   float4(1.000000, 0.775686, 0.224314, 0.804688),
   float4(1.000000, 0.783529, 0.216471, 0.808594),
   float4(1.000000, 0.791373, 0.208627, 0.812500),
   float4(1.000000, 0.799216, 0.200784, 0.816406),
   float4(1.000000, 0.807059, 0.192941, 0.820312),
   float4(1.000000, 0.814902, 0.185098, 0.824219),
   float4(1.000000, 0.822745, 0.177255, 0.828125),
   float4(1.000000, 0.830588, 0.169412, 0.832031),
   float4(1.000000, 0.838431, 0.161569, 0.835938),
   float4(1.000000, 0.846275, 0.153725, 0.839844),
   float4(1.000000, 0.854118, 0.145882, 0.843750),
   float4(1.000000, 0.861961, 0.138039, 0.847656),
   float4(1.000000, 0.869804, 0.130196, 0.851562),
   float4(1.000000, 0.877647, 0.122353, 0.855469),
   float4(1.000000, 0.885490, 0.114510, 0.859375),
   float4(1.000000, 0.893333, 0.106667, 0.863281),
   float4(1.000000, 0.901176, 0.098824, 0.867188),
   float4(1.000000, 0.909020, 0.090980, 0.871094),
   float4(1.000000, 0.916863, 0.083137, 0.875000),
   float4(1.000000, 0.924706, 0.075294, 0.878906),
   float4(1.000000, 0.932549, 0.067451, 0.882812),
   float4(1.000000, 0.940392, 0.059608, 0.886719),
   float4(1.000000, 0.948235, 0.051765, 0.890625),
   float4(1.000000, 0.956078, 0.043922, 0.894531),
   float4(1.000000, 0.963922, 0.036078, 0.898438),
   float4(1.000000, 0.971765, 0.028235, 0.902344),
   float4(1.000000, 0.979608, 0.020392, 0.906250),
   float4(1.000000, 0.987451, 0.012549, 0.910156),
   float4(1.000000, 0.995294, 0.004706, 0.914062),
   float4(1.000000, 1.000000, 0.019608, 0.917969),
   float4(1.000000, 1.000000, 0.068627, 0.921875),
   float4(1.000000, 1.000000, 0.117647, 0.925781),
   float4(1.000000, 1.000000, 0.166667, 0.929688),
   float4(1.000000, 1.000000, 0.215686, 0.933594),
   float4(1.000000, 1.000000, 0.264706, 0.937500),
   float4(1.000000, 1.000000, 0.313725, 0.941406),
   float4(1.000000, 1.000000, 0.362745, 0.945312),
   float4(1.000000, 1.000000, 0.411765, 0.949219),
   float4(1.000000, 1.000000, 0.460784, 0.953125),
   float4(1.000000, 1.000000, 0.509804, 0.957031),
   float4(1.000000, 1.000000, 0.558824, 0.960938),
   float4(1.000000, 1.000000, 0.607843, 0.964844),
   float4(1.000000, 1.000000, 0.656863, 0.968750),
   float4(1.000000, 1.000000, 0.705882, 0.972656),
   float4(1.000000, 1.000000, 0.754902, 0.976562),
   float4(1.000000, 1.000000, 0.803922, 0.980469),
   float4(1.000000, 1.000000, 0.852941, 0.984375),
   float4(1.000000, 1.000000, 0.901961, 0.988281),
   float4(1.000000, 1.000000, 0.950980, 0.992188),
   float4(1.000000, 1.000000, 1.000000, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::SpectralTransferFunction
{
  float4(0.619608, 0.003922, 0.258824, 0.000000),
  float4(0.628066, 0.013303, 0.260823, 0.003906),
  float4(0.636524, 0.022684, 0.262822, 0.007812),
  float4(0.644983, 0.032065, 0.264821, 0.011719),
  float4(0.653441, 0.041446, 0.266820, 0.015625),
  float4(0.661899, 0.050827, 0.268820, 0.019531),
  float4(0.670358, 0.060208, 0.270819, 0.023438),
  float4(0.678816, 0.069589, 0.272818, 0.027344),
  float4(0.687274, 0.078970, 0.274817, 0.031250),
  float4(0.695732, 0.088351, 0.276817, 0.035156),
  float4(0.704191, 0.097732, 0.278816, 0.039062),
  float4(0.712649, 0.107113, 0.280815, 0.042969),
  float4(0.721107, 0.116494, 0.282814, 0.046875),
  float4(0.729566, 0.125875, 0.284814, 0.050781),
  float4(0.738024, 0.135256, 0.286813, 0.054688),
  float4(0.746482, 0.144637, 0.288812, 0.058594),
  float4(0.754940, 0.154018, 0.290811, 0.062500),
  float4(0.763399, 0.163399, 0.292810, 0.066406),
  float4(0.771857, 0.172780, 0.294810, 0.070312),
  float4(0.780315, 0.182161, 0.296809, 0.074219),
  float4(0.788774, 0.191542, 0.298808, 0.078125),
  float4(0.797232, 0.200923, 0.300807, 0.082031),
  float4(0.805690, 0.210304, 0.302807, 0.085938),
  float4(0.814148, 0.219685, 0.304806, 0.089844),
  float4(0.822607, 0.229066, 0.306805, 0.093750),
  float4(0.831065, 0.238447, 0.308804, 0.097656),
  float4(0.837678, 0.246751, 0.308881, 0.101562),
  float4(0.842445, 0.253979, 0.307036, 0.105469),
  float4(0.847213, 0.261207, 0.305190, 0.109375),
  float4(0.851980, 0.268435, 0.303345, 0.113281),
  float4(0.856747, 0.275663, 0.301499, 0.117188),
  float4(0.861515, 0.282891, 0.299654, 0.121094),
  float4(0.866282, 0.290119, 0.297809, 0.125000),
  float4(0.871050, 0.297347, 0.295963, 0.128906),
  float4(0.875817, 0.304575, 0.294118, 0.132812),
  float4(0.880584, 0.311803, 0.292272, 0.136719),
  float4(0.885352, 0.319031, 0.290427, 0.140625),
  float4(0.890119, 0.326259, 0.288581, 0.144531),
  float4(0.894887, 0.333487, 0.286736, 0.148438),
  float4(0.899654, 0.340715, 0.284890, 0.152344),
  float4(0.904421, 0.347943, 0.283045, 0.156250),
  float4(0.909189, 0.355171, 0.281200, 0.160156),
  float4(0.913956, 0.362399, 0.279354, 0.164062),
  float4(0.918724, 0.369627, 0.277509, 0.167969),
  float4(0.923491, 0.376855, 0.275663, 0.171875),
  float4(0.928258, 0.384083, 0.273818, 0.175781),
  float4(0.933026, 0.391311, 0.271972, 0.179688),
  float4(0.937793, 0.398539, 0.270127, 0.183594),
  float4(0.942561, 0.405767, 0.268281, 0.187500),
  float4(0.947328, 0.412995, 0.266436, 0.191406),
  float4(0.952095, 0.420223, 0.264591, 0.195312),
  float4(0.956863, 0.427451, 0.262745, 0.199219),
  float4(0.958247, 0.437447, 0.267359, 0.203125),
  float4(0.959631, 0.447443, 0.271972, 0.207031),
  float4(0.961015, 0.457439, 0.276586, 0.210938),
  float4(0.962399, 0.467436, 0.281200, 0.214844),
  float4(0.963783, 0.477432, 0.285813, 0.218750),
  float4(0.965167, 0.487428, 0.290427, 0.222656),
  float4(0.966551, 0.497424, 0.295040, 0.226562),
  float4(0.967935, 0.507420, 0.299654, 0.230469),
  float4(0.969319, 0.517416, 0.304268, 0.234375),
  float4(0.970704, 0.527413, 0.308881, 0.238281),
  float4(0.972088, 0.537409, 0.313495, 0.242188),
  float4(0.973472, 0.547405, 0.318108, 0.246094),
  float4(0.974856, 0.557401, 0.322722, 0.250000),
  float4(0.976240, 0.567397, 0.327336, 0.253906),
  float4(0.977624, 0.577393, 0.331949, 0.257812),
  float4(0.979008, 0.587389, 0.336563, 0.261719),
  float4(0.980392, 0.597386, 0.341176, 0.265625),
  float4(0.981776, 0.607382, 0.345790, 0.269531),
  float4(0.983160, 0.617378, 0.350404, 0.273438),
  float4(0.984544, 0.627374, 0.355017, 0.277344),
  float4(0.985928, 0.637370, 0.359631, 0.281250),
  float4(0.987313, 0.647366, 0.364245, 0.285156),
  float4(0.988697, 0.657363, 0.368858, 0.289062),
  float4(0.990081, 0.667359, 0.373472, 0.292969),
  float4(0.991465, 0.677355, 0.378085, 0.296875),
  float4(0.992234, 0.686198, 0.383622, 0.300781),
  float4(0.992388, 0.693887, 0.390081, 0.304688),
  float4(0.992541, 0.701576, 0.396540, 0.308594),
  float4(0.992695, 0.709266, 0.402999, 0.312500),
  float4(0.992849, 0.716955, 0.409458, 0.316406),
  float4(0.993003, 0.724644, 0.415917, 0.320312),
  float4(0.993156, 0.732334, 0.422376, 0.324219),
  float4(0.993310, 0.740023, 0.428835, 0.328125),
  float4(0.993464, 0.747712, 0.435294, 0.332031),
  float4(0.993618, 0.755402, 0.441753, 0.335938),
  float4(0.993772, 0.763091, 0.448212, 0.339844),
  float4(0.993925, 0.770780, 0.454671, 0.343750),
  float4(0.994079, 0.778470, 0.461130, 0.347656),
  float4(0.994233, 0.786159, 0.467589, 0.351562),
  float4(0.994387, 0.793849, 0.474048, 0.355469),
  float4(0.994541, 0.801538, 0.480507, 0.359375),
  float4(0.994694, 0.809227, 0.486967, 0.363281),
  float4(0.994848, 0.816917, 0.493426, 0.367188),
  float4(0.995002, 0.824606, 0.499885, 0.371094),
  float4(0.995156, 0.832295, 0.506344, 0.375000),
  float4(0.995309, 0.839985, 0.512803, 0.378906),
  float4(0.995463, 0.847674, 0.519262, 0.382812),
  float4(0.995617, 0.855363, 0.525721, 0.386719),
  float4(0.995771, 0.863053, 0.532180, 0.390625),
  float4(0.995925, 0.870742, 0.538639, 0.394531),
  float4(0.996078, 0.878431, 0.545098, 0.398438),
  float4(0.996232, 0.883199, 0.553095, 0.402344),
  float4(0.996386, 0.887966, 0.561092, 0.406250),
  float4(0.996540, 0.892734, 0.569089, 0.410156),
  float4(0.996694, 0.897501, 0.577086, 0.414062),
  float4(0.996847, 0.902268, 0.585083, 0.417969),
  float4(0.997001, 0.907036, 0.593080, 0.421875),
  float4(0.997155, 0.911803, 0.601077, 0.425781),
  float4(0.997309, 0.916571, 0.609073, 0.429688),
  float4(0.997463, 0.921338, 0.617070, 0.433594),
  float4(0.997616, 0.926105, 0.625067, 0.437500),
  float4(0.997770, 0.930873, 0.633064, 0.441406),
  float4(0.997924, 0.935640, 0.641061, 0.445312),
  float4(0.998078, 0.940408, 0.649058, 0.449219),
  float4(0.998231, 0.945175, 0.657055, 0.453125),
  float4(0.998385, 0.949942, 0.665052, 0.457031),
  float4(0.998539, 0.954710, 0.673049, 0.460938),
  float4(0.998693, 0.959477, 0.681046, 0.464844),
  float4(0.998847, 0.964245, 0.689043, 0.468750),
  float4(0.999000, 0.969012, 0.697040, 0.472656),
  float4(0.999154, 0.973779, 0.705037, 0.476562),
  float4(0.999308, 0.978547, 0.713033, 0.480469),
  float4(0.999462, 0.983314, 0.721030, 0.484375),
  float4(0.999616, 0.988082, 0.729027, 0.488281),
  float4(0.999769, 0.992849, 0.737024, 0.492188),
  float4(0.999923, 0.997616, 0.745021, 0.496094),
  float4(0.998078, 0.999231, 0.746021, 0.500000),
  float4(0.994233, 0.997693, 0.740023, 0.503906),
  float4(0.990388, 0.996155, 0.734025, 0.507812),
  float4(0.986544, 0.994617, 0.728028, 0.511719),
  float4(0.982699, 0.993080, 0.722030, 0.515625),
  float4(0.978854, 0.991542, 0.716032, 0.519531),
  float4(0.975010, 0.990004, 0.710035, 0.523438),
  float4(0.971165, 0.988466, 0.704037, 0.527344),
  float4(0.967320, 0.986928, 0.698039, 0.531250),
  float4(0.963476, 0.985390, 0.692042, 0.535156),
  float4(0.959631, 0.983852, 0.686044, 0.539062),
  float4(0.955786, 0.982314, 0.680046, 0.542969),
  float4(0.951942, 0.980777, 0.674048, 0.546875),
  float4(0.948097, 0.979239, 0.668051, 0.550781),
  float4(0.944252, 0.977701, 0.662053, 0.554688),
  float4(0.940408, 0.976163, 0.656055, 0.558594),
  float4(0.936563, 0.974625, 0.650058, 0.562500),
  float4(0.932718, 0.973087, 0.644060, 0.566406),
  float4(0.928874, 0.971549, 0.638062, 0.570312),
  float4(0.925029, 0.970012, 0.632065, 0.574219),
  float4(0.921184, 0.968474, 0.626067, 0.578125),
  float4(0.917339, 0.966936, 0.620069, 0.582031),
  float4(0.913495, 0.965398, 0.614072, 0.585938),
  float4(0.909650, 0.963860, 0.608074, 0.589844),
  float4(0.905805, 0.962322, 0.602076, 0.593750),
  float4(0.901961, 0.960784, 0.596078, 0.597656),
  float4(0.892887, 0.957093, 0.597924, 0.601562),
  float4(0.883814, 0.953403, 0.599769, 0.605469),
  float4(0.874740, 0.949712, 0.601615, 0.609375),
  float4(0.865667, 0.946021, 0.603460, 0.613281),
  float4(0.856594, 0.942330, 0.605306, 0.617188),
  float4(0.847520, 0.938639, 0.607151, 0.621094),
  float4(0.838447, 0.934948, 0.608997, 0.625000),
  float4(0.829373, 0.931257, 0.610842, 0.628906),
  float4(0.820300, 0.927566, 0.612687, 0.632812),
  float4(0.811226, 0.923875, 0.614533, 0.636719),
  float4(0.802153, 0.920185, 0.616378, 0.640625),
  float4(0.793080, 0.916494, 0.618224, 0.644531),
  float4(0.784006, 0.912803, 0.620069, 0.648438),
  float4(0.774933, 0.909112, 0.621915, 0.652344),
  float4(0.765859, 0.905421, 0.623760, 0.656250),
  float4(0.756786, 0.901730, 0.625606, 0.660156),
  float4(0.747712, 0.898039, 0.627451, 0.664062),
  float4(0.738639, 0.894348, 0.629296, 0.667969),
  float4(0.729566, 0.890657, 0.631142, 0.671875),
  float4(0.720492, 0.886967, 0.632987, 0.675781),
  float4(0.711419, 0.883276, 0.634833, 0.679688),
  float4(0.702345, 0.879585, 0.636678, 0.683594),
  float4(0.693272, 0.875894, 0.638524, 0.687500),
  float4(0.684198, 0.872203, 0.640369, 0.691406),
  float4(0.675125, 0.868512, 0.642215, 0.695312),
  float4(0.665283, 0.864591, 0.643214, 0.699219),
  float4(0.654671, 0.860438, 0.643368, 0.703125),
  float4(0.644060, 0.856286, 0.643522, 0.707031),
  float4(0.633449, 0.852134, 0.643676, 0.710938),
  float4(0.622837, 0.847982, 0.643829, 0.714844),
  float4(0.612226, 0.843829, 0.643983, 0.718750),
  float4(0.601615, 0.839677, 0.644137, 0.722656),
  float4(0.591003, 0.835525, 0.644291, 0.726562),
  float4(0.580392, 0.831373, 0.644444, 0.730469),
  float4(0.569781, 0.827220, 0.644598, 0.734375),
  float4(0.559170, 0.823068, 0.644752, 0.738281),
  float4(0.548558, 0.818916, 0.644906, 0.742188),
  float4(0.537947, 0.814764, 0.645060, 0.746094),
  float4(0.527336, 0.810611, 0.645213, 0.750000),
  float4(0.516724, 0.806459, 0.645367, 0.753906),
  float4(0.506113, 0.802307, 0.645521, 0.757812),
  float4(0.495502, 0.798155, 0.645675, 0.761719),
  float4(0.484890, 0.794002, 0.645829, 0.765625),
  float4(0.474279, 0.789850, 0.645982, 0.769531),
  float4(0.463668, 0.785698, 0.646136, 0.773438),
  float4(0.453057, 0.781546, 0.646290, 0.777344),
  float4(0.442445, 0.777393, 0.646444, 0.781250),
  float4(0.431834, 0.773241, 0.646597, 0.785156),
  float4(0.421223, 0.769089, 0.646751, 0.789062),
  float4(0.410611, 0.764937, 0.646905, 0.792969),
  float4(0.400000, 0.760784, 0.647059, 0.796875),
  float4(0.392003, 0.751865, 0.650750, 0.800781),
  float4(0.384006, 0.742945, 0.654441, 0.804688),
  float4(0.376009, 0.734025, 0.658131, 0.808594),
  float4(0.368012, 0.725106, 0.661822, 0.812500),
  float4(0.360015, 0.716186, 0.665513, 0.816406),
  float4(0.352018, 0.707266, 0.669204, 0.820312),
  float4(0.344022, 0.698347, 0.672895, 0.824219),
  float4(0.336025, 0.689427, 0.676586, 0.828125),
  float4(0.328028, 0.680508, 0.680277, 0.832031),
  float4(0.320031, 0.671588, 0.683968, 0.835938),
  float4(0.312034, 0.662668, 0.687659, 0.839844),
  float4(0.304037, 0.653749, 0.691349, 0.843750),
  float4(0.296040, 0.644829, 0.695040, 0.847656),
  float4(0.288043, 0.635909, 0.698731, 0.851562),
  float4(0.280046, 0.626990, 0.702422, 0.855469),
  float4(0.272049, 0.618070, 0.706113, 0.859375),
  float4(0.264052, 0.609150, 0.709804, 0.863281),
  float4(0.256055, 0.600231, 0.713495, 0.867188),
  float4(0.248058, 0.591311, 0.717186, 0.871094),
  float4(0.240062, 0.582391, 0.720877, 0.875000),
  float4(0.232065, 0.573472, 0.724567, 0.878906),
  float4(0.224068, 0.564552, 0.728258, 0.882812),
  float4(0.216071, 0.555632, 0.731949, 0.886719),
  float4(0.208074, 0.546713, 0.735640, 0.890625),
  float4(0.200077, 0.537793, 0.739331, 0.894531),
  float4(0.199462, 0.528950, 0.739100, 0.898438),
  float4(0.206228, 0.520185, 0.734948, 0.902344),
  float4(0.212995, 0.511419, 0.730796, 0.906250),
  float4(0.219762, 0.502653, 0.726644, 0.910156),
  float4(0.226528, 0.493887, 0.722491, 0.914062),
  float4(0.233295, 0.485121, 0.718339, 0.917969),
  float4(0.240062, 0.476355, 0.714187, 0.921875),
  float4(0.246828, 0.467589, 0.710035, 0.925781),
  float4(0.253595, 0.458824, 0.705882, 0.929688),
  float4(0.260361, 0.450058, 0.701730, 0.933594),
  float4(0.267128, 0.441292, 0.697578, 0.937500),
  float4(0.273895, 0.432526, 0.693426, 0.941406),
  float4(0.280661, 0.423760, 0.689273, 0.945312),
  float4(0.287428, 0.414994, 0.685121, 0.949219),
  float4(0.294195, 0.406228, 0.680969, 0.953125),
  float4(0.300961, 0.397463, 0.676817, 0.957031),
  float4(0.307728, 0.388697, 0.672664, 0.960938),
  float4(0.314494, 0.379931, 0.668512, 0.964844),
  float4(0.321261, 0.371165, 0.664360, 0.968750),
  float4(0.328028, 0.362399, 0.660208, 0.972656),
  float4(0.334794, 0.353633, 0.656055, 0.976562),
  float4(0.341561, 0.344867, 0.651903, 0.980469),
  float4(0.348328, 0.336101, 0.647751, 0.984375),
  float4(0.355094, 0.327336, 0.643599, 0.988281),
  float4(0.361861, 0.318570, 0.639446, 0.992188),
  float4(0.368627, 0.309804, 0.635294, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::CoolTransferFunction
{
  float4(0.000000, 1.000000, 1.000000, 0.000000),
   float4(0.003922, 0.996078, 1.000000, 0.003906),
   float4(0.007843, 0.992157, 1.000000, 0.007812),
   float4(0.011765, 0.988235, 1.000000, 0.011719),
   float4(0.015686, 0.984314, 1.000000, 0.015625),
   float4(0.019608, 0.980392, 1.000000, 0.019531),
   float4(0.023529, 0.976471, 1.000000, 0.023438),
   float4(0.027451, 0.972549, 1.000000, 0.027344),
   float4(0.031373, 0.968627, 1.000000, 0.031250),
   float4(0.035294, 0.964706, 1.000000, 0.035156),
   float4(0.039216, 0.960784, 1.000000, 0.039062),
   float4(0.043137, 0.956863, 1.000000, 0.042969),
   float4(0.047059, 0.952941, 1.000000, 0.046875),
   float4(0.050980, 0.949020, 1.000000, 0.050781),
   float4(0.054902, 0.945098, 1.000000, 0.054688),
   float4(0.058824, 0.941176, 1.000000, 0.058594),
   float4(0.062745, 0.937255, 1.000000, 0.062500),
   float4(0.066667, 0.933333, 1.000000, 0.066406),
   float4(0.070588, 0.929412, 1.000000, 0.070312),
   float4(0.074510, 0.925490, 1.000000, 0.074219),
   float4(0.078431, 0.921569, 1.000000, 0.078125),
   float4(0.082353, 0.917647, 1.000000, 0.082031),
   float4(0.086275, 0.913725, 1.000000, 0.085938),
   float4(0.090196, 0.909804, 1.000000, 0.089844),
   float4(0.094118, 0.905882, 1.000000, 0.093750),
   float4(0.098039, 0.901961, 1.000000, 0.097656),
   float4(0.101961, 0.898039, 1.000000, 0.101562),
   float4(0.105882, 0.894118, 1.000000, 0.105469),
   float4(0.109804, 0.890196, 1.000000, 0.109375),
   float4(0.113725, 0.886275, 1.000000, 0.113281),
   float4(0.117647, 0.882353, 1.000000, 0.117188),
   float4(0.121569, 0.878431, 1.000000, 0.121094),
   float4(0.125490, 0.874510, 1.000000, 0.125000),
   float4(0.129412, 0.870588, 1.000000, 0.128906),
   float4(0.133333, 0.866667, 1.000000, 0.132812),
   float4(0.137255, 0.862745, 1.000000, 0.136719),
   float4(0.141176, 0.858824, 1.000000, 0.140625),
   float4(0.145098, 0.854902, 1.000000, 0.144531),
   float4(0.149020, 0.850980, 1.000000, 0.148438),
   float4(0.152941, 0.847059, 1.000000, 0.152344),
   float4(0.156863, 0.843137, 1.000000, 0.156250),
   float4(0.160784, 0.839216, 1.000000, 0.160156),
   float4(0.164706, 0.835294, 1.000000, 0.164062),
   float4(0.168627, 0.831373, 1.000000, 0.167969),
   float4(0.172549, 0.827451, 1.000000, 0.171875),
   float4(0.176471, 0.823529, 1.000000, 0.175781),
   float4(0.180392, 0.819608, 1.000000, 0.179688),
   float4(0.184314, 0.815686, 1.000000, 0.183594),
   float4(0.188235, 0.811765, 1.000000, 0.187500),
   float4(0.192157, 0.807843, 1.000000, 0.191406),
   float4(0.196078, 0.803922, 1.000000, 0.195312),
   float4(0.200000, 0.800000, 1.000000, 0.199219),
   float4(0.203922, 0.796078, 1.000000, 0.203125),
   float4(0.207843, 0.792157, 1.000000, 0.207031),
   float4(0.211765, 0.788235, 1.000000, 0.210938),
   float4(0.215686, 0.784314, 1.000000, 0.214844),
   float4(0.219608, 0.780392, 1.000000, 0.218750),
   float4(0.223529, 0.776471, 1.000000, 0.222656),
   float4(0.227451, 0.772549, 1.000000, 0.226562),
   float4(0.231373, 0.768627, 1.000000, 0.230469),
   float4(0.235294, 0.764706, 1.000000, 0.234375),
   float4(0.239216, 0.760784, 1.000000, 0.238281),
   float4(0.243137, 0.756863, 1.000000, 0.242188),
   float4(0.247059, 0.752941, 1.000000, 0.246094),
   float4(0.250980, 0.749020, 1.000000, 0.250000),
   float4(0.254902, 0.745098, 1.000000, 0.253906),
   float4(0.258824, 0.741176, 1.000000, 0.257812),
   float4(0.262745, 0.737255, 1.000000, 0.261719),
   float4(0.266667, 0.733333, 1.000000, 0.265625),
   float4(0.270588, 0.729412, 1.000000, 0.269531),
   float4(0.274510, 0.725490, 1.000000, 0.273438),
   float4(0.278431, 0.721569, 1.000000, 0.277344),
   float4(0.282353, 0.717647, 1.000000, 0.281250),
   float4(0.286275, 0.713725, 1.000000, 0.285156),
   float4(0.290196, 0.709804, 1.000000, 0.289062),
   float4(0.294118, 0.705882, 1.000000, 0.292969),
   float4(0.298039, 0.701961, 1.000000, 0.296875),
   float4(0.301961, 0.698039, 1.000000, 0.300781),
   float4(0.305882, 0.694118, 1.000000, 0.304688),
   float4(0.309804, 0.690196, 1.000000, 0.308594),
   float4(0.313725, 0.686275, 1.000000, 0.312500),
   float4(0.317647, 0.682353, 1.000000, 0.316406),
   float4(0.321569, 0.678431, 1.000000, 0.320312),
   float4(0.325490, 0.674510, 1.000000, 0.324219),
   float4(0.329412, 0.670588, 1.000000, 0.328125),
   float4(0.333333, 0.666667, 1.000000, 0.332031),
   float4(0.337255, 0.662745, 1.000000, 0.335938),
   float4(0.341176, 0.658824, 1.000000, 0.339844),
   float4(0.345098, 0.654902, 1.000000, 0.343750),
   float4(0.349020, 0.650980, 1.000000, 0.347656),
   float4(0.352941, 0.647059, 1.000000, 0.351562),
   float4(0.356863, 0.643137, 1.000000, 0.355469),
   float4(0.360784, 0.639216, 1.000000, 0.359375),
   float4(0.364706, 0.635294, 1.000000, 0.363281),
   float4(0.368627, 0.631373, 1.000000, 0.367188),
   float4(0.372549, 0.627451, 1.000000, 0.371094),
   float4(0.376471, 0.623529, 1.000000, 0.375000),
   float4(0.380392, 0.619608, 1.000000, 0.378906),
   float4(0.384314, 0.615686, 1.000000, 0.382812),
   float4(0.388235, 0.611765, 1.000000, 0.386719),
   float4(0.392157, 0.607843, 1.000000, 0.390625),
   float4(0.396078, 0.603922, 1.000000, 0.394531),
   float4(0.400000, 0.600000, 1.000000, 0.398438),
   float4(0.403922, 0.596078, 1.000000, 0.402344),
   float4(0.407843, 0.592157, 1.000000, 0.406250),
   float4(0.411765, 0.588235, 1.000000, 0.410156),
   float4(0.415686, 0.584314, 1.000000, 0.414062),
   float4(0.419608, 0.580392, 1.000000, 0.417969),
   float4(0.423529, 0.576471, 1.000000, 0.421875),
   float4(0.427451, 0.572549, 1.000000, 0.425781),
   float4(0.431373, 0.568627, 1.000000, 0.429688),
   float4(0.435294, 0.564706, 1.000000, 0.433594),
   float4(0.439216, 0.560784, 1.000000, 0.437500),
   float4(0.443137, 0.556863, 1.000000, 0.441406),
   float4(0.447059, 0.552941, 1.000000, 0.445312),
   float4(0.450980, 0.549020, 1.000000, 0.449219),
   float4(0.454902, 0.545098, 1.000000, 0.453125),
   float4(0.458824, 0.541176, 1.000000, 0.457031),
   float4(0.462745, 0.537255, 1.000000, 0.460938),
   float4(0.466667, 0.533333, 1.000000, 0.464844),
   float4(0.470588, 0.529412, 1.000000, 0.468750),
   float4(0.474510, 0.525490, 1.000000, 0.472656),
   float4(0.478431, 0.521569, 1.000000, 0.476562),
   float4(0.482353, 0.517647, 1.000000, 0.480469),
   float4(0.486275, 0.513725, 1.000000, 0.484375),
   float4(0.490196, 0.509804, 1.000000, 0.488281),
   float4(0.494118, 0.505882, 1.000000, 0.492188),
   float4(0.498039, 0.501961, 1.000000, 0.496094),
   float4(0.501961, 0.498039, 1.000000, 0.500000),
   float4(0.505882, 0.494118, 1.000000, 0.503906),
   float4(0.509804, 0.490196, 1.000000, 0.507812),
   float4(0.513725, 0.486275, 1.000000, 0.511719),
   float4(0.517647, 0.482353, 1.000000, 0.515625),
   float4(0.521569, 0.478431, 1.000000, 0.519531),
   float4(0.525490, 0.474510, 1.000000, 0.523438),
   float4(0.529412, 0.470588, 1.000000, 0.527344),
   float4(0.533333, 0.466667, 1.000000, 0.531250),
   float4(0.537255, 0.462745, 1.000000, 0.535156),
   float4(0.541176, 0.458824, 1.000000, 0.539062),
   float4(0.545098, 0.454902, 1.000000, 0.542969),
   float4(0.549020, 0.450980, 1.000000, 0.546875),
   float4(0.552941, 0.447059, 1.000000, 0.550781),
   float4(0.556863, 0.443137, 1.000000, 0.554688),
   float4(0.560784, 0.439216, 1.000000, 0.558594),
   float4(0.564706, 0.435294, 1.000000, 0.562500),
   float4(0.568627, 0.431373, 1.000000, 0.566406),
   float4(0.572549, 0.427451, 1.000000, 0.570312),
   float4(0.576471, 0.423529, 1.000000, 0.574219),
   float4(0.580392, 0.419608, 1.000000, 0.578125),
   float4(0.584314, 0.415686, 1.000000, 0.582031),
   float4(0.588235, 0.411765, 1.000000, 0.585938),
   float4(0.592157, 0.407843, 1.000000, 0.589844),
   float4(0.596078, 0.403922, 1.000000, 0.593750),
   float4(0.600000, 0.400000, 1.000000, 0.597656),
   float4(0.603922, 0.396078, 1.000000, 0.601562),
   float4(0.607843, 0.392157, 1.000000, 0.605469),
   float4(0.611765, 0.388235, 1.000000, 0.609375),
   float4(0.615686, 0.384314, 1.000000, 0.613281),
   float4(0.619608, 0.380392, 1.000000, 0.617188),
   float4(0.623529, 0.376471, 1.000000, 0.621094),
   float4(0.627451, 0.372549, 1.000000, 0.625000),
   float4(0.631373, 0.368627, 1.000000, 0.628906),
   float4(0.635294, 0.364706, 1.000000, 0.632812),
   float4(0.639216, 0.360784, 1.000000, 0.636719),
   float4(0.643137, 0.356863, 1.000000, 0.640625),
   float4(0.647059, 0.352941, 1.000000, 0.644531),
   float4(0.650980, 0.349020, 1.000000, 0.648438),
   float4(0.654902, 0.345098, 1.000000, 0.652344),
   float4(0.658824, 0.341176, 1.000000, 0.656250),
   float4(0.662745, 0.337255, 1.000000, 0.660156),
   float4(0.666667, 0.333333, 1.000000, 0.664062),
   float4(0.670588, 0.329412, 1.000000, 0.667969),
   float4(0.674510, 0.325490, 1.000000, 0.671875),
   float4(0.678431, 0.321569, 1.000000, 0.675781),
   float4(0.682353, 0.317647, 1.000000, 0.679688),
   float4(0.686275, 0.313725, 1.000000, 0.683594),
   float4(0.690196, 0.309804, 1.000000, 0.687500),
   float4(0.694118, 0.305882, 1.000000, 0.691406),
   float4(0.698039, 0.301961, 1.000000, 0.695312),
   float4(0.701961, 0.298039, 1.000000, 0.699219),
   float4(0.705882, 0.294118, 1.000000, 0.703125),
   float4(0.709804, 0.290196, 1.000000, 0.707031),
   float4(0.713725, 0.286275, 1.000000, 0.710938),
   float4(0.717647, 0.282353, 1.000000, 0.714844),
   float4(0.721569, 0.278431, 1.000000, 0.718750),
   float4(0.725490, 0.274510, 1.000000, 0.722656),
   float4(0.729412, 0.270588, 1.000000, 0.726562),
   float4(0.733333, 0.266667, 1.000000, 0.730469),
   float4(0.737255, 0.262745, 1.000000, 0.734375),
   float4(0.741176, 0.258824, 1.000000, 0.738281),
   float4(0.745098, 0.254902, 1.000000, 0.742188),
   float4(0.749020, 0.250980, 1.000000, 0.746094),
   float4(0.752941, 0.247059, 1.000000, 0.750000),
   float4(0.756863, 0.243137, 1.000000, 0.753906),
   float4(0.760784, 0.239216, 1.000000, 0.757812),
   float4(0.764706, 0.235294, 1.000000, 0.761719),
   float4(0.768627, 0.231373, 1.000000, 0.765625),
   float4(0.772549, 0.227451, 1.000000, 0.769531),
   float4(0.776471, 0.223529, 1.000000, 0.773438),
   float4(0.780392, 0.219608, 1.000000, 0.777344),
   float4(0.784314, 0.215686, 1.000000, 0.781250),
   float4(0.788235, 0.211765, 1.000000, 0.785156),
   float4(0.792157, 0.207843, 1.000000, 0.789062),
   float4(0.796078, 0.203922, 1.000000, 0.792969),
   float4(0.800000, 0.200000, 1.000000, 0.796875),
   float4(0.803922, 0.196078, 1.000000, 0.800781),
   float4(0.807843, 0.192157, 1.000000, 0.804688),
   float4(0.811765, 0.188235, 1.000000, 0.808594),
   float4(0.815686, 0.184314, 1.000000, 0.812500),
   float4(0.819608, 0.180392, 1.000000, 0.816406),
   float4(0.823529, 0.176471, 1.000000, 0.820312),
   float4(0.827451, 0.172549, 1.000000, 0.824219),
   float4(0.831373, 0.168627, 1.000000, 0.828125),
   float4(0.835294, 0.164706, 1.000000, 0.832031),
   float4(0.839216, 0.160784, 1.000000, 0.835938),
   float4(0.843137, 0.156863, 1.000000, 0.839844),
   float4(0.847059, 0.152941, 1.000000, 0.843750),
   float4(0.850980, 0.149020, 1.000000, 0.847656),
   float4(0.854902, 0.145098, 1.000000, 0.851562),
   float4(0.858824, 0.141176, 1.000000, 0.855469),
   float4(0.862745, 0.137255, 1.000000, 0.859375),
   float4(0.866667, 0.133333, 1.000000, 0.863281),
   float4(0.870588, 0.129412, 1.000000, 0.867188),
   float4(0.874510, 0.125490, 1.000000, 0.871094),
   float4(0.878431, 0.121569, 1.000000, 0.875000),
   float4(0.882353, 0.117647, 1.000000, 0.878906),
   float4(0.886275, 0.113725, 1.000000, 0.882812),
   float4(0.890196, 0.109804, 1.000000, 0.886719),
   float4(0.894118, 0.105882, 1.000000, 0.890625),
   float4(0.898039, 0.101961, 1.000000, 0.894531),
   float4(0.901961, 0.098039, 1.000000, 0.898438),
   float4(0.905882, 0.094118, 1.000000, 0.902344),
   float4(0.909804, 0.090196, 1.000000, 0.906250),
   float4(0.913725, 0.086275, 1.000000, 0.910156),
   float4(0.917647, 0.082353, 1.000000, 0.914062),
   float4(0.921569, 0.078431, 1.000000, 0.917969),
   float4(0.925490, 0.074510, 1.000000, 0.921875),
   float4(0.929412, 0.070588, 1.000000, 0.925781),
   float4(0.933333, 0.066667, 1.000000, 0.929688),
   float4(0.937255, 0.062745, 1.000000, 0.933594),
   float4(0.941176, 0.058824, 1.000000, 0.937500),
   float4(0.945098, 0.054902, 1.000000, 0.941406),
   float4(0.949020, 0.050980, 1.000000, 0.945312),
   float4(0.952941, 0.047059, 1.000000, 0.949219),
   float4(0.956863, 0.043137, 1.000000, 0.953125),
   float4(0.960784, 0.039216, 1.000000, 0.957031),
   float4(0.964706, 0.035294, 1.000000, 0.960938),
   float4(0.968627, 0.031373, 1.000000, 0.964844),
   float4(0.972549, 0.027451, 1.000000, 0.968750),
   float4(0.976471, 0.023529, 1.000000, 0.972656),
   float4(0.980392, 0.019608, 1.000000, 0.976562),
   float4(0.984314, 0.015686, 1.000000, 0.980469),
   float4(0.988235, 0.011765, 1.000000, 0.984375),
   float4(0.992157, 0.007843, 1.000000, 0.988281),
   float4(0.996078, 0.003922, 1.000000, 0.992188),
   float4(1.000000, 0.000000, 1.000000, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::ViridisTransferFunction
{
  float4(0.267004, 0.004874, 0.329415, 0.000000),
   float4(0.268510, 0.009605, 0.335427, 0.003906),
   float4(0.269944, 0.014625, 0.341379, 0.007812),
   float4(0.271305, 0.019942, 0.347269, 0.011719),
   float4(0.272594, 0.025563, 0.353093, 0.015625),
   float4(0.273809, 0.031497, 0.358853, 0.019531),
   float4(0.274952, 0.037752, 0.364543, 0.023438),
   float4(0.276022, 0.044167, 0.370164, 0.027344),
   float4(0.277018, 0.050344, 0.375715, 0.031250),
   float4(0.277941, 0.056324, 0.381191, 0.035156),
   float4(0.278791, 0.062145, 0.386592, 0.039062),
   float4(0.279566, 0.067836, 0.391917, 0.042969),
   float4(0.280267, 0.073417, 0.397163, 0.046875),
   float4(0.280894, 0.078907, 0.402329, 0.050781),
   float4(0.281446, 0.084320, 0.407414, 0.054688),
   float4(0.281924, 0.089666, 0.412415, 0.058594),
   float4(0.282327, 0.094955, 0.417331, 0.062500),
   float4(0.282656, 0.100196, 0.422160, 0.066406),
   float4(0.282910, 0.105393, 0.426902, 0.070312),
   float4(0.283091, 0.110553, 0.431554, 0.074219),
   float4(0.283197, 0.115680, 0.436115, 0.078125),
   float4(0.283229, 0.120777, 0.440584, 0.082031),
   float4(0.283187, 0.125848, 0.444960, 0.085938),
   float4(0.283072, 0.130895, 0.449241, 0.089844),
   float4(0.282884, 0.135920, 0.453427, 0.093750),
   float4(0.282623, 0.140926, 0.457517, 0.097656),
   float4(0.282290, 0.145912, 0.461510, 0.101562),
   float4(0.281887, 0.150881, 0.465405, 0.105469),
   float4(0.281412, 0.155834, 0.469201, 0.109375),
   float4(0.280868, 0.160771, 0.472899, 0.113281),
   float4(0.280255, 0.165693, 0.476498, 0.117188),
   float4(0.279574, 0.170599, 0.479997, 0.121094),
   float4(0.278826, 0.175490, 0.483397, 0.125000),
   float4(0.278012, 0.180367, 0.486697, 0.128906),
   float4(0.277134, 0.185228, 0.489898, 0.132812),
   float4(0.276194, 0.190074, 0.493001, 0.136719),
   float4(0.275191, 0.194905, 0.496005, 0.140625),
   float4(0.274128, 0.199721, 0.498911, 0.144531),
   float4(0.273006, 0.204520, 0.501721, 0.148438),
   float4(0.271828, 0.209303, 0.504434, 0.152344),
   float4(0.270595, 0.214069, 0.507052, 0.156250),
   float4(0.269308, 0.218818, 0.509577, 0.160156),
   float4(0.267968, 0.223549, 0.512008, 0.164062),
   float4(0.266580, 0.228262, 0.514349, 0.167969),
   float4(0.265145, 0.232956, 0.516599, 0.171875),
   float4(0.263663, 0.237631, 0.518762, 0.175781),
   float4(0.262138, 0.242286, 0.520837, 0.179688),
   float4(0.260571, 0.246922, 0.522828, 0.183594),
   float4(0.258965, 0.251537, 0.524736, 0.187500),
   float4(0.257322, 0.256130, 0.526563, 0.191406),
   float4(0.255645, 0.260703, 0.528312, 0.195312),
   float4(0.253935, 0.265254, 0.529983, 0.199219),
   float4(0.252194, 0.269783, 0.531579, 0.203125),
   float4(0.250425, 0.274290, 0.533103, 0.207031),
   float4(0.248629, 0.278775, 0.534556, 0.210938),
   float4(0.246811, 0.283237, 0.535941, 0.214844),
   float4(0.244972, 0.287675, 0.537260, 0.218750),
   float4(0.243113, 0.292092, 0.538516, 0.222656),
   float4(0.241237, 0.296485, 0.539709, 0.226562),
   float4(0.239346, 0.300855, 0.540844, 0.230469),
   float4(0.237441, 0.305202, 0.541921, 0.234375),
   float4(0.235526, 0.309527, 0.542944, 0.238281),
   float4(0.233603, 0.313828, 0.543914, 0.242188),
   float4(0.231674, 0.318106, 0.544834, 0.246094),
   float4(0.229739, 0.322361, 0.545706, 0.250000),
   float4(0.227802, 0.326594, 0.546532, 0.253906),
   float4(0.225863, 0.330805, 0.547314, 0.257812),
   float4(0.223925, 0.334994, 0.548053, 0.261719),
   float4(0.221989, 0.339161, 0.548752, 0.265625),
   float4(0.220057, 0.343307, 0.549413, 0.269531),
   float4(0.218130, 0.347432, 0.550038, 0.273438),
   float4(0.216210, 0.351535, 0.550627, 0.277344),
   float4(0.214298, 0.355619, 0.551184, 0.281250),
   float4(0.212395, 0.359683, 0.551710, 0.285156),
   float4(0.210503, 0.363727, 0.552206, 0.289062),
   float4(0.208623, 0.367752, 0.552675, 0.292969),
   float4(0.206756, 0.371758, 0.553117, 0.296875),
   float4(0.204903, 0.375746, 0.553533, 0.300781),
   float4(0.203063, 0.379716, 0.553925, 0.304688),
   float4(0.201239, 0.383670, 0.554294, 0.308594),
   float4(0.199430, 0.387607, 0.554642, 0.312500),
   float4(0.197636, 0.391528, 0.554969, 0.316406),
   float4(0.195860, 0.395433, 0.555276, 0.320312),
   float4(0.194100, 0.399323, 0.555565, 0.324219),
   float4(0.192357, 0.403199, 0.555836, 0.328125),
   float4(0.190631, 0.407061, 0.556089, 0.332031),
   float4(0.188923, 0.410910, 0.556326, 0.335938),
   float4(0.187231, 0.414746, 0.556547, 0.339844),
   float4(0.185556, 0.418570, 0.556753, 0.343750),
   float4(0.183898, 0.422383, 0.556944, 0.347656),
   float4(0.182256, 0.426184, 0.557120, 0.351562),
   float4(0.180629, 0.429975, 0.557282, 0.355469),
   float4(0.179019, 0.433756, 0.557430, 0.359375),
   float4(0.177423, 0.437527, 0.557565, 0.363281),
   float4(0.175841, 0.441290, 0.557685, 0.367188),
   float4(0.174274, 0.445044, 0.557792, 0.371094),
   float4(0.172719, 0.448791, 0.557885, 0.375000),
   float4(0.171176, 0.452530, 0.557965, 0.378906),
   float4(0.169646, 0.456262, 0.558030, 0.382812),
   float4(0.168126, 0.459988, 0.558082, 0.386719),
   float4(0.166617, 0.463708, 0.558119, 0.390625),
   float4(0.165117, 0.467423, 0.558141, 0.394531),
   float4(0.163625, 0.471133, 0.558148, 0.398438),
   float4(0.162142, 0.474838, 0.558140, 0.402344),
   float4(0.160665, 0.478540, 0.558115, 0.406250),
   float4(0.159194, 0.482237, 0.558073, 0.410156),
   float4(0.157729, 0.485932, 0.558013, 0.414062),
   float4(0.156270, 0.489624, 0.557936, 0.417969),
   float4(0.154815, 0.493313, 0.557840, 0.421875),
   float4(0.153364, 0.497000, 0.557724, 0.425781),
   float4(0.151918, 0.500685, 0.557587, 0.429688),
   float4(0.150476, 0.504369, 0.557430, 0.433594),
   float4(0.149039, 0.508051, 0.557250, 0.437500),
   float4(0.147607, 0.511733, 0.557049, 0.441406),
   float4(0.146180, 0.515413, 0.556823, 0.445312),
   float4(0.144759, 0.519093, 0.556572, 0.449219),
   float4(0.143343, 0.522773, 0.556295, 0.453125),
   float4(0.141935, 0.526453, 0.555991, 0.457031),
   float4(0.140536, 0.530132, 0.555659, 0.460938),
   float4(0.139147, 0.533812, 0.555298, 0.464844),
   float4(0.137770, 0.537492, 0.554906, 0.468750),
   float4(0.136408, 0.541173, 0.554483, 0.472656),
   float4(0.135066, 0.544853, 0.554029, 0.476562),
   float4(0.133743, 0.548535, 0.553541, 0.480469),
   float4(0.132444, 0.552216, 0.553018, 0.484375),
   float4(0.131172, 0.555899, 0.552459, 0.488281),
   float4(0.129933, 0.559582, 0.551864, 0.492188),
   float4(0.128729, 0.563265, 0.551229, 0.496094),
   float4(0.127568, 0.566949, 0.550556, 0.500000),
   float4(0.126453, 0.570633, 0.549841, 0.503906),
   float4(0.125394, 0.574318, 0.549086, 0.507812),
   float4(0.124395, 0.578002, 0.548287, 0.511719),
   float4(0.123463, 0.581687, 0.547445, 0.515625),
   float4(0.122606, 0.585371, 0.546557, 0.519531),
   float4(0.121831, 0.589055, 0.545623, 0.523438),
   float4(0.121148, 0.592739, 0.544641, 0.527344),
   float4(0.120565, 0.596422, 0.543611, 0.531250),
   float4(0.120092, 0.600104, 0.542530, 0.535156),
   float4(0.119738, 0.603785, 0.541400, 0.539062),
   float4(0.119512, 0.607464, 0.540218, 0.542969),
   float4(0.119423, 0.611141, 0.538982, 0.546875),
   float4(0.119483, 0.614817, 0.537692, 0.550781),
   float4(0.119699, 0.618490, 0.536347, 0.554688),
   float4(0.120081, 0.622161, 0.534946, 0.558594),
   float4(0.120638, 0.625828, 0.533488, 0.562500),
   float4(0.121380, 0.629492, 0.531973, 0.566406),
   float4(0.122312, 0.633153, 0.530398, 0.570312),
   float4(0.123444, 0.636809, 0.528763, 0.574219),
   float4(0.124780, 0.640461, 0.527068, 0.578125),
   float4(0.126326, 0.644107, 0.525311, 0.582031),
   float4(0.128087, 0.647749, 0.523491, 0.585938),
   float4(0.130067, 0.651384, 0.521608, 0.589844),
   float4(0.132268, 0.655014, 0.519661, 0.593750),
   float4(0.134692, 0.658636, 0.517649, 0.597656),
   float4(0.137339, 0.662252, 0.515571, 0.601562),
   float4(0.140210, 0.665859, 0.513427, 0.605469),
   float4(0.143303, 0.669459, 0.511215, 0.609375),
   float4(0.146616, 0.673050, 0.508936, 0.613281),
   float4(0.150148, 0.676631, 0.506589, 0.617188),
   float4(0.153894, 0.680203, 0.504172, 0.621094),
   float4(0.157851, 0.683765, 0.501686, 0.625000),
   float4(0.162016, 0.687316, 0.499129, 0.628906),
   float4(0.166383, 0.690856, 0.496502, 0.632812),
   float4(0.170948, 0.694384, 0.493803, 0.636719),
   float4(0.175707, 0.697900, 0.491033, 0.640625),
   float4(0.180653, 0.701402, 0.488189, 0.644531),
   float4(0.185783, 0.704891, 0.485273, 0.648438),
   float4(0.191090, 0.708366, 0.482284, 0.652344),
   float4(0.196571, 0.711827, 0.479221, 0.656250),
   float4(0.202219, 0.715272, 0.476084, 0.660156),
   float4(0.208030, 0.718701, 0.472873, 0.664062),
   float4(0.214000, 0.722114, 0.469588, 0.667969),
   float4(0.220124, 0.725509, 0.466226, 0.671875),
   float4(0.226397, 0.728888, 0.462789, 0.675781),
   float4(0.232815, 0.732247, 0.459277, 0.679688),
   float4(0.239374, 0.735588, 0.455688, 0.683594),
   float4(0.246070, 0.738910, 0.452024, 0.687500),
   float4(0.252899, 0.742211, 0.448284, 0.691406),
   float4(0.259857, 0.745492, 0.444467, 0.695312),
   float4(0.266941, 0.748751, 0.440573, 0.699219),
   float4(0.274149, 0.751988, 0.436601, 0.703125),
   float4(0.281477, 0.755203, 0.432552, 0.707031),
   float4(0.288921, 0.758394, 0.428426, 0.710938),
   float4(0.296479, 0.761561, 0.424223, 0.714844),
   float4(0.304148, 0.764704, 0.419943, 0.718750),
   float4(0.311925, 0.767822, 0.415586, 0.722656),
   float4(0.319809, 0.770914, 0.411152, 0.726562),
   float4(0.327796, 0.773980, 0.406640, 0.730469),
   float4(0.335885, 0.777018, 0.402049, 0.734375),
   float4(0.344074, 0.780029, 0.397381, 0.738281),
   float4(0.352360, 0.783011, 0.392636, 0.742188),
   float4(0.360741, 0.785964, 0.387814, 0.746094),
   float4(0.369214, 0.788888, 0.382914, 0.750000),
   float4(0.377779, 0.791781, 0.377939, 0.753906),
   float4(0.386433, 0.794644, 0.372886, 0.757812),
   float4(0.395174, 0.797475, 0.367757, 0.761719),
   float4(0.404001, 0.800275, 0.362552, 0.765625),
   float4(0.412913, 0.803041, 0.357269, 0.769531),
   float4(0.421908, 0.805774, 0.351910, 0.773438),
   float4(0.430983, 0.808473, 0.346476, 0.777344),
   float4(0.440137, 0.811138, 0.340967, 0.781250),
   float4(0.449368, 0.813768, 0.335384, 0.785156),
   float4(0.458674, 0.816363, 0.329727, 0.789062),
   float4(0.468053, 0.818921, 0.323998, 0.792969),
   float4(0.477504, 0.821444, 0.318195, 0.796875),
   float4(0.487026, 0.823929, 0.312321, 0.800781),
   float4(0.496615, 0.826376, 0.306377, 0.804688),
   float4(0.506271, 0.828786, 0.300362, 0.808594),
   float4(0.515992, 0.831158, 0.294279, 0.812500),
   float4(0.525776, 0.833491, 0.288127, 0.816406),
   float4(0.535621, 0.835785, 0.281908, 0.820312),
   float4(0.545524, 0.838039, 0.275626, 0.824219),
   float4(0.555484, 0.840254, 0.269281, 0.828125),
   float4(0.565498, 0.842430, 0.262877, 0.832031),
   float4(0.575563, 0.844566, 0.256415, 0.835938),
   float4(0.585678, 0.846661, 0.249897, 0.839844),
   float4(0.595839, 0.848717, 0.243329, 0.843750),
   float4(0.606045, 0.850733, 0.236712, 0.847656),
   float4(0.616293, 0.852709, 0.230052, 0.851562),
   float4(0.626579, 0.854645, 0.223353, 0.855469),
   float4(0.636902, 0.856542, 0.216620, 0.859375),
   float4(0.647257, 0.858400, 0.209861, 0.863281),
   float4(0.657642, 0.860219, 0.203082, 0.867188),
   float4(0.668054, 0.861999, 0.196293, 0.871094),
   float4(0.678489, 0.863742, 0.189503, 0.875000),
   float4(0.688944, 0.865448, 0.182725, 0.878906),
   float4(0.699415, 0.867117, 0.175971, 0.882812),
   float4(0.709898, 0.868751, 0.169257, 0.886719),
   float4(0.720391, 0.870350, 0.162603, 0.890625),
   float4(0.730889, 0.871916, 0.156029, 0.894531),
   float4(0.741388, 0.873449, 0.149561, 0.898438),
   float4(0.751884, 0.874951, 0.143228, 0.902344),
   float4(0.762373, 0.876424, 0.137064, 0.906250),
   float4(0.772852, 0.877868, 0.131109, 0.910156),
   float4(0.783315, 0.879285, 0.125405, 0.914062),
   float4(0.793760, 0.880678, 0.120005, 0.917969),
   float4(0.804182, 0.882046, 0.114965, 0.921875),
   float4(0.814576, 0.883393, 0.110347, 0.925781),
   float4(0.824940, 0.884720, 0.106217, 0.929688),
   float4(0.835270, 0.886029, 0.102646, 0.933594),
   float4(0.845561, 0.887322, 0.099702, 0.937500),
   float4(0.855810, 0.888601, 0.097452, 0.941406),
   float4(0.866013, 0.889868, 0.095953, 0.945312),
   float4(0.876168, 0.891125, 0.095250, 0.949219),
   float4(0.886271, 0.892374, 0.095374, 0.953125),
   float4(0.896320, 0.893616, 0.096335, 0.957031),
   float4(0.906311, 0.894855, 0.098125, 0.960938),
   float4(0.916242, 0.896091, 0.100717, 0.964844),
   float4(0.926106, 0.897330, 0.104071, 0.968750),
   float4(0.935904, 0.898570, 0.108131, 0.972656),
   float4(0.945636, 0.899815, 0.112838, 0.976562),
   float4(0.955300, 0.901065, 0.118128, 0.980469),
   float4(0.964894, 0.902323, 0.123941, 0.984375),
   float4(0.974417, 0.903590, 0.130215, 0.988281),
   float4(0.983868, 0.904867, 0.136897, 0.992188),
   float4(0.993248, 0.906157, 0.143936, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::PlasmaTransferFunction
{
  float4(0.050383, 0.029803, 0.527975, 0.000000),
  float4(0.063536, 0.028426, 0.533124, 0.003906),
  float4(0.075353, 0.027206, 0.538007, 0.007812),
  float4(0.086222, 0.026125, 0.542658, 0.011719),
  float4(0.096379, 0.025165, 0.547103, 0.015625),
  float4(0.105980, 0.024309, 0.551368, 0.019531),
  float4(0.115124, 0.023556, 0.555468, 0.023438),
  float4(0.123903, 0.022878, 0.559423, 0.027344),
  float4(0.132381, 0.022258, 0.563250, 0.031250),
  float4(0.140603, 0.021687, 0.566959, 0.035156),
  float4(0.148607, 0.021154, 0.570562, 0.039062),
  float4(0.156421, 0.020651, 0.574065, 0.042969),
  float4(0.164070, 0.020171, 0.577478, 0.046875),
  float4(0.171574, 0.019706, 0.580806, 0.050781),
  float4(0.178950, 0.019252, 0.584054, 0.054688),
  float4(0.186213, 0.018803, 0.587228, 0.058594),
  float4(0.193374, 0.018354, 0.590330, 0.062500),
  float4(0.200445, 0.017902, 0.593364, 0.066406),
  float4(0.207435, 0.017442, 0.596333, 0.070312),
  float4(0.214350, 0.016973, 0.599239, 0.074219),
  float4(0.221197, 0.016497, 0.602083, 0.078125),
  float4(0.227983, 0.016007, 0.604867, 0.082031),
  float4(0.234715, 0.015502, 0.607592, 0.085938),
  float4(0.241396, 0.014979, 0.610259, 0.089844),
  float4(0.248032, 0.014439, 0.612868, 0.093750),
  float4(0.254627, 0.013882, 0.615419, 0.097656),
  float4(0.261183, 0.013308, 0.617911, 0.101562),
  float4(0.267703, 0.012716, 0.620346, 0.105469),
  float4(0.274191, 0.012109, 0.622722, 0.109375),
  float4(0.280648, 0.011488, 0.625038, 0.113281),
  float4(0.287076, 0.010855, 0.627295, 0.117188),
  float4(0.293478, 0.010213, 0.629490, 0.121094),
  float4(0.299855, 0.009561, 0.631624, 0.125000),
  float4(0.306210, 0.008902, 0.633694, 0.128906),
  float4(0.312543, 0.008239, 0.635700, 0.132812),
  float4(0.318856, 0.007576, 0.637640, 0.136719),
  float4(0.325150, 0.006915, 0.639512, 0.140625),
  float4(0.331426, 0.006261, 0.641316, 0.144531),
  float4(0.337683, 0.005618, 0.643049, 0.148438),
  float4(0.343925, 0.004991, 0.644710, 0.152344),
  float4(0.350150, 0.004382, 0.646298, 0.156250),
  float4(0.356359, 0.003798, 0.647810, 0.160156),
  float4(0.362553, 0.003243, 0.649245, 0.164062),
  float4(0.368733, 0.002724, 0.650601, 0.167969),
  float4(0.374897, 0.002245, 0.651876, 0.171875),
  float4(0.381047, 0.001814, 0.653068, 0.175781),
  float4(0.387183, 0.001434, 0.654177, 0.179688),
  float4(0.393304, 0.001114, 0.655199, 0.183594),
  float4(0.399411, 0.000859, 0.656133, 0.187500),
  float4(0.405503, 0.000678, 0.656977, 0.191406),
  float4(0.411580, 0.000577, 0.657730, 0.195312),
  float4(0.417642, 0.000564, 0.658390, 0.199219),
  float4(0.423689, 0.000646, 0.658956, 0.203125),
  float4(0.429719, 0.000831, 0.659425, 0.207031),
  float4(0.435734, 0.001127, 0.659797, 0.210938),
  float4(0.441732, 0.001540, 0.660069, 0.214844),
  float4(0.447714, 0.002080, 0.660240, 0.218750),
  float4(0.453677, 0.002755, 0.660310, 0.222656),
  float4(0.459623, 0.003574, 0.660277, 0.226562),
  float4(0.465550, 0.004545, 0.660139, 0.230469),
  float4(0.471457, 0.005678, 0.659897, 0.234375),
  float4(0.477344, 0.006980, 0.659549, 0.238281),
  float4(0.483210, 0.008460, 0.659095, 0.242188),
  float4(0.489055, 0.010127, 0.658534, 0.246094),
  float4(0.494877, 0.011990, 0.657865, 0.250000),
  float4(0.500678, 0.014055, 0.657088, 0.253906),
  float4(0.506454, 0.016333, 0.656202, 0.257812),
  float4(0.512206, 0.018833, 0.655209, 0.261719),
  float4(0.517933, 0.021563, 0.654109, 0.265625),
  float4(0.523633, 0.024532, 0.652901, 0.269531),
  float4(0.529306, 0.027747, 0.651586, 0.273438),
  float4(0.534952, 0.031217, 0.650165, 0.277344),
  float4(0.540570, 0.034950, 0.648640, 0.281250),
  float4(0.546157, 0.038954, 0.647010, 0.285156),
  float4(0.551715, 0.043136, 0.645277, 0.289062),
  float4(0.557243, 0.047331, 0.643443, 0.292969),
  float4(0.562738, 0.051545, 0.641509, 0.296875),
  float4(0.568201, 0.055778, 0.639477, 0.300781),
  float4(0.573632, 0.060028, 0.637349, 0.304688),
  float4(0.579029, 0.064296, 0.635126, 0.308594),
  float4(0.584391, 0.068579, 0.632812, 0.312500),
  float4(0.589719, 0.072878, 0.630408, 0.316406),
  float4(0.595011, 0.077190, 0.627917, 0.320312),
  float4(0.600266, 0.081516, 0.625342, 0.324219),
  float4(0.605485, 0.085854, 0.622686, 0.328125),
  float4(0.610667, 0.090204, 0.619951, 0.332031),
  float4(0.615812, 0.094564, 0.617140, 0.335938),
  float4(0.620919, 0.098934, 0.614257, 0.339844),
  float4(0.625987, 0.103312, 0.611305, 0.343750),
  float4(0.631017, 0.107699, 0.608287, 0.347656),
  float4(0.636008, 0.112092, 0.605205, 0.351562),
  float4(0.640959, 0.116492, 0.602065, 0.355469),
  float4(0.645872, 0.120898, 0.598867, 0.359375),
  float4(0.650746, 0.125309, 0.595617, 0.363281),
  float4(0.655580, 0.129725, 0.592317, 0.367188),
  float4(0.660374, 0.134144, 0.588971, 0.371094),
  float4(0.665129, 0.138566, 0.585582, 0.375000),
  float4(0.669845, 0.142992, 0.582154, 0.378906),
  float4(0.674522, 0.147419, 0.578688, 0.382812),
  float4(0.679160, 0.151848, 0.575189, 0.386719),
  float4(0.683758, 0.156278, 0.571660, 0.390625),
  float4(0.688318, 0.160709, 0.568103, 0.394531),
  float4(0.692840, 0.165141, 0.564522, 0.398438),
  float4(0.697324, 0.169573, 0.560919, 0.402344),
  float4(0.701769, 0.174005, 0.557296, 0.406250),
  float4(0.706178, 0.178437, 0.553657, 0.410156),
  float4(0.710549, 0.182868, 0.550004, 0.414062),
  float4(0.714883, 0.187299, 0.546338, 0.417969),
  float4(0.719181, 0.191729, 0.542663, 0.421875),
  float4(0.723444, 0.196158, 0.538981, 0.425781),
  float4(0.727670, 0.200586, 0.535293, 0.429688),
  float4(0.731862, 0.205013, 0.531601, 0.433594),
  float4(0.736019, 0.209439, 0.527908, 0.437500),
  float4(0.740143, 0.213864, 0.524216, 0.441406),
  float4(0.744232, 0.218288, 0.520524, 0.445312),
  float4(0.748289, 0.222711, 0.516834, 0.449219),
  float4(0.752312, 0.227133, 0.513149, 0.453125),
  float4(0.756304, 0.231555, 0.509468, 0.457031),
  float4(0.760264, 0.235976, 0.505794, 0.460938),
  float4(0.764193, 0.240396, 0.502126, 0.464844),
  float4(0.768090, 0.244817, 0.498465, 0.468750),
  float4(0.771958, 0.249237, 0.494813, 0.472656),
  float4(0.775796, 0.253658, 0.491171, 0.476562),
  float4(0.779604, 0.258078, 0.487539, 0.480469),
  float4(0.783383, 0.262500, 0.483918, 0.484375),
  float4(0.787133, 0.266922, 0.480307, 0.488281),
  float4(0.790855, 0.271345, 0.476706, 0.492188),
  float4(0.794549, 0.275770, 0.473117, 0.496094),
  float4(0.798216, 0.280197, 0.469538, 0.500000),
  float4(0.801855, 0.284626, 0.465971, 0.503906),
  float4(0.805467, 0.289057, 0.462415, 0.507812),
  float4(0.809052, 0.293491, 0.458870, 0.511719),
  float4(0.812612, 0.297928, 0.455338, 0.515625),
  float4(0.816144, 0.302368, 0.451816, 0.519531),
  float4(0.819651, 0.306812, 0.448306, 0.523438),
  float4(0.823132, 0.311261, 0.444806, 0.527344),
  float4(0.826588, 0.315714, 0.441316, 0.531250),
  float4(0.830018, 0.320172, 0.437836, 0.535156),
  float4(0.833422, 0.324635, 0.434366, 0.539062),
  float4(0.836801, 0.329105, 0.430905, 0.542969),
  float4(0.840155, 0.333580, 0.427455, 0.546875),
  float4(0.843484, 0.338062, 0.424013, 0.550781),
  float4(0.846788, 0.342551, 0.420579, 0.554688),
  float4(0.850066, 0.347048, 0.417153, 0.558594),
  float4(0.853319, 0.351553, 0.413734, 0.562500),
  float4(0.856547, 0.356066, 0.410322, 0.566406),
  float4(0.859750, 0.360588, 0.406917, 0.570312),
  float4(0.862927, 0.365119, 0.403519, 0.574219),
  float4(0.866078, 0.369660, 0.400126, 0.578125),
  float4(0.869203, 0.374212, 0.396738, 0.582031),
  float4(0.872303, 0.378774, 0.393355, 0.585938),
  float4(0.875376, 0.383347, 0.389976, 0.589844),
  float4(0.878423, 0.387932, 0.386600, 0.593750),
  float4(0.881443, 0.392529, 0.383229, 0.597656),
  float4(0.884436, 0.397139, 0.379860, 0.601562),
  float4(0.887402, 0.401762, 0.376494, 0.605469),
  float4(0.890340, 0.406398, 0.373130, 0.609375),
  float4(0.893250, 0.411048, 0.369768, 0.613281),
  float4(0.896131, 0.415712, 0.366407, 0.617188),
  float4(0.898984, 0.420392, 0.363047, 0.621094),
  float4(0.901807, 0.425087, 0.359688, 0.625000),
  float4(0.904601, 0.429797, 0.356329, 0.628906),
  float4(0.907365, 0.434524, 0.352970, 0.632812),
  float4(0.910098, 0.439268, 0.349610, 0.636719),
  float4(0.912800, 0.444029, 0.346251, 0.640625),
  float4(0.915471, 0.448807, 0.342890, 0.644531),
  float4(0.918109, 0.453603, 0.339529, 0.648438),
  float4(0.920714, 0.458417, 0.336166, 0.652344),
  float4(0.923287, 0.463251, 0.332801, 0.656250),
  float4(0.925825, 0.468103, 0.329435, 0.660156),
  float4(0.928329, 0.472975, 0.326067, 0.664062),
  float4(0.930798, 0.477867, 0.322697, 0.667969),
  float4(0.933232, 0.482780, 0.319325, 0.671875),
  float4(0.935630, 0.487712, 0.315952, 0.675781),
  float4(0.937990, 0.492667, 0.312575, 0.679688),
  float4(0.940313, 0.497642, 0.309197, 0.683594),
  float4(0.942598, 0.502639, 0.305816, 0.687500),
  float4(0.944844, 0.507658, 0.302433, 0.691406),
  float4(0.947051, 0.512699, 0.299049, 0.695312),
  float4(0.949217, 0.517763, 0.295662, 0.699219),
  float4(0.951344, 0.522850, 0.292275, 0.703125),
  float4(0.953428, 0.527960, 0.288883, 0.707031),
  float4(0.955470, 0.533093, 0.285490, 0.710938),
  float4(0.957469, 0.538250, 0.282096, 0.714844),
  float4(0.959424, 0.543431, 0.278701, 0.718750),
  float4(0.961336, 0.548636, 0.275305, 0.722656),
  float4(0.963203, 0.553865, 0.271909, 0.726562),
  float4(0.965024, 0.559118, 0.268513, 0.730469),
  float4(0.966798, 0.564396, 0.265118, 0.734375),
  float4(0.968526, 0.569700, 0.261721, 0.738281),
  float4(0.970205, 0.575028, 0.258325, 0.742188),
  float4(0.971835, 0.580382, 0.254931, 0.746094),
  float4(0.973416, 0.585761, 0.251540, 0.750000),
  float4(0.974947, 0.591165, 0.248151, 0.753906),
  float4(0.976428, 0.596595, 0.244767, 0.757812),
  float4(0.977856, 0.602051, 0.241387, 0.761719),
  float4(0.979233, 0.607532, 0.238013, 0.765625),
  float4(0.980556, 0.613039, 0.234646, 0.769531),
  float4(0.981826, 0.618572, 0.231287, 0.773438),
  float4(0.983041, 0.624131, 0.227937, 0.777344),
  float4(0.984199, 0.629718, 0.224595, 0.781250),
  float4(0.985301, 0.635330, 0.221265, 0.785156),
  float4(0.986345, 0.640969, 0.217948, 0.789062),
  float4(0.987332, 0.646633, 0.214648, 0.792969),
  float4(0.988260, 0.652325, 0.211364, 0.796875),
  float4(0.989128, 0.658043, 0.208100, 0.800781),
  float4(0.989935, 0.663787, 0.204859, 0.804688),
  float4(0.990681, 0.669558, 0.201642, 0.808594),
  float4(0.991365, 0.675355, 0.198453, 0.812500),
  float4(0.991985, 0.681179, 0.195295, 0.816406),
  float4(0.992541, 0.687030, 0.192170, 0.820312),
  float4(0.993032, 0.692907, 0.189084, 0.824219),
  float4(0.993456, 0.698810, 0.186041, 0.828125),
  float4(0.993814, 0.704741, 0.183043, 0.832031),
  float4(0.994103, 0.710698, 0.180097, 0.835938),
  float4(0.994324, 0.716681, 0.177208, 0.839844),
  float4(0.994474, 0.722691, 0.174381, 0.843750),
  float4(0.994553, 0.728728, 0.171622, 0.847656),
  float4(0.994561, 0.734791, 0.168938, 0.851562),
  float4(0.994495, 0.740880, 0.166335, 0.855469),
  float4(0.994355, 0.746995, 0.163821, 0.859375),
  float4(0.994141, 0.753137, 0.161404, 0.863281),
  float4(0.993851, 0.759304, 0.159092, 0.867188),
  float4(0.993482, 0.765499, 0.156891, 0.871094),
  float4(0.993033, 0.771720, 0.154808, 0.875000),
  float4(0.992505, 0.777967, 0.152855, 0.878906),
  float4(0.991897, 0.784239, 0.151042, 0.882812),
  float4(0.991209, 0.790537, 0.149377, 0.886719),
  float4(0.990439, 0.796859, 0.147870, 0.890625),
  float4(0.989587, 0.803205, 0.146529, 0.894531),
  float4(0.988648, 0.809579, 0.145357, 0.898438),
  float4(0.987621, 0.815978, 0.144363, 0.902344),
  float4(0.986509, 0.822401, 0.143557, 0.906250),
  float4(0.985314, 0.828846, 0.142945, 0.910156),
  float4(0.984031, 0.835315, 0.142528, 0.914062),
  float4(0.982653, 0.841812, 0.142303, 0.917969),
  float4(0.981190, 0.848329, 0.142279, 0.921875),
  float4(0.979644, 0.854866, 0.142453, 0.925781),
  float4(0.977995, 0.861432, 0.142808, 0.929688),
  float4(0.976265, 0.868016, 0.143351, 0.933594),
  float4(0.974443, 0.874622, 0.144061, 0.937500),
  float4(0.972530, 0.881250, 0.144923, 0.941406),
  float4(0.970533, 0.887896, 0.145919, 0.945312),
  float4(0.968443, 0.894564, 0.147014, 0.949219),
  float4(0.966271, 0.901249, 0.148180, 0.953125),
  float4(0.964021, 0.907950, 0.149370, 0.957031),
  float4(0.961681, 0.914672, 0.150520, 0.960938),
  float4(0.959276, 0.921407, 0.151566, 0.964844),
  float4(0.956808, 0.928152, 0.152409, 0.968750),
  float4(0.954287, 0.934908, 0.152921, 0.972656),
  float4(0.951726, 0.941671, 0.152925, 0.976562),
  float4(0.949151, 0.948435, 0.152178, 0.980469),
  float4(0.946602, 0.955190, 0.150328, 0.984375),
  float4(0.944152, 0.961916, 0.146861, 0.988281),
  float4(0.941896, 0.968590, 0.140956, 0.992188),
  float4(0.940015, 0.975158, 0.131326, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::InfernoTransferFunction
{
  float4(0.001462, 0.000466, 0.013866, 0.000000),
  float4(0.002267, 0.001270, 0.018570, 0.003906),
  float4(0.003299, 0.002249, 0.024239, 0.007812),
  float4(0.004547, 0.003392, 0.030909, 0.011719),
  float4(0.006006, 0.004692, 0.038558, 0.015625),
  float4(0.007676, 0.006136, 0.046836, 0.019531),
  float4(0.009561, 0.007713, 0.055143, 0.023438),
  float4(0.011663, 0.009417, 0.063460, 0.027344),
  float4(0.013995, 0.011225, 0.071862, 0.031250),
  float4(0.016561, 0.013136, 0.080282, 0.035156),
  float4(0.019373, 0.015133, 0.088767, 0.039062),
  float4(0.022447, 0.017199, 0.097327, 0.042969),
  float4(0.025793, 0.019331, 0.105930, 0.046875),
  float4(0.029432, 0.021503, 0.114621, 0.050781),
  float4(0.033385, 0.023702, 0.123397, 0.054688),
  float4(0.037668, 0.025921, 0.132232, 0.058594),
  float4(0.042253, 0.028139, 0.141141, 0.062500),
  float4(0.046915, 0.030324, 0.150164, 0.066406),
  float4(0.051644, 0.032474, 0.159254, 0.070312),
  float4(0.056449, 0.034569, 0.168414, 0.074219),
  float4(0.061340, 0.036590, 0.177642, 0.078125),
  float4(0.066331, 0.038504, 0.186962, 0.082031),
  float4(0.071429, 0.040294, 0.196354, 0.085938),
  float4(0.076637, 0.041905, 0.205799, 0.089844),
  float4(0.081962, 0.043328, 0.215289, 0.093750),
  float4(0.087411, 0.044556, 0.224813, 0.097656),
  float4(0.092990, 0.045583, 0.234358, 0.101562),
  float4(0.098702, 0.046402, 0.243904, 0.105469),
  float4(0.104551, 0.047008, 0.253430, 0.109375),
  float4(0.110536, 0.047399, 0.262912, 0.113281),
  float4(0.116656, 0.047574, 0.272321, 0.117188),
  float4(0.122908, 0.047536, 0.281624, 0.121094),
  float4(0.129285, 0.047293, 0.290788, 0.125000),
  float4(0.135778, 0.046856, 0.299776, 0.128906),
  float4(0.142378, 0.046242, 0.308553, 0.132812),
  float4(0.149073, 0.045468, 0.317085, 0.136719),
  float4(0.155850, 0.044559, 0.325338, 0.140625),
  float4(0.162689, 0.043554, 0.333277, 0.144531),
  float4(0.169575, 0.042489, 0.340874, 0.148438),
  float4(0.176493, 0.041402, 0.348111, 0.152344),
  float4(0.183429, 0.040329, 0.354971, 0.156250),
  float4(0.190367, 0.039309, 0.361447, 0.160156),
  float4(0.197297, 0.038400, 0.367535, 0.164062),
  float4(0.204209, 0.037632, 0.373238, 0.167969),
  float4(0.211095, 0.037030, 0.378563, 0.171875),
  float4(0.217949, 0.036615, 0.383522, 0.175781),
  float4(0.224763, 0.036405, 0.388129, 0.179688),
  float4(0.231538, 0.036405, 0.392400, 0.183594),
  float4(0.238273, 0.036621, 0.396353, 0.187500),
  float4(0.244967, 0.037055, 0.400007, 0.191406),
  float4(0.251620, 0.037705, 0.403378, 0.195312),
  float4(0.258234, 0.038571, 0.406485, 0.199219),
  float4(0.264810, 0.039647, 0.409345, 0.203125),
  float4(0.271347, 0.040922, 0.411976, 0.207031),
  float4(0.277850, 0.042353, 0.414392, 0.210938),
  float4(0.284321, 0.043933, 0.416608, 0.214844),
  float4(0.290763, 0.045644, 0.418637, 0.218750),
  float4(0.297178, 0.047470, 0.420491, 0.222656),
  float4(0.303568, 0.049396, 0.422182, 0.226562),
  float4(0.309935, 0.051407, 0.423721, 0.230469),
  float4(0.316282, 0.053490, 0.425116, 0.234375),
  float4(0.322610, 0.055634, 0.426377, 0.238281),
  float4(0.328921, 0.057827, 0.427511, 0.242188),
  float4(0.335217, 0.060060, 0.428524, 0.246094),
  float4(0.341500, 0.062325, 0.429425, 0.250000),
  float4(0.347771, 0.064616, 0.430217, 0.253906),
  float4(0.354032, 0.066925, 0.430906, 0.257812),
  float4(0.360284, 0.069247, 0.431497, 0.261719),
  float4(0.366529, 0.071579, 0.431994, 0.265625),
  float4(0.372768, 0.073915, 0.432400, 0.269531),
  float4(0.379001, 0.076253, 0.432719, 0.273438),
  float4(0.385228, 0.078591, 0.432955, 0.277344),
  float4(0.391453, 0.080927, 0.433109, 0.281250),
  float4(0.397674, 0.083257, 0.433183, 0.285156),
  float4(0.403894, 0.085580, 0.433179, 0.289062),
  float4(0.410113, 0.087896, 0.433098, 0.292969),
  float4(0.416331, 0.090203, 0.432943, 0.296875),
  float4(0.422549, 0.092501, 0.432714, 0.300781),
  float4(0.428768, 0.094790, 0.432412, 0.304688),
  float4(0.434987, 0.097069, 0.432039, 0.308594),
  float4(0.441207, 0.099338, 0.431594, 0.312500),
  float4(0.447428, 0.101597, 0.431080, 0.316406),
  float4(0.453651, 0.103848, 0.430498, 0.320312),
  float4(0.459875, 0.106089, 0.429846, 0.324219),
  float4(0.466100, 0.108322, 0.429125, 0.328125),
  float4(0.472328, 0.110547, 0.428334, 0.332031),
  float4(0.478558, 0.112764, 0.427475, 0.335938),
  float4(0.484789, 0.114974, 0.426548, 0.339844),
  float4(0.491022, 0.117179, 0.425552, 0.343750),
  float4(0.497257, 0.119379, 0.424488, 0.347656),
  float4(0.503493, 0.121575, 0.423356, 0.351562),
  float4(0.509730, 0.123769, 0.422156, 0.355469),
  float4(0.515967, 0.125960, 0.420887, 0.359375),
  float4(0.522206, 0.128150, 0.419549, 0.363281),
  float4(0.528444, 0.130341, 0.418142, 0.367188),
  float4(0.534683, 0.132534, 0.416667, 0.371094),
  float4(0.540920, 0.134729, 0.415123, 0.375000),
  float4(0.547157, 0.136929, 0.413511, 0.378906),
  float4(0.553392, 0.139134, 0.411829, 0.382812),
  float4(0.559624, 0.141346, 0.410078, 0.386719),
  float4(0.565854, 0.143567, 0.408258, 0.390625),
  float4(0.572081, 0.145797, 0.406369, 0.394531),
  float4(0.578304, 0.148039, 0.404411, 0.398438),
  float4(0.584521, 0.150294, 0.402385, 0.402344),
  float4(0.590734, 0.152563, 0.400290, 0.406250),
  float4(0.596940, 0.154848, 0.398125, 0.410156),
  float4(0.603139, 0.157151, 0.395891, 0.414062),
  float4(0.609330, 0.159474, 0.393589, 0.417969),
  float4(0.615513, 0.161817, 0.391219, 0.421875),
  float4(0.621685, 0.164184, 0.388781, 0.425781),
  float4(0.627847, 0.166575, 0.386276, 0.429688),
  float4(0.633998, 0.168992, 0.383704, 0.433594),
  float4(0.640135, 0.171438, 0.381065, 0.437500),
  float4(0.646260, 0.173914, 0.378359, 0.441406),
  float4(0.652369, 0.176421, 0.375586, 0.445312),
  float4(0.658463, 0.178962, 0.372748, 0.449219),
  float4(0.664540, 0.181539, 0.369846, 0.453125),
  float4(0.670599, 0.184153, 0.366879, 0.457031),
  float4(0.676638, 0.186807, 0.363849, 0.460938),
  float4(0.682656, 0.189501, 0.360757, 0.464844),
  float4(0.688653, 0.192239, 0.357603, 0.468750),
  float4(0.694627, 0.195021, 0.354388, 0.472656),
  float4(0.700576, 0.197851, 0.351113, 0.476562),
  float4(0.706500, 0.200728, 0.347777, 0.480469),
  float4(0.712396, 0.203656, 0.344383, 0.484375),
  float4(0.718264, 0.206636, 0.340931, 0.488281),
  float4(0.724103, 0.209670, 0.337424, 0.492188),
  float4(0.729909, 0.212759, 0.333861, 0.496094),
  float4(0.735683, 0.215906, 0.330245, 0.500000),
  float4(0.741423, 0.219112, 0.326576, 0.503906),
  float4(0.747127, 0.222378, 0.322856, 0.507812),
  float4(0.752794, 0.225706, 0.319085, 0.511719),
  float4(0.758422, 0.229097, 0.315266, 0.515625),
  float4(0.764010, 0.232554, 0.311399, 0.519531),
  float4(0.769556, 0.236077, 0.307485, 0.523438),
  float4(0.775059, 0.239667, 0.303526, 0.527344),
  float4(0.780517, 0.243327, 0.299523, 0.531250),
  float4(0.785929, 0.247056, 0.295477, 0.535156),
  float4(0.791293, 0.250856, 0.291390, 0.539062),
  float4(0.796607, 0.254728, 0.287264, 0.542969),
  float4(0.801871, 0.258674, 0.283099, 0.546875),
  float4(0.807082, 0.262692, 0.278898, 0.550781),
  float4(0.812239, 0.266786, 0.274661, 0.554688),
  float4(0.817341, 0.270954, 0.270390, 0.558594),
  float4(0.822386, 0.275197, 0.266085, 0.562500),
  float4(0.827372, 0.279517, 0.261750, 0.566406),
  float4(0.832299, 0.283913, 0.257383, 0.570312),
  float4(0.837165, 0.288385, 0.252988, 0.574219),
  float4(0.841969, 0.292933, 0.248564, 0.578125),
  float4(0.846709, 0.297559, 0.244113, 0.582031),
  float4(0.851384, 0.302260, 0.239636, 0.585938),
  float4(0.855992, 0.307038, 0.235133, 0.589844),
  float4(0.860533, 0.311892, 0.230606, 0.593750),
  float4(0.865006, 0.316822, 0.226055, 0.597656),
  float4(0.869409, 0.321827, 0.221482, 0.601562),
  float4(0.873741, 0.326906, 0.216886, 0.605469),
  float4(0.878001, 0.332060, 0.212268, 0.609375),
  float4(0.882188, 0.337287, 0.207628, 0.613281),
  float4(0.886302, 0.342586, 0.202968, 0.617188),
  float4(0.890341, 0.347957, 0.198286, 0.621094),
  float4(0.894305, 0.353399, 0.193584, 0.625000),
  float4(0.898192, 0.358911, 0.188860, 0.628906),
  float4(0.902003, 0.364492, 0.184116, 0.632812),
  float4(0.905735, 0.370140, 0.179350, 0.636719),
  float4(0.909390, 0.375856, 0.174563, 0.640625),
  float4(0.912966, 0.381636, 0.169755, 0.644531),
  float4(0.916462, 0.387481, 0.164924, 0.648438),
  float4(0.919879, 0.393389, 0.160070, 0.652344),
  float4(0.923215, 0.399359, 0.155193, 0.656250),
  float4(0.926470, 0.405389, 0.150292, 0.660156),
  float4(0.929644, 0.411479, 0.145367, 0.664062),
  float4(0.932737, 0.417627, 0.140417, 0.667969),
  float4(0.935747, 0.423831, 0.135440, 0.671875),
  float4(0.938675, 0.430091, 0.130438, 0.675781),
  float4(0.941521, 0.436405, 0.125409, 0.679688),
  float4(0.944285, 0.442772, 0.120354, 0.683594),
  float4(0.946965, 0.449191, 0.115272, 0.687500),
  float4(0.949562, 0.455660, 0.110164, 0.691406),
  float4(0.952075, 0.462178, 0.105031, 0.695312),
  float4(0.954506, 0.468744, 0.099874, 0.699219),
  float4(0.956852, 0.475356, 0.094695, 0.703125),
  float4(0.959114, 0.482014, 0.089499, 0.707031),
  float4(0.961293, 0.488716, 0.084289, 0.710938),
  float4(0.963387, 0.495462, 0.079073, 0.714844),
  float4(0.965397, 0.502249, 0.073859, 0.718750),
  float4(0.967322, 0.509078, 0.068659, 0.722656),
  float4(0.969163, 0.515946, 0.063488, 0.726562),
  float4(0.970919, 0.522853, 0.058367, 0.730469),
  float4(0.972590, 0.529798, 0.053324, 0.734375),
  float4(0.974176, 0.536780, 0.048392, 0.738281),
  float4(0.975677, 0.543798, 0.043618, 0.742188),
  float4(0.977092, 0.550850, 0.039050, 0.746094),
  float4(0.978422, 0.557937, 0.034931, 0.750000),
  float4(0.979666, 0.565057, 0.031409, 0.753906),
  float4(0.980824, 0.572209, 0.028508, 0.757812),
  float4(0.981895, 0.579392, 0.026250, 0.761719),
  float4(0.982881, 0.586606, 0.024661, 0.765625),
  float4(0.983779, 0.593849, 0.023770, 0.769531),
  float4(0.984591, 0.601122, 0.023606, 0.773438),
  float4(0.985315, 0.608422, 0.024202, 0.777344),
  float4(0.985952, 0.615750, 0.025592, 0.781250),
  float4(0.986502, 0.623105, 0.027814, 0.785156),
  float4(0.986964, 0.630485, 0.030908, 0.789062),
  float4(0.987337, 0.637890, 0.034916, 0.792969),
  float4(0.987622, 0.645320, 0.039886, 0.796875),
  float4(0.987819, 0.652773, 0.045581, 0.800781),
  float4(0.987926, 0.660250, 0.051750, 0.804688),
  float4(0.987945, 0.667748, 0.058329, 0.808594),
  float4(0.987874, 0.675267, 0.065257, 0.812500),
  float4(0.987714, 0.682807, 0.072489, 0.816406),
  float4(0.987464, 0.690366, 0.079990, 0.820312),
  float4(0.987124, 0.697944, 0.087731, 0.824219),
  float4(0.986694, 0.705540, 0.095694, 0.828125),
  float4(0.986175, 0.713153, 0.103863, 0.832031),
  float4(0.985566, 0.720782, 0.112229, 0.835938),
  float4(0.984865, 0.728427, 0.120785, 0.839844),
  float4(0.984075, 0.736087, 0.129527, 0.843750),
  float4(0.983196, 0.743758, 0.138453, 0.847656),
  float4(0.982228, 0.751442, 0.147565, 0.851562),
  float4(0.981173, 0.759135, 0.156863, 0.855469),
  float4(0.980032, 0.766837, 0.166353, 0.859375),
  float4(0.978806, 0.774545, 0.176037, 0.863281),
  float4(0.977497, 0.782258, 0.185923, 0.867188),
  float4(0.976108, 0.789974, 0.196018, 0.871094),
  float4(0.974638, 0.797692, 0.206332, 0.875000),
  float4(0.973088, 0.805409, 0.216877, 0.878906),
  float4(0.971468, 0.813122, 0.227658, 0.882812),
  float4(0.969783, 0.820825, 0.238686, 0.886719),
  float4(0.968041, 0.828515, 0.249972, 0.890625),
  float4(0.966243, 0.836191, 0.261534, 0.894531),
  float4(0.964394, 0.843848, 0.273391, 0.898438),
  float4(0.962517, 0.851476, 0.285546, 0.902344),
  float4(0.960626, 0.859069, 0.298010, 0.906250),
  float4(0.958720, 0.866624, 0.310820, 0.910156),
  float4(0.956834, 0.874129, 0.323974, 0.914062),
  float4(0.954997, 0.881569, 0.337475, 0.917969),
  float4(0.953215, 0.888942, 0.351369, 0.921875),
  float4(0.951546, 0.896226, 0.365627, 0.925781),
  float4(0.950018, 0.903409, 0.380271, 0.929688),
  float4(0.948683, 0.910473, 0.395289, 0.933594),
  float4(0.947594, 0.917399, 0.410665, 0.937500),
  float4(0.946809, 0.924168, 0.426373, 0.941406),
  float4(0.946392, 0.930761, 0.442367, 0.945312),
  float4(0.946403, 0.937159, 0.458592, 0.949219),
  float4(0.946903, 0.943348, 0.474970, 0.953125),
  float4(0.947937, 0.949318, 0.491426, 0.957031),
  float4(0.949545, 0.955063, 0.507860, 0.960938),
  float4(0.951740, 0.960587, 0.524203, 0.964844),
  float4(0.954529, 0.965896, 0.540361, 0.968750),
  float4(0.957896, 0.971003, 0.556275, 0.972656),
  float4(0.961812, 0.975924, 0.571925, 0.976562),
  float4(0.966249, 0.980678, 0.587206, 0.980469),
  float4(0.971162, 0.985282, 0.602154, 0.984375),
  float4(0.976511, 0.989753, 0.616760, 0.988281),
  float4(0.982257, 0.994109, 0.631017, 0.992188),
  float4(0.988362, 0.998364, 0.644924, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::MagmaTransferFunction
{
  float4(0.001462, 0.000466, 0.013866, 0.000000),
  float4(0.002258, 0.001295, 0.018331, 0.003906),
  float4(0.003279, 0.002305, 0.023708, 0.007812),
  float4(0.004512, 0.003490, 0.029965, 0.011719),
  float4(0.005950, 0.004843, 0.037130, 0.015625),
  float4(0.007588, 0.006356, 0.044973, 0.019531),
  float4(0.009426, 0.008022, 0.052844, 0.023438),
  float4(0.011465, 0.009828, 0.060750, 0.027344),
  float4(0.013708, 0.011771, 0.068667, 0.031250),
  float4(0.016156, 0.013840, 0.076603, 0.035156),
  float4(0.018815, 0.016026, 0.084584, 0.039062),
  float4(0.021692, 0.018320, 0.092610, 0.042969),
  float4(0.024792, 0.020715, 0.100676, 0.046875),
  float4(0.028123, 0.023201, 0.108787, 0.050781),
  float4(0.031696, 0.025765, 0.116965, 0.054688),
  float4(0.035520, 0.028397, 0.125209, 0.058594),
  float4(0.039608, 0.031090, 0.133515, 0.062500),
  float4(0.043830, 0.033830, 0.141886, 0.066406),
  float4(0.048062, 0.036607, 0.150327, 0.070312),
  float4(0.052320, 0.039407, 0.158841, 0.074219),
  float4(0.056615, 0.042160, 0.167446, 0.078125),
  float4(0.060949, 0.044794, 0.176129, 0.082031),
  float4(0.065330, 0.047318, 0.184892, 0.085938),
  float4(0.069764, 0.049726, 0.193735, 0.089844),
  float4(0.074257, 0.052017, 0.202660, 0.093750),
  float4(0.078815, 0.054184, 0.211667, 0.097656),
  float4(0.083446, 0.056225, 0.220755, 0.101562),
  float4(0.088155, 0.058133, 0.229922, 0.105469),
  float4(0.092949, 0.059904, 0.239164, 0.109375),
  float4(0.097833, 0.061531, 0.248477, 0.113281),
  float4(0.102815, 0.063010, 0.257854, 0.117188),
  float4(0.107899, 0.064335, 0.267289, 0.121094),
  float4(0.113094, 0.065492, 0.276784, 0.125000),
  float4(0.118405, 0.066479, 0.286321, 0.128906),
  float4(0.123833, 0.067295, 0.295879, 0.132812),
  float4(0.129380, 0.067935, 0.305443, 0.136719),
  float4(0.135053, 0.068391, 0.315000, 0.140625),
  float4(0.140858, 0.068654, 0.324538, 0.144531),
  float4(0.146785, 0.068738, 0.334011, 0.148438),
  float4(0.152839, 0.068637, 0.343404, 0.152344),
  float4(0.159018, 0.068354, 0.352688, 0.156250),
  float4(0.165308, 0.067911, 0.361816, 0.160156),
  float4(0.171713, 0.067305, 0.370771, 0.164062),
  float4(0.178212, 0.066576, 0.379497, 0.167969),
  float4(0.184801, 0.065732, 0.387973, 0.171875),
  float4(0.191460, 0.064818, 0.396152, 0.175781),
  float4(0.198177, 0.063862, 0.404009, 0.179688),
  float4(0.204935, 0.062907, 0.411514, 0.183594),
  float4(0.211718, 0.061992, 0.418647, 0.187500),
  float4(0.218512, 0.061158, 0.425392, 0.191406),
  float4(0.225302, 0.060445, 0.431742, 0.195312),
  float4(0.232077, 0.059889, 0.437695, 0.199219),
  float4(0.238826, 0.059517, 0.443256, 0.203125),
  float4(0.245543, 0.059352, 0.448436, 0.207031),
  float4(0.252220, 0.059415, 0.453248, 0.210938),
  float4(0.258857, 0.059706, 0.457710, 0.214844),
  float4(0.265447, 0.060237, 0.461840, 0.218750),
  float4(0.271994, 0.060994, 0.465660, 0.222656),
  float4(0.278493, 0.061978, 0.469190, 0.226562),
  float4(0.284951, 0.063168, 0.472451, 0.230469),
  float4(0.291366, 0.064553, 0.475462, 0.234375),
  float4(0.297740, 0.066117, 0.478243, 0.238281),
  float4(0.304081, 0.067835, 0.480812, 0.242188),
  float4(0.310382, 0.069702, 0.483186, 0.246094),
  float4(0.316654, 0.071690, 0.485380, 0.250000),
  float4(0.322899, 0.073782, 0.487408, 0.253906),
  float4(0.329114, 0.075972, 0.489287, 0.257812),
  float4(0.335308, 0.078236, 0.491024, 0.261719),
  float4(0.341482, 0.080564, 0.492631, 0.265625),
  float4(0.347636, 0.082946, 0.494121, 0.269531),
  float4(0.353773, 0.085373, 0.495501, 0.273438),
  float4(0.359898, 0.087831, 0.496778, 0.277344),
  float4(0.366012, 0.090314, 0.497960, 0.281250),
  float4(0.372116, 0.092816, 0.499053, 0.285156),
  float4(0.378211, 0.095332, 0.500067, 0.289062),
  float4(0.384299, 0.097855, 0.501002, 0.292969),
  float4(0.390384, 0.100379, 0.501864, 0.296875),
  float4(0.396467, 0.102902, 0.502658, 0.300781),
  float4(0.402548, 0.105420, 0.503386, 0.304688),
  float4(0.408629, 0.107930, 0.504052, 0.308594),
  float4(0.414709, 0.110431, 0.504662, 0.312500),
  float4(0.420791, 0.112920, 0.505215, 0.316406),
  float4(0.426877, 0.115395, 0.505714, 0.320312),
  float4(0.432967, 0.117855, 0.506160, 0.324219),
  float4(0.439062, 0.120298, 0.506555, 0.328125),
  float4(0.445163, 0.122724, 0.506901, 0.332031),
  float4(0.451271, 0.125132, 0.507198, 0.335938),
  float4(0.457386, 0.127522, 0.507448, 0.339844),
  float4(0.463508, 0.129893, 0.507652, 0.343750),
  float4(0.469640, 0.132245, 0.507809, 0.347656),
  float4(0.475780, 0.134577, 0.507921, 0.351562),
  float4(0.481929, 0.136891, 0.507989, 0.355469),
  float4(0.488088, 0.139186, 0.508011, 0.359375),
  float4(0.494258, 0.141462, 0.507988, 0.363281),
  float4(0.500438, 0.143719, 0.507920, 0.367188),
  float4(0.506629, 0.145958, 0.507806, 0.371094),
  float4(0.512831, 0.148179, 0.507648, 0.375000),
  float4(0.519045, 0.150383, 0.507443, 0.378906),
  float4(0.525270, 0.152569, 0.507192, 0.382812),
  float4(0.531507, 0.154739, 0.506895, 0.386719),
  float4(0.537755, 0.156894, 0.506551, 0.390625),
  float4(0.544015, 0.159033, 0.506159, 0.394531),
  float4(0.550287, 0.161158, 0.505719, 0.398438),
  float4(0.556571, 0.163269, 0.505230, 0.402344),
  float4(0.562866, 0.165368, 0.504692, 0.406250),
  float4(0.569172, 0.167454, 0.504105, 0.410156),
  float4(0.575490, 0.169530, 0.503466, 0.414062),
  float4(0.581819, 0.171596, 0.502777, 0.417969),
  float4(0.588158, 0.173652, 0.502035, 0.421875),
  float4(0.594508, 0.175701, 0.501241, 0.425781),
  float4(0.600868, 0.177743, 0.500394, 0.429688),
  float4(0.607238, 0.179779, 0.499492, 0.433594),
  float4(0.613617, 0.181811, 0.498536, 0.437500),
  float4(0.620005, 0.183840, 0.497524, 0.441406),
  float4(0.626401, 0.185867, 0.496456, 0.445312),
  float4(0.632805, 0.187893, 0.495332, 0.449219),
  float4(0.639216, 0.189921, 0.494150, 0.453125),
  float4(0.645633, 0.191952, 0.492910, 0.457031),
  float4(0.652056, 0.193986, 0.491611, 0.460938),
  float4(0.658483, 0.196027, 0.490253, 0.464844),
  float4(0.664915, 0.198075, 0.488836, 0.468750),
  float4(0.671349, 0.200133, 0.487358, 0.472656),
  float4(0.677786, 0.202203, 0.485819, 0.476562),
  float4(0.684224, 0.204286, 0.484219, 0.480469),
  float4(0.690661, 0.206384, 0.482558, 0.484375),
  float4(0.697098, 0.208501, 0.480835, 0.488281),
  float4(0.703532, 0.210638, 0.479049, 0.492188),
  float4(0.709962, 0.212797, 0.477201, 0.496094),
  float4(0.716387, 0.214982, 0.475290, 0.500000),
  float4(0.722805, 0.217194, 0.473316, 0.503906),
  float4(0.729216, 0.219437, 0.471279, 0.507812),
  float4(0.735616, 0.221713, 0.469180, 0.511719),
  float4(0.742004, 0.224025, 0.467018, 0.515625),
  float4(0.748378, 0.226377, 0.464794, 0.519531),
  float4(0.754737, 0.228772, 0.462509, 0.523438),
  float4(0.761077, 0.231214, 0.460162, 0.527344),
  float4(0.767398, 0.233705, 0.457755, 0.531250),
  float4(0.773695, 0.236249, 0.455289, 0.535156),
  float4(0.779968, 0.238851, 0.452765, 0.539062),
  float4(0.786212, 0.241514, 0.450184, 0.542969),
  float4(0.792427, 0.244242, 0.447543, 0.546875),
  float4(0.798608, 0.247040, 0.444848, 0.550781),
  float4(0.804752, 0.249911, 0.442102, 0.554688),
  float4(0.810855, 0.252861, 0.439305, 0.558594),
  float4(0.816914, 0.255895, 0.436461, 0.562500),
  float4(0.822926, 0.259016, 0.433573, 0.566406),
  float4(0.828886, 0.262229, 0.430644, 0.570312),
  float4(0.834791, 0.265540, 0.427671, 0.574219),
  float4(0.840636, 0.268953, 0.424666, 0.578125),
  float4(0.846416, 0.272473, 0.421631, 0.582031),
  float4(0.852126, 0.276106, 0.418573, 0.585938),
  float4(0.857763, 0.279857, 0.415496, 0.589844),
  float4(0.863320, 0.283729, 0.412403, 0.593750),
  float4(0.868793, 0.287728, 0.409303, 0.597656),
  float4(0.874176, 0.291859, 0.406205, 0.601562),
  float4(0.879464, 0.296125, 0.403118, 0.605469),
  float4(0.884651, 0.300530, 0.400047, 0.609375),
  float4(0.889731, 0.305079, 0.397002, 0.613281),
  float4(0.894700, 0.309773, 0.393995, 0.617188),
  float4(0.899552, 0.314616, 0.391037, 0.621094),
  float4(0.904281, 0.319610, 0.388137, 0.625000),
  float4(0.908884, 0.324755, 0.385308, 0.628906),
  float4(0.913354, 0.330052, 0.382563, 0.632812),
  float4(0.917689, 0.335500, 0.379915, 0.636719),
  float4(0.921884, 0.341098, 0.377376, 0.640625),
  float4(0.925937, 0.346844, 0.374959, 0.644531),
  float4(0.929845, 0.352734, 0.372677, 0.648438),
  float4(0.933606, 0.358764, 0.370541, 0.652344),
  float4(0.937221, 0.364929, 0.368567, 0.656250),
  float4(0.940687, 0.371224, 0.366762, 0.660156),
  float4(0.944006, 0.377643, 0.365136, 0.664062),
  float4(0.947180, 0.384178, 0.363701, 0.667969),
  float4(0.950210, 0.390820, 0.362468, 0.671875),
  float4(0.953099, 0.397563, 0.361438, 0.675781),
  float4(0.955849, 0.404400, 0.360619, 0.679688),
  float4(0.958464, 0.411324, 0.360014, 0.683594),
  float4(0.960949, 0.418323, 0.359630, 0.687500),
  float4(0.963310, 0.425390, 0.359469, 0.691406),
  float4(0.965549, 0.432519, 0.359529, 0.695312),
  float4(0.967671, 0.439703, 0.359810, 0.699219),
  float4(0.969680, 0.446936, 0.360311, 0.703125),
  float4(0.971582, 0.454210, 0.361030, 0.707031),
  float4(0.973381, 0.461520, 0.361965, 0.710938),
  float4(0.975082, 0.468861, 0.363111, 0.714844),
  float4(0.976690, 0.476226, 0.364466, 0.718750),
  float4(0.978210, 0.483612, 0.366025, 0.722656),
  float4(0.979645, 0.491014, 0.367783, 0.726562),
  float4(0.981000, 0.498428, 0.369734, 0.730469),
  float4(0.982279, 0.505851, 0.371874, 0.734375),
  float4(0.983485, 0.513280, 0.374198, 0.738281),
  float4(0.984622, 0.520713, 0.376698, 0.742188),
  float4(0.985693, 0.528148, 0.379371, 0.746094),
  float4(0.986700, 0.535582, 0.382210, 0.750000),
  float4(0.987646, 0.543015, 0.385210, 0.753906),
  float4(0.988533, 0.550446, 0.388365, 0.757812),
  float4(0.989363, 0.557873, 0.391671, 0.761719),
  float4(0.990138, 0.565296, 0.395122, 0.765625),
  float4(0.990871, 0.572706, 0.398714, 0.769531),
  float4(0.991558, 0.580107, 0.402441, 0.773438),
  float4(0.992196, 0.587502, 0.406299, 0.777344),
  float4(0.992785, 0.594891, 0.410283, 0.781250),
  float4(0.993326, 0.602275, 0.414390, 0.785156),
  float4(0.993834, 0.609644, 0.418613, 0.789062),
  float4(0.994309, 0.616999, 0.422950, 0.792969),
  float4(0.994738, 0.624350, 0.427397, 0.796875),
  float4(0.995122, 0.631696, 0.431951, 0.800781),
  float4(0.995480, 0.639027, 0.436607, 0.804688),
  float4(0.995810, 0.646344, 0.441361, 0.808594),
  float4(0.996096, 0.653659, 0.446213, 0.812500),
  float4(0.996341, 0.660969, 0.451160, 0.816406),
  float4(0.996580, 0.668256, 0.456192, 0.820312),
  float4(0.996775, 0.675541, 0.461314, 0.824219),
  float4(0.996925, 0.682828, 0.466526, 0.828125),
  float4(0.997077, 0.690088, 0.471811, 0.832031),
  float4(0.997186, 0.697349, 0.477182, 0.835938),
  float4(0.997254, 0.704611, 0.482635, 0.839844),
  float4(0.997325, 0.711848, 0.488154, 0.843750),
  float4(0.997351, 0.719089, 0.493755, 0.847656),
  float4(0.997351, 0.726324, 0.499428, 0.851562),
  float4(0.997341, 0.733545, 0.505167, 0.855469),
  float4(0.997285, 0.740772, 0.510983, 0.859375),
  float4(0.997228, 0.747981, 0.516859, 0.863281),
  float4(0.997138, 0.755190, 0.522806, 0.867188),
  float4(0.997019, 0.762398, 0.528821, 0.871094),
  float4(0.996898, 0.769591, 0.534892, 0.875000),
  float4(0.996727, 0.776795, 0.541039, 0.878906),
  float4(0.996571, 0.783977, 0.547233, 0.882812),
  float4(0.996369, 0.791167, 0.553499, 0.886719),
  float4(0.996162, 0.798348, 0.559820, 0.890625),
  float4(0.995932, 0.805527, 0.566202, 0.894531),
  float4(0.995680, 0.812706, 0.572645, 0.898438),
  float4(0.995424, 0.819875, 0.579140, 0.902344),
  float4(0.995131, 0.827052, 0.585701, 0.906250),
  float4(0.994851, 0.834213, 0.592307, 0.910156),
  float4(0.994524, 0.841387, 0.598983, 0.914062),
  float4(0.994222, 0.848540, 0.605696, 0.917969),
  float4(0.993866, 0.855711, 0.612482, 0.921875),
  float4(0.993545, 0.862859, 0.619299, 0.925781),
  float4(0.993170, 0.870024, 0.626189, 0.929688),
  float4(0.992831, 0.877168, 0.633109, 0.933594),
  float4(0.992440, 0.884330, 0.640099, 0.937500),
  float4(0.992089, 0.891470, 0.647116, 0.941406),
  float4(0.991688, 0.898627, 0.654202, 0.945312),
  float4(0.991332, 0.905763, 0.661309, 0.949219),
  float4(0.990930, 0.912915, 0.668481, 0.953125),
  float4(0.990570, 0.920049, 0.675675, 0.957031),
  float4(0.990175, 0.927196, 0.682926, 0.960938),
  float4(0.989815, 0.934329, 0.690198, 0.964844),
  float4(0.989434, 0.941470, 0.697519, 0.968750),
  float4(0.989077, 0.948604, 0.704863, 0.972656),
  float4(0.988717, 0.955742, 0.712242, 0.976562),
  float4(0.988367, 0.962878, 0.719649, 0.980469),
  float4(0.988033, 0.970012, 0.727077, 0.984375),
  float4(0.987691, 0.977154, 0.734536, 0.988281),
  float4(0.987387, 0.984288, 0.742002, 0.992188),
  float4(0.987053, 0.991438, 0.749504, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::CividisTransferFunction
{
  float4(0.000000, 0.135112, 0.304751, 0.000000),
  float4(0.000000, 0.138068, 0.311105, 0.003906),
  float4(0.000000, 0.141013, 0.317579, 0.007812),
  float4(0.000000, 0.143951, 0.323982, 0.011719),
  float4(0.000000, 0.146877, 0.330479, 0.015625),
  float4(0.000000, 0.149791, 0.337065, 0.019531),
  float4(0.000000, 0.152673, 0.343704, 0.023438),
  float4(0.000000, 0.155377, 0.350500, 0.027344),
  float4(0.000000, 0.157932, 0.357521, 0.031250),
  float4(0.000000, 0.160495, 0.364534, 0.035156),
  float4(0.000000, 0.163058, 0.371608, 0.039062),
  float4(0.000000, 0.165621, 0.378769, 0.042969),
  float4(0.000000, 0.168204, 0.385902, 0.046875),
  float4(0.000000, 0.170800, 0.393100, 0.050781),
  float4(0.000000, 0.173420, 0.400353, 0.054688),
  float4(0.000000, 0.176082, 0.407577, 0.058594),
  float4(0.000000, 0.178802, 0.414764, 0.062500),
  float4(0.000000, 0.181610, 0.421859, 0.066406),
  float4(0.000000, 0.184550, 0.428802, 0.070312),
  float4(0.000000, 0.186915, 0.435532, 0.074219),
  float4(0.000000, 0.188769, 0.439563, 0.078125),
  float4(0.000000, 0.190950, 0.441085, 0.082031),
  float4(0.000000, 0.193366, 0.441561, 0.085938),
  float4(0.003602, 0.195911, 0.441564, 0.089844),
  float4(0.017852, 0.198528, 0.441248, 0.093750),
  float4(0.032110, 0.201199, 0.440785, 0.097656),
  float4(0.046205, 0.203903, 0.440196, 0.101562),
  float4(0.058378, 0.206629, 0.439531, 0.105469),
  float4(0.068968, 0.209372, 0.438863, 0.109375),
  float4(0.078624, 0.212122, 0.438105, 0.113281),
  float4(0.087465, 0.214879, 0.437342, 0.117188),
  float4(0.095645, 0.217643, 0.436593, 0.121094),
  float4(0.103401, 0.220406, 0.435790, 0.125000),
  float4(0.110658, 0.223170, 0.435067, 0.128906),
  float4(0.117612, 0.225935, 0.434308, 0.132812),
  float4(0.124291, 0.228697, 0.433547, 0.136719),
  float4(0.130669, 0.231458, 0.432840, 0.140625),
  float4(0.136830, 0.234216, 0.432148, 0.144531),
  float4(0.142852, 0.236972, 0.431404, 0.148438),
  float4(0.148638, 0.239724, 0.430752, 0.152344),
  float4(0.154261, 0.242475, 0.430120, 0.156250),
  float4(0.159733, 0.245221, 0.429528, 0.160156),
  float4(0.165113, 0.247965, 0.428908, 0.164062),
  float4(0.170362, 0.250707, 0.428325, 0.167969),
  float4(0.175490, 0.253444, 0.427790, 0.171875),
  float4(0.180503, 0.256180, 0.427299, 0.175781),
  float4(0.185453, 0.258914, 0.426788, 0.179688),
  float4(0.190303, 0.261644, 0.426329, 0.183594),
  float4(0.195057, 0.264372, 0.425924, 0.187500),
  float4(0.199764, 0.267099, 0.425497, 0.191406),
  float4(0.204385, 0.269823, 0.425126, 0.195312),
  float4(0.208926, 0.272546, 0.424809, 0.199219),
  float4(0.213431, 0.275266, 0.424480, 0.203125),
  float4(0.217863, 0.277985, 0.424206, 0.207031),
  float4(0.222264, 0.280702, 0.423914, 0.210938),
  float4(0.226598, 0.283419, 0.423678, 0.214844),
  float4(0.230871, 0.286134, 0.423498, 0.218750),
  float4(0.235120, 0.288848, 0.423304, 0.222656),
  float4(0.239312, 0.291562, 0.423167, 0.226562),
  float4(0.243485, 0.294274, 0.423014, 0.230469),
  float4(0.247605, 0.296986, 0.422917, 0.234375),
  float4(0.251675, 0.299698, 0.422873, 0.238281),
  float4(0.255731, 0.302409, 0.422814, 0.242188),
  float4(0.259740, 0.305120, 0.422810, 0.246094),
  float4(0.263738, 0.307831, 0.422789, 0.250000),
  float4(0.267693, 0.310542, 0.422821, 0.253906),
  float4(0.271639, 0.313253, 0.422837, 0.257812),
  float4(0.275513, 0.315965, 0.422979, 0.261719),
  float4(0.279411, 0.318677, 0.423031, 0.265625),
  float4(0.283240, 0.321390, 0.423211, 0.269531),
  float4(0.287065, 0.324103, 0.423373, 0.273438),
  float4(0.290884, 0.326816, 0.423517, 0.277344),
  float4(0.294669, 0.329531, 0.423716, 0.281250),
  float4(0.298421, 0.332247, 0.423973, 0.285156),
  float4(0.302169, 0.334963, 0.424213, 0.289062),
  float4(0.305886, 0.337681, 0.424512, 0.292969),
  float4(0.309601, 0.340399, 0.424790, 0.296875),
  float4(0.313287, 0.343120, 0.425120, 0.300781),
  float4(0.316941, 0.345842, 0.425512, 0.304688),
  float4(0.320595, 0.348565, 0.425889, 0.308594),
  float4(0.324250, 0.351289, 0.426250, 0.312500),
  float4(0.327875, 0.354016, 0.426670, 0.316406),
  float4(0.331474, 0.356744, 0.427144, 0.320312),
  float4(0.335073, 0.359474, 0.427605, 0.324219),
  float4(0.338673, 0.362206, 0.428053, 0.328125),
  float4(0.342246, 0.364939, 0.428559, 0.332031),
  float4(0.345793, 0.367676, 0.429127, 0.335938),
  float4(0.349341, 0.370414, 0.429685, 0.339844),
  float4(0.352892, 0.373153, 0.430226, 0.343750),
  float4(0.356418, 0.375896, 0.430823, 0.347656),
  float4(0.359916, 0.378641, 0.431501, 0.351562),
  float4(0.363446, 0.381388, 0.432075, 0.355469),
  float4(0.366923, 0.384139, 0.432796, 0.359375),
  float4(0.370430, 0.386890, 0.433428, 0.363281),
  float4(0.373884, 0.389646, 0.434209, 0.367188),
  float4(0.377371, 0.392404, 0.434890, 0.371094),
  float4(0.380830, 0.395164, 0.435653, 0.375000),
  float4(0.384268, 0.397928, 0.436475, 0.378906),
  float4(0.387705, 0.400694, 0.437305, 0.382812),
  float4(0.391151, 0.403464, 0.438096, 0.386719),
  float4(0.394568, 0.406236, 0.438986, 0.390625),
  float4(0.397991, 0.409011, 0.439848, 0.394531),
  float4(0.401418, 0.411790, 0.440708, 0.398438),
  float4(0.404820, 0.414572, 0.441642, 0.402344),
  float4(0.408226, 0.417357, 0.442570, 0.406250),
  float4(0.411607, 0.420145, 0.443577, 0.410156),
  float4(0.414992, 0.422937, 0.444578, 0.414062),
  float4(0.418383, 0.425733, 0.445560, 0.417969),
  float4(0.421748, 0.428531, 0.446640, 0.421875),
  float4(0.425120, 0.431334, 0.447692, 0.425781),
  float4(0.428462, 0.434140, 0.448864, 0.429688),
  float4(0.431817, 0.436950, 0.449982, 0.433594),
  float4(0.435168, 0.439763, 0.451134, 0.437500),
  float4(0.438504, 0.442580, 0.452341, 0.441406),
  float4(0.441810, 0.445402, 0.453659, 0.445312),
  float4(0.445148, 0.448226, 0.454885, 0.449219),
  float4(0.448447, 0.451053, 0.456264, 0.453125),
  float4(0.451759, 0.453887, 0.457582, 0.457031),
  float4(0.455072, 0.456718, 0.458976, 0.460938),
  float4(0.458366, 0.459552, 0.460457, 0.464844),
  float4(0.461616, 0.462405, 0.461969, 0.468750),
  float4(0.464947, 0.465241, 0.463395, 0.472656),
  float4(0.468254, 0.468083, 0.464908, 0.476562),
  float4(0.471501, 0.470960, 0.466357, 0.480469),
  float4(0.474812, 0.473832, 0.467681, 0.484375),
  float4(0.478186, 0.476699, 0.468845, 0.488281),
  float4(0.481622, 0.479573, 0.469767, 0.492188),
  float4(0.485141, 0.482451, 0.470384, 0.496094),
  float4(0.488697, 0.485318, 0.471008, 0.500000),
  float4(0.492278, 0.488198, 0.471453, 0.503906),
  float4(0.495913, 0.491076, 0.471751, 0.507812),
  float4(0.499552, 0.493960, 0.472032, 0.511719),
  float4(0.503185, 0.496851, 0.472305, 0.515625),
  float4(0.506866, 0.499743, 0.472432, 0.519531),
  float4(0.510540, 0.502643, 0.472550, 0.523438),
  float4(0.514226, 0.505546, 0.472640, 0.527344),
  float4(0.517920, 0.508454, 0.472707, 0.531250),
  float4(0.521643, 0.511367, 0.472639, 0.535156),
  float4(0.525348, 0.514285, 0.472660, 0.539062),
  float4(0.529086, 0.517207, 0.472543, 0.542969),
  float4(0.532829, 0.520135, 0.472401, 0.546875),
  float4(0.536553, 0.523067, 0.472352, 0.550781),
  float4(0.540307, 0.526005, 0.472163, 0.554688),
  float4(0.544069, 0.528948, 0.471947, 0.558594),
  float4(0.547840, 0.531895, 0.471704, 0.562500),
  float4(0.551612, 0.534849, 0.471439, 0.566406),
  float4(0.555393, 0.537807, 0.471147, 0.570312),
  float4(0.559181, 0.540771, 0.470829, 0.574219),
  float4(0.562972, 0.543741, 0.470488, 0.578125),
  float4(0.566802, 0.546715, 0.469988, 0.582031),
  float4(0.570607, 0.549695, 0.469593, 0.585938),
  float4(0.574417, 0.552682, 0.469172, 0.589844),
  float4(0.578236, 0.555673, 0.468724, 0.593750),
  float4(0.582087, 0.558670, 0.468118, 0.597656),
  float4(0.585916, 0.561674, 0.467618, 0.601562),
  float4(0.589753, 0.564682, 0.467090, 0.605469),
  float4(0.593622, 0.567697, 0.466401, 0.609375),
  float4(0.597469, 0.570718, 0.465821, 0.613281),
  float4(0.601354, 0.573743, 0.465074, 0.617188),
  float4(0.605211, 0.576777, 0.464441, 0.621094),
  float4(0.609105, 0.579816, 0.463638, 0.625000),
  float4(0.612977, 0.582861, 0.462950, 0.628906),
  float4(0.616852, 0.585913, 0.462237, 0.632812),
  float4(0.620765, 0.588970, 0.461351, 0.636719),
  float4(0.624654, 0.592034, 0.460583, 0.640625),
  float4(0.628576, 0.595104, 0.459641, 0.644531),
  float4(0.632506, 0.598180, 0.458668, 0.648438),
  float4(0.636412, 0.601264, 0.457818, 0.652344),
  float4(0.640352, 0.604354, 0.456791, 0.656250),
  float4(0.644270, 0.607450, 0.455886, 0.660156),
  float4(0.648222, 0.610553, 0.454801, 0.664062),
  float4(0.652178, 0.613664, 0.453689, 0.667969),
  float4(0.656114, 0.616780, 0.452702, 0.671875),
  float4(0.660082, 0.619904, 0.451534, 0.675781),
  float4(0.664055, 0.623034, 0.450338, 0.679688),
  float4(0.668008, 0.626171, 0.449270, 0.683594),
  float4(0.671991, 0.629316, 0.448018, 0.687500),
  float4(0.675981, 0.632468, 0.446736, 0.691406),
  float4(0.679979, 0.635626, 0.445424, 0.695312),
  float4(0.683950, 0.638793, 0.444251, 0.699219),
  float4(0.687957, 0.641966, 0.442886, 0.703125),
  float4(0.691971, 0.645145, 0.441491, 0.707031),
  float4(0.695985, 0.648334, 0.440072, 0.710938),
  float4(0.700008, 0.651529, 0.438624, 0.714844),
  float4(0.704037, 0.654731, 0.437147, 0.718750),
  float4(0.708067, 0.657942, 0.435647, 0.722656),
  float4(0.712105, 0.661160, 0.434117, 0.726562),
  float4(0.716177, 0.664384, 0.432386, 0.730469),
  float4(0.720222, 0.667618, 0.430805, 0.734375),
  float4(0.724274, 0.670859, 0.429194, 0.738281),
  float4(0.728334, 0.674107, 0.427554, 0.742188),
  float4(0.732422, 0.677364, 0.425717, 0.746094),
  float4(0.736488, 0.680629, 0.424028, 0.750000),
  float4(0.740589, 0.683900, 0.422131, 0.753906),
  float4(0.744664, 0.687181, 0.420393, 0.757812),
  float4(0.748772, 0.690470, 0.418448, 0.761719),
  float4(0.752886, 0.693766, 0.416472, 0.765625),
  float4(0.756975, 0.697071, 0.414659, 0.769531),
  float4(0.761096, 0.700384, 0.412638, 0.773438),
  float4(0.765223, 0.703705, 0.410587, 0.777344),
  float4(0.769353, 0.707035, 0.408516, 0.781250),
  float4(0.773486, 0.710373, 0.406422, 0.785156),
  float4(0.777651, 0.713719, 0.404112, 0.789062),
  float4(0.781795, 0.717074, 0.401966, 0.792969),
  float4(0.785965, 0.720438, 0.399613, 0.796875),
  float4(0.790116, 0.723810, 0.397423, 0.800781),
  float4(0.794298, 0.727190, 0.395016, 0.804688),
  float4(0.798480, 0.730580, 0.392597, 0.808594),
  float4(0.802667, 0.733978, 0.390153, 0.812500),
  float4(0.806859, 0.737385, 0.387684, 0.816406),
  float4(0.811054, 0.740801, 0.385198, 0.820312),
  float4(0.815274, 0.744226, 0.382504, 0.824219),
  float4(0.819499, 0.747659, 0.379785, 0.828125),
  float4(0.823729, 0.751101, 0.377043, 0.832031),
  float4(0.827959, 0.754553, 0.374292, 0.835938),
  float4(0.832192, 0.758014, 0.371529, 0.839844),
  float4(0.836429, 0.761483, 0.368747, 0.843750),
  float4(0.840693, 0.764962, 0.365746, 0.847656),
  float4(0.844957, 0.768450, 0.362741, 0.851562),
  float4(0.849223, 0.771947, 0.359729, 0.855469),
  float4(0.853515, 0.775454, 0.356500, 0.859375),
  float4(0.857809, 0.778969, 0.353259, 0.863281),
  float4(0.862105, 0.782494, 0.350011, 0.867188),
  float4(0.866421, 0.786028, 0.346571, 0.871094),
  float4(0.870717, 0.789572, 0.343333, 0.875000),
  float4(0.875057, 0.793125, 0.339685, 0.878906),
  float4(0.879378, 0.796687, 0.336241, 0.882812),
  float4(0.883720, 0.800258, 0.332599, 0.886719),
  float4(0.888081, 0.803839, 0.328770, 0.890625),
  float4(0.892440, 0.807430, 0.324968, 0.894531),
  float4(0.896818, 0.811030, 0.320982, 0.898438),
  float4(0.901195, 0.814639, 0.317021, 0.902344),
  float4(0.905589, 0.818257, 0.312889, 0.906250),
  float4(0.910000, 0.821885, 0.308594, 0.910156),
  float4(0.914407, 0.825522, 0.304348, 0.914062),
  float4(0.918828, 0.829168, 0.299960, 0.917969),
  float4(0.923279, 0.832822, 0.295244, 0.921875),
  float4(0.927724, 0.836486, 0.290611, 0.925781),
  float4(0.932180, 0.840159, 0.285880, 0.929688),
  float4(0.936660, 0.843841, 0.280876, 0.933594),
  float4(0.941147, 0.847530, 0.275815, 0.937500),
  float4(0.945654, 0.851228, 0.270532, 0.941406),
  float4(0.950178, 0.854933, 0.265085, 0.945312),
  float4(0.954725, 0.858646, 0.259365, 0.949219),
  float4(0.959284, 0.862365, 0.253563, 0.953125),
  float4(0.963872, 0.866089, 0.247445, 0.957031),
  float4(0.968469, 0.869819, 0.241310, 0.960938),
  float4(0.973114, 0.873550, 0.234677, 0.964844),
  float4(0.977780, 0.877281, 0.227954, 0.968750),
  float4(0.982497, 0.881008, 0.220878, 0.972656),
  float4(0.987293, 0.884718, 0.213336, 0.976562),
  float4(0.992218, 0.888385, 0.205468, 0.980469),
  float4(0.994847, 0.892954, 0.203445, 0.984375),
  float4(0.995249, 0.898384, 0.207561, 0.988281),
  float4(0.995503, 0.903866, 0.212370, 0.992188),
  float4(0.995737, 0.909344, 0.217772, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::SpringTransferFunction
{
  float4(1.000000, 0.000000, 1.000000, 0.000000),
  float4(1.000000, 0.003922, 0.996078, 0.003906),
  float4(1.000000, 0.007843, 0.992157, 0.007812),
  float4(1.000000, 0.011765, 0.988235, 0.011719),
  float4(1.000000, 0.015686, 0.984314, 0.015625),
  float4(1.000000, 0.019608, 0.980392, 0.019531),
  float4(1.000000, 0.023529, 0.976471, 0.023438),
  float4(1.000000, 0.027451, 0.972549, 0.027344),
  float4(1.000000, 0.031373, 0.968627, 0.031250),
  float4(1.000000, 0.035294, 0.964706, 0.035156),
  float4(1.000000, 0.039216, 0.960784, 0.039062),
  float4(1.000000, 0.043137, 0.956863, 0.042969),
  float4(1.000000, 0.047059, 0.952941, 0.046875),
  float4(1.000000, 0.050980, 0.949020, 0.050781),
  float4(1.000000, 0.054902, 0.945098, 0.054688),
  float4(1.000000, 0.058824, 0.941176, 0.058594),
  float4(1.000000, 0.062745, 0.937255, 0.062500),
  float4(1.000000, 0.066667, 0.933333, 0.066406),
  float4(1.000000, 0.070588, 0.929412, 0.070312),
  float4(1.000000, 0.074510, 0.925490, 0.074219),
  float4(1.000000, 0.078431, 0.921569, 0.078125),
  float4(1.000000, 0.082353, 0.917647, 0.082031),
  float4(1.000000, 0.086275, 0.913725, 0.085938),
  float4(1.000000, 0.090196, 0.909804, 0.089844),
  float4(1.000000, 0.094118, 0.905882, 0.093750),
  float4(1.000000, 0.098039, 0.901961, 0.097656),
  float4(1.000000, 0.101961, 0.898039, 0.101562),
  float4(1.000000, 0.105882, 0.894118, 0.105469),
  float4(1.000000, 0.109804, 0.890196, 0.109375),
  float4(1.000000, 0.113725, 0.886275, 0.113281),
  float4(1.000000, 0.117647, 0.882353, 0.117188),
  float4(1.000000, 0.121569, 0.878431, 0.121094),
  float4(1.000000, 0.125490, 0.874510, 0.125000),
  float4(1.000000, 0.129412, 0.870588, 0.128906),
  float4(1.000000, 0.133333, 0.866667, 0.132812),
  float4(1.000000, 0.137255, 0.862745, 0.136719),
  float4(1.000000, 0.141176, 0.858824, 0.140625),
  float4(1.000000, 0.145098, 0.854902, 0.144531),
  float4(1.000000, 0.149020, 0.850980, 0.148438),
  float4(1.000000, 0.152941, 0.847059, 0.152344),
  float4(1.000000, 0.156863, 0.843137, 0.156250),
  float4(1.000000, 0.160784, 0.839216, 0.160156),
  float4(1.000000, 0.164706, 0.835294, 0.164062),
  float4(1.000000, 0.168627, 0.831373, 0.167969),
  float4(1.000000, 0.172549, 0.827451, 0.171875),
  float4(1.000000, 0.176471, 0.823529, 0.175781),
  float4(1.000000, 0.180392, 0.819608, 0.179688),
  float4(1.000000, 0.184314, 0.815686, 0.183594),
  float4(1.000000, 0.188235, 0.811765, 0.187500),
  float4(1.000000, 0.192157, 0.807843, 0.191406),
  float4(1.000000, 0.196078, 0.803922, 0.195312),
  float4(1.000000, 0.200000, 0.800000, 0.199219),
  float4(1.000000, 0.203922, 0.796078, 0.203125),
  float4(1.000000, 0.207843, 0.792157, 0.207031),
  float4(1.000000, 0.211765, 0.788235, 0.210938),
  float4(1.000000, 0.215686, 0.784314, 0.214844),
  float4(1.000000, 0.219608, 0.780392, 0.218750),
  float4(1.000000, 0.223529, 0.776471, 0.222656),
  float4(1.000000, 0.227451, 0.772549, 0.226562),
  float4(1.000000, 0.231373, 0.768627, 0.230469),
  float4(1.000000, 0.235294, 0.764706, 0.234375),
  float4(1.000000, 0.239216, 0.760784, 0.238281),
  float4(1.000000, 0.243137, 0.756863, 0.242188),
  float4(1.000000, 0.247059, 0.752941, 0.246094),
  float4(1.000000, 0.250980, 0.749020, 0.250000),
  float4(1.000000, 0.254902, 0.745098, 0.253906),
  float4(1.000000, 0.258824, 0.741176, 0.257812),
  float4(1.000000, 0.262745, 0.737255, 0.261719),
  float4(1.000000, 0.266667, 0.733333, 0.265625),
  float4(1.000000, 0.270588, 0.729412, 0.269531),
  float4(1.000000, 0.274510, 0.725490, 0.273438),
  float4(1.000000, 0.278431, 0.721569, 0.277344),
  float4(1.000000, 0.282353, 0.717647, 0.281250),
  float4(1.000000, 0.286275, 0.713725, 0.285156),
  float4(1.000000, 0.290196, 0.709804, 0.289062),
  float4(1.000000, 0.294118, 0.705882, 0.292969),
  float4(1.000000, 0.298039, 0.701961, 0.296875),
  float4(1.000000, 0.301961, 0.698039, 0.300781),
  float4(1.000000, 0.305882, 0.694118, 0.304688),
  float4(1.000000, 0.309804, 0.690196, 0.308594),
  float4(1.000000, 0.313725, 0.686275, 0.312500),
  float4(1.000000, 0.317647, 0.682353, 0.316406),
  float4(1.000000, 0.321569, 0.678431, 0.320312),
  float4(1.000000, 0.325490, 0.674510, 0.324219),
  float4(1.000000, 0.329412, 0.670588, 0.328125),
  float4(1.000000, 0.333333, 0.666667, 0.332031),
  float4(1.000000, 0.337255, 0.662745, 0.335938),
  float4(1.000000, 0.341176, 0.658824, 0.339844),
  float4(1.000000, 0.345098, 0.654902, 0.343750),
  float4(1.000000, 0.349020, 0.650980, 0.347656),
  float4(1.000000, 0.352941, 0.647059, 0.351562),
  float4(1.000000, 0.356863, 0.643137, 0.355469),
  float4(1.000000, 0.360784, 0.639216, 0.359375),
  float4(1.000000, 0.364706, 0.635294, 0.363281),
  float4(1.000000, 0.368627, 0.631373, 0.367188),
  float4(1.000000, 0.372549, 0.627451, 0.371094),
  float4(1.000000, 0.376471, 0.623529, 0.375000),
  float4(1.000000, 0.380392, 0.619608, 0.378906),
  float4(1.000000, 0.384314, 0.615686, 0.382812),
  float4(1.000000, 0.388235, 0.611765, 0.386719),
  float4(1.000000, 0.392157, 0.607843, 0.390625),
  float4(1.000000, 0.396078, 0.603922, 0.394531),
  float4(1.000000, 0.400000, 0.600000, 0.398438),
  float4(1.000000, 0.403922, 0.596078, 0.402344),
  float4(1.000000, 0.407843, 0.592157, 0.406250),
  float4(1.000000, 0.411765, 0.588235, 0.410156),
  float4(1.000000, 0.415686, 0.584314, 0.414062),
  float4(1.000000, 0.419608, 0.580392, 0.417969),
  float4(1.000000, 0.423529, 0.576471, 0.421875),
  float4(1.000000, 0.427451, 0.572549, 0.425781),
  float4(1.000000, 0.431373, 0.568627, 0.429688),
  float4(1.000000, 0.435294, 0.564706, 0.433594),
  float4(1.000000, 0.439216, 0.560784, 0.437500),
  float4(1.000000, 0.443137, 0.556863, 0.441406),
  float4(1.000000, 0.447059, 0.552941, 0.445312),
  float4(1.000000, 0.450980, 0.549020, 0.449219),
  float4(1.000000, 0.454902, 0.545098, 0.453125),
  float4(1.000000, 0.458824, 0.541176, 0.457031),
  float4(1.000000, 0.462745, 0.537255, 0.460938),
  float4(1.000000, 0.466667, 0.533333, 0.464844),
  float4(1.000000, 0.470588, 0.529412, 0.468750),
  float4(1.000000, 0.474510, 0.525490, 0.472656),
  float4(1.000000, 0.478431, 0.521569, 0.476562),
  float4(1.000000, 0.482353, 0.517647, 0.480469),
  float4(1.000000, 0.486275, 0.513725, 0.484375),
  float4(1.000000, 0.490196, 0.509804, 0.488281),
  float4(1.000000, 0.494118, 0.505882, 0.492188),
  float4(1.000000, 0.498039, 0.501961, 0.496094),
  float4(1.000000, 0.501961, 0.498039, 0.500000),
  float4(1.000000, 0.505882, 0.494118, 0.503906),
  float4(1.000000, 0.509804, 0.490196, 0.507812),
  float4(1.000000, 0.513725, 0.486275, 0.511719),
  float4(1.000000, 0.517647, 0.482353, 0.515625),
  float4(1.000000, 0.521569, 0.478431, 0.519531),
  float4(1.000000, 0.525490, 0.474510, 0.523438),
  float4(1.000000, 0.529412, 0.470588, 0.527344),
  float4(1.000000, 0.533333, 0.466667, 0.531250),
  float4(1.000000, 0.537255, 0.462745, 0.535156),
  float4(1.000000, 0.541176, 0.458824, 0.539062),
  float4(1.000000, 0.545098, 0.454902, 0.542969),
  float4(1.000000, 0.549020, 0.450980, 0.546875),
  float4(1.000000, 0.552941, 0.447059, 0.550781),
  float4(1.000000, 0.556863, 0.443137, 0.554688),
  float4(1.000000, 0.560784, 0.439216, 0.558594),
  float4(1.000000, 0.564706, 0.435294, 0.562500),
  float4(1.000000, 0.568627, 0.431373, 0.566406),
  float4(1.000000, 0.572549, 0.427451, 0.570312),
  float4(1.000000, 0.576471, 0.423529, 0.574219),
  float4(1.000000, 0.580392, 0.419608, 0.578125),
  float4(1.000000, 0.584314, 0.415686, 0.582031),
  float4(1.000000, 0.588235, 0.411765, 0.585938),
  float4(1.000000, 0.592157, 0.407843, 0.589844),
  float4(1.000000, 0.596078, 0.403922, 0.593750),
  float4(1.000000, 0.600000, 0.400000, 0.597656),
  float4(1.000000, 0.603922, 0.396078, 0.601562),
  float4(1.000000, 0.607843, 0.392157, 0.605469),
  float4(1.000000, 0.611765, 0.388235, 0.609375),
  float4(1.000000, 0.615686, 0.384314, 0.613281),
  float4(1.000000, 0.619608, 0.380392, 0.617188),
  float4(1.000000, 0.623529, 0.376471, 0.621094),
  float4(1.000000, 0.627451, 0.372549, 0.625000),
  float4(1.000000, 0.631373, 0.368627, 0.628906),
  float4(1.000000, 0.635294, 0.364706, 0.632812),
  float4(1.000000, 0.639216, 0.360784, 0.636719),
  float4(1.000000, 0.643137, 0.356863, 0.640625),
  float4(1.000000, 0.647059, 0.352941, 0.644531),
  float4(1.000000, 0.650980, 0.349020, 0.648438),
  float4(1.000000, 0.654902, 0.345098, 0.652344),
  float4(1.000000, 0.658824, 0.341176, 0.656250),
  float4(1.000000, 0.662745, 0.337255, 0.660156),
  float4(1.000000, 0.666667, 0.333333, 0.664062),
  float4(1.000000, 0.670588, 0.329412, 0.667969),
  float4(1.000000, 0.674510, 0.325490, 0.671875),
  float4(1.000000, 0.678431, 0.321569, 0.675781),
  float4(1.000000, 0.682353, 0.317647, 0.679688),
  float4(1.000000, 0.686275, 0.313725, 0.683594),
  float4(1.000000, 0.690196, 0.309804, 0.687500),
  float4(1.000000, 0.694118, 0.305882, 0.691406),
  float4(1.000000, 0.698039, 0.301961, 0.695312),
  float4(1.000000, 0.701961, 0.298039, 0.699219),
  float4(1.000000, 0.705882, 0.294118, 0.703125),
  float4(1.000000, 0.709804, 0.290196, 0.707031),
  float4(1.000000, 0.713725, 0.286275, 0.710938),
  float4(1.000000, 0.717647, 0.282353, 0.714844),
  float4(1.000000, 0.721569, 0.278431, 0.718750),
  float4(1.000000, 0.725490, 0.274510, 0.722656),
  float4(1.000000, 0.729412, 0.270588, 0.726562),
  float4(1.000000, 0.733333, 0.266667, 0.730469),
  float4(1.000000, 0.737255, 0.262745, 0.734375),
  float4(1.000000, 0.741176, 0.258824, 0.738281),
  float4(1.000000, 0.745098, 0.254902, 0.742188),
  float4(1.000000, 0.749020, 0.250980, 0.746094),
  float4(1.000000, 0.752941, 0.247059, 0.750000),
  float4(1.000000, 0.756863, 0.243137, 0.753906),
  float4(1.000000, 0.760784, 0.239216, 0.757812),
  float4(1.000000, 0.764706, 0.235294, 0.761719),
  float4(1.000000, 0.768627, 0.231373, 0.765625),
  float4(1.000000, 0.772549, 0.227451, 0.769531),
  float4(1.000000, 0.776471, 0.223529, 0.773438),
  float4(1.000000, 0.780392, 0.219608, 0.777344),
  float4(1.000000, 0.784314, 0.215686, 0.781250),
  float4(1.000000, 0.788235, 0.211765, 0.785156),
  float4(1.000000, 0.792157, 0.207843, 0.789062),
  float4(1.000000, 0.796078, 0.203922, 0.792969),
  float4(1.000000, 0.800000, 0.200000, 0.796875),
  float4(1.000000, 0.803922, 0.196078, 0.800781),
  float4(1.000000, 0.807843, 0.192157, 0.804688),
  float4(1.000000, 0.811765, 0.188235, 0.808594),
  float4(1.000000, 0.815686, 0.184314, 0.812500),
  float4(1.000000, 0.819608, 0.180392, 0.816406),
  float4(1.000000, 0.823529, 0.176471, 0.820312),
  float4(1.000000, 0.827451, 0.172549, 0.824219),
  float4(1.000000, 0.831373, 0.168627, 0.828125),
  float4(1.000000, 0.835294, 0.164706, 0.832031),
  float4(1.000000, 0.839216, 0.160784, 0.835938),
  float4(1.000000, 0.843137, 0.156863, 0.839844),
  float4(1.000000, 0.847059, 0.152941, 0.843750),
  float4(1.000000, 0.850980, 0.149020, 0.847656),
  float4(1.000000, 0.854902, 0.145098, 0.851562),
  float4(1.000000, 0.858824, 0.141176, 0.855469),
  float4(1.000000, 0.862745, 0.137255, 0.859375),
  float4(1.000000, 0.866667, 0.133333, 0.863281),
  float4(1.000000, 0.870588, 0.129412, 0.867188),
  float4(1.000000, 0.874510, 0.125490, 0.871094),
  float4(1.000000, 0.878431, 0.121569, 0.875000),
  float4(1.000000, 0.882353, 0.117647, 0.878906),
  float4(1.000000, 0.886275, 0.113725, 0.882812),
  float4(1.000000, 0.890196, 0.109804, 0.886719),
  float4(1.000000, 0.894118, 0.105882, 0.890625),
  float4(1.000000, 0.898039, 0.101961, 0.894531),
  float4(1.000000, 0.901961, 0.098039, 0.898438),
  float4(1.000000, 0.905882, 0.094118, 0.902344),
  float4(1.000000, 0.909804, 0.090196, 0.906250),
  float4(1.000000, 0.913725, 0.086275, 0.910156),
  float4(1.000000, 0.917647, 0.082353, 0.914062),
  float4(1.000000, 0.921569, 0.078431, 0.917969),
  float4(1.000000, 0.925490, 0.074510, 0.921875),
  float4(1.000000, 0.929412, 0.070588, 0.925781),
  float4(1.000000, 0.933333, 0.066667, 0.929688),
  float4(1.000000, 0.937255, 0.062745, 0.933594),
  float4(1.000000, 0.941176, 0.058824, 0.937500),
  float4(1.000000, 0.945098, 0.054902, 0.941406),
  float4(1.000000, 0.949020, 0.050980, 0.945312),
  float4(1.000000, 0.952941, 0.047059, 0.949219),
  float4(1.000000, 0.956863, 0.043137, 0.953125),
  float4(1.000000, 0.960784, 0.039216, 0.957031),
  float4(1.000000, 0.964706, 0.035294, 0.960938),
  float4(1.000000, 0.968627, 0.031373, 0.964844),
  float4(1.000000, 0.972549, 0.027451, 0.968750),
  float4(1.000000, 0.976471, 0.023529, 0.972656),
  float4(1.000000, 0.980392, 0.019608, 0.976562),
  float4(1.000000, 0.984314, 0.015686, 0.980469),
  float4(1.000000, 0.988235, 0.011765, 0.984375),
  float4(1.000000, 0.992157, 0.007843, 0.988281),
  float4(1.000000, 0.996078, 0.003922, 0.992188),
  float4(1.000000, 1.000000, 0.000000, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::SummerTransferFunction
{
  float4(0.000000, 0.500000, 0.400000, 0.000000),
  float4(0.003922, 0.501961, 0.400000, 0.003906),
  float4(0.007843, 0.503922, 0.400000, 0.007812),
  float4(0.011765, 0.505882, 0.400000, 0.011719),
  float4(0.015686, 0.507843, 0.400000, 0.015625),
  float4(0.019608, 0.509804, 0.400000, 0.019531),
  float4(0.023529, 0.511765, 0.400000, 0.023438),
  float4(0.027451, 0.513725, 0.400000, 0.027344),
  float4(0.031373, 0.515686, 0.400000, 0.031250),
  float4(0.035294, 0.517647, 0.400000, 0.035156),
  float4(0.039216, 0.519608, 0.400000, 0.039062),
  float4(0.043137, 0.521569, 0.400000, 0.042969),
  float4(0.047059, 0.523529, 0.400000, 0.046875),
  float4(0.050980, 0.525490, 0.400000, 0.050781),
  float4(0.054902, 0.527451, 0.400000, 0.054688),
  float4(0.058824, 0.529412, 0.400000, 0.058594),
  float4(0.062745, 0.531373, 0.400000, 0.062500),
  float4(0.066667, 0.533333, 0.400000, 0.066406),
  float4(0.070588, 0.535294, 0.400000, 0.070312),
  float4(0.074510, 0.537255, 0.400000, 0.074219),
  float4(0.078431, 0.539216, 0.400000, 0.078125),
  float4(0.082353, 0.541176, 0.400000, 0.082031),
  float4(0.086275, 0.543137, 0.400000, 0.085938),
  float4(0.090196, 0.545098, 0.400000, 0.089844),
  float4(0.094118, 0.547059, 0.400000, 0.093750),
  float4(0.098039, 0.549020, 0.400000, 0.097656),
  float4(0.101961, 0.550980, 0.400000, 0.101562),
  float4(0.105882, 0.552941, 0.400000, 0.105469),
  float4(0.109804, 0.554902, 0.400000, 0.109375),
  float4(0.113725, 0.556863, 0.400000, 0.113281),
  float4(0.117647, 0.558824, 0.400000, 0.117188),
  float4(0.121569, 0.560784, 0.400000, 0.121094),
  float4(0.125490, 0.562745, 0.400000, 0.125000),
  float4(0.129412, 0.564706, 0.400000, 0.128906),
  float4(0.133333, 0.566667, 0.400000, 0.132812),
  float4(0.137255, 0.568627, 0.400000, 0.136719),
  float4(0.141176, 0.570588, 0.400000, 0.140625),
  float4(0.145098, 0.572549, 0.400000, 0.144531),
  float4(0.149020, 0.574510, 0.400000, 0.148438),
  float4(0.152941, 0.576471, 0.400000, 0.152344),
  float4(0.156863, 0.578431, 0.400000, 0.156250),
  float4(0.160784, 0.580392, 0.400000, 0.160156),
  float4(0.164706, 0.582353, 0.400000, 0.164062),
  float4(0.168627, 0.584314, 0.400000, 0.167969),
  float4(0.172549, 0.586275, 0.400000, 0.171875),
  float4(0.176471, 0.588235, 0.400000, 0.175781),
  float4(0.180392, 0.590196, 0.400000, 0.179688),
  float4(0.184314, 0.592157, 0.400000, 0.183594),
  float4(0.188235, 0.594118, 0.400000, 0.187500),
  float4(0.192157, 0.596078, 0.400000, 0.191406),
  float4(0.196078, 0.598039, 0.400000, 0.195312),
  float4(0.200000, 0.600000, 0.400000, 0.199219),
  float4(0.203922, 0.601961, 0.400000, 0.203125),
  float4(0.207843, 0.603922, 0.400000, 0.207031),
  float4(0.211765, 0.605882, 0.400000, 0.210938),
  float4(0.215686, 0.607843, 0.400000, 0.214844),
  float4(0.219608, 0.609804, 0.400000, 0.218750),
  float4(0.223529, 0.611765, 0.400000, 0.222656),
  float4(0.227451, 0.613725, 0.400000, 0.226562),
  float4(0.231373, 0.615686, 0.400000, 0.230469),
  float4(0.235294, 0.617647, 0.400000, 0.234375),
  float4(0.239216, 0.619608, 0.400000, 0.238281),
  float4(0.243137, 0.621569, 0.400000, 0.242188),
  float4(0.247059, 0.623529, 0.400000, 0.246094),
  float4(0.250980, 0.625490, 0.400000, 0.250000),
  float4(0.254902, 0.627451, 0.400000, 0.253906),
  float4(0.258824, 0.629412, 0.400000, 0.257812),
  float4(0.262745, 0.631373, 0.400000, 0.261719),
  float4(0.266667, 0.633333, 0.400000, 0.265625),
  float4(0.270588, 0.635294, 0.400000, 0.269531),
  float4(0.274510, 0.637255, 0.400000, 0.273438),
  float4(0.278431, 0.639216, 0.400000, 0.277344),
  float4(0.282353, 0.641176, 0.400000, 0.281250),
  float4(0.286275, 0.643137, 0.400000, 0.285156),
  float4(0.290196, 0.645098, 0.400000, 0.289062),
  float4(0.294118, 0.647059, 0.400000, 0.292969),
  float4(0.298039, 0.649020, 0.400000, 0.296875),
  float4(0.301961, 0.650980, 0.400000, 0.300781),
  float4(0.305882, 0.652941, 0.400000, 0.304688),
  float4(0.309804, 0.654902, 0.400000, 0.308594),
  float4(0.313725, 0.656863, 0.400000, 0.312500),
  float4(0.317647, 0.658824, 0.400000, 0.316406),
  float4(0.321569, 0.660784, 0.400000, 0.320312),
  float4(0.325490, 0.662745, 0.400000, 0.324219),
  float4(0.329412, 0.664706, 0.400000, 0.328125),
  float4(0.333333, 0.666667, 0.400000, 0.332031),
  float4(0.337255, 0.668627, 0.400000, 0.335938),
  float4(0.341176, 0.670588, 0.400000, 0.339844),
  float4(0.345098, 0.672549, 0.400000, 0.343750),
  float4(0.349020, 0.674510, 0.400000, 0.347656),
  float4(0.352941, 0.676471, 0.400000, 0.351562),
  float4(0.356863, 0.678431, 0.400000, 0.355469),
  float4(0.360784, 0.680392, 0.400000, 0.359375),
  float4(0.364706, 0.682353, 0.400000, 0.363281),
  float4(0.368627, 0.684314, 0.400000, 0.367188),
  float4(0.372549, 0.686275, 0.400000, 0.371094),
  float4(0.376471, 0.688235, 0.400000, 0.375000),
  float4(0.380392, 0.690196, 0.400000, 0.378906),
  float4(0.384314, 0.692157, 0.400000, 0.382812),
  float4(0.388235, 0.694118, 0.400000, 0.386719),
  float4(0.392157, 0.696078, 0.400000, 0.390625),
  float4(0.396078, 0.698039, 0.400000, 0.394531),
  float4(0.400000, 0.700000, 0.400000, 0.398438),
  float4(0.403922, 0.701961, 0.400000, 0.402344),
  float4(0.407843, 0.703922, 0.400000, 0.406250),
  float4(0.411765, 0.705882, 0.400000, 0.410156),
  float4(0.415686, 0.707843, 0.400000, 0.414062),
  float4(0.419608, 0.709804, 0.400000, 0.417969),
  float4(0.423529, 0.711765, 0.400000, 0.421875),
  float4(0.427451, 0.713725, 0.400000, 0.425781),
  float4(0.431373, 0.715686, 0.400000, 0.429688),
  float4(0.435294, 0.717647, 0.400000, 0.433594),
  float4(0.439216, 0.719608, 0.400000, 0.437500),
  float4(0.443137, 0.721569, 0.400000, 0.441406),
  float4(0.447059, 0.723529, 0.400000, 0.445312),
  float4(0.450980, 0.725490, 0.400000, 0.449219),
  float4(0.454902, 0.727451, 0.400000, 0.453125),
  float4(0.458824, 0.729412, 0.400000, 0.457031),
  float4(0.462745, 0.731373, 0.400000, 0.460938),
  float4(0.466667, 0.733333, 0.400000, 0.464844),
  float4(0.470588, 0.735294, 0.400000, 0.468750),
  float4(0.474510, 0.737255, 0.400000, 0.472656),
  float4(0.478431, 0.739216, 0.400000, 0.476562),
  float4(0.482353, 0.741176, 0.400000, 0.480469),
  float4(0.486275, 0.743137, 0.400000, 0.484375),
  float4(0.490196, 0.745098, 0.400000, 0.488281),
  float4(0.494118, 0.747059, 0.400000, 0.492188),
  float4(0.498039, 0.749020, 0.400000, 0.496094),
  float4(0.501961, 0.750980, 0.400000, 0.500000),
  float4(0.505882, 0.752941, 0.400000, 0.503906),
  float4(0.509804, 0.754902, 0.400000, 0.507812),
  float4(0.513725, 0.756863, 0.400000, 0.511719),
  float4(0.517647, 0.758824, 0.400000, 0.515625),
  float4(0.521569, 0.760784, 0.400000, 0.519531),
  float4(0.525490, 0.762745, 0.400000, 0.523438),
  float4(0.529412, 0.764706, 0.400000, 0.527344),
  float4(0.533333, 0.766667, 0.400000, 0.531250),
  float4(0.537255, 0.768627, 0.400000, 0.535156),
  float4(0.541176, 0.770588, 0.400000, 0.539062),
  float4(0.545098, 0.772549, 0.400000, 0.542969),
  float4(0.549020, 0.774510, 0.400000, 0.546875),
  float4(0.552941, 0.776471, 0.400000, 0.550781),
  float4(0.556863, 0.778431, 0.400000, 0.554688),
  float4(0.560784, 0.780392, 0.400000, 0.558594),
  float4(0.564706, 0.782353, 0.400000, 0.562500),
  float4(0.568627, 0.784314, 0.400000, 0.566406),
  float4(0.572549, 0.786275, 0.400000, 0.570312),
  float4(0.576471, 0.788235, 0.400000, 0.574219),
  float4(0.580392, 0.790196, 0.400000, 0.578125),
  float4(0.584314, 0.792157, 0.400000, 0.582031),
  float4(0.588235, 0.794118, 0.400000, 0.585938),
  float4(0.592157, 0.796078, 0.400000, 0.589844),
  float4(0.596078, 0.798039, 0.400000, 0.593750),
  float4(0.600000, 0.800000, 0.400000, 0.597656),
  float4(0.603922, 0.801961, 0.400000, 0.601562),
  float4(0.607843, 0.803922, 0.400000, 0.605469),
  float4(0.611765, 0.805882, 0.400000, 0.609375),
  float4(0.615686, 0.807843, 0.400000, 0.613281),
  float4(0.619608, 0.809804, 0.400000, 0.617188),
  float4(0.623529, 0.811765, 0.400000, 0.621094),
  float4(0.627451, 0.813725, 0.400000, 0.625000),
  float4(0.631373, 0.815686, 0.400000, 0.628906),
  float4(0.635294, 0.817647, 0.400000, 0.632812),
  float4(0.639216, 0.819608, 0.400000, 0.636719),
  float4(0.643137, 0.821569, 0.400000, 0.640625),
  float4(0.647059, 0.823529, 0.400000, 0.644531),
  float4(0.650980, 0.825490, 0.400000, 0.648438),
  float4(0.654902, 0.827451, 0.400000, 0.652344),
  float4(0.658824, 0.829412, 0.400000, 0.656250),
  float4(0.662745, 0.831373, 0.400000, 0.660156),
  float4(0.666667, 0.833333, 0.400000, 0.664062),
  float4(0.670588, 0.835294, 0.400000, 0.667969),
  float4(0.674510, 0.837255, 0.400000, 0.671875),
  float4(0.678431, 0.839216, 0.400000, 0.675781),
  float4(0.682353, 0.841176, 0.400000, 0.679688),
  float4(0.686275, 0.843137, 0.400000, 0.683594),
  float4(0.690196, 0.845098, 0.400000, 0.687500),
  float4(0.694118, 0.847059, 0.400000, 0.691406),
  float4(0.698039, 0.849020, 0.400000, 0.695312),
  float4(0.701961, 0.850980, 0.400000, 0.699219),
  float4(0.705882, 0.852941, 0.400000, 0.703125),
  float4(0.709804, 0.854902, 0.400000, 0.707031),
  float4(0.713725, 0.856863, 0.400000, 0.710938),
  float4(0.717647, 0.858824, 0.400000, 0.714844),
  float4(0.721569, 0.860784, 0.400000, 0.718750),
  float4(0.725490, 0.862745, 0.400000, 0.722656),
  float4(0.729412, 0.864706, 0.400000, 0.726562),
  float4(0.733333, 0.866667, 0.400000, 0.730469),
  float4(0.737255, 0.868627, 0.400000, 0.734375),
  float4(0.741176, 0.870588, 0.400000, 0.738281),
  float4(0.745098, 0.872549, 0.400000, 0.742188),
  float4(0.749020, 0.874510, 0.400000, 0.746094),
  float4(0.752941, 0.876471, 0.400000, 0.750000),
  float4(0.756863, 0.878431, 0.400000, 0.753906),
  float4(0.760784, 0.880392, 0.400000, 0.757812),
  float4(0.764706, 0.882353, 0.400000, 0.761719),
  float4(0.768627, 0.884314, 0.400000, 0.765625),
  float4(0.772549, 0.886275, 0.400000, 0.769531),
  float4(0.776471, 0.888235, 0.400000, 0.773438),
  float4(0.780392, 0.890196, 0.400000, 0.777344),
  float4(0.784314, 0.892157, 0.400000, 0.781250),
  float4(0.788235, 0.894118, 0.400000, 0.785156),
  float4(0.792157, 0.896078, 0.400000, 0.789062),
  float4(0.796078, 0.898039, 0.400000, 0.792969),
  float4(0.800000, 0.900000, 0.400000, 0.796875),
  float4(0.803922, 0.901961, 0.400000, 0.800781),
  float4(0.807843, 0.903922, 0.400000, 0.804688),
  float4(0.811765, 0.905882, 0.400000, 0.808594),
  float4(0.815686, 0.907843, 0.400000, 0.812500),
  float4(0.819608, 0.909804, 0.400000, 0.816406),
  float4(0.823529, 0.911765, 0.400000, 0.820312),
  float4(0.827451, 0.913725, 0.400000, 0.824219),
  float4(0.831373, 0.915686, 0.400000, 0.828125),
  float4(0.835294, 0.917647, 0.400000, 0.832031),
  float4(0.839216, 0.919608, 0.400000, 0.835938),
  float4(0.843137, 0.921569, 0.400000, 0.839844),
  float4(0.847059, 0.923529, 0.400000, 0.843750),
  float4(0.850980, 0.925490, 0.400000, 0.847656),
  float4(0.854902, 0.927451, 0.400000, 0.851562),
  float4(0.858824, 0.929412, 0.400000, 0.855469),
  float4(0.862745, 0.931373, 0.400000, 0.859375),
  float4(0.866667, 0.933333, 0.400000, 0.863281),
  float4(0.870588, 0.935294, 0.400000, 0.867188),
  float4(0.874510, 0.937255, 0.400000, 0.871094),
  float4(0.878431, 0.939216, 0.400000, 0.875000),
  float4(0.882353, 0.941176, 0.400000, 0.878906),
  float4(0.886275, 0.943137, 0.400000, 0.882812),
  float4(0.890196, 0.945098, 0.400000, 0.886719),
  float4(0.894118, 0.947059, 0.400000, 0.890625),
  float4(0.898039, 0.949020, 0.400000, 0.894531),
  float4(0.901961, 0.950980, 0.400000, 0.898438),
  float4(0.905882, 0.952941, 0.400000, 0.902344),
  float4(0.909804, 0.954902, 0.400000, 0.906250),
  float4(0.913725, 0.956863, 0.400000, 0.910156),
  float4(0.917647, 0.958824, 0.400000, 0.914062),
  float4(0.921569, 0.960784, 0.400000, 0.917969),
  float4(0.925490, 0.962745, 0.400000, 0.921875),
  float4(0.929412, 0.964706, 0.400000, 0.925781),
  float4(0.933333, 0.966667, 0.400000, 0.929688),
  float4(0.937255, 0.968627, 0.400000, 0.933594),
  float4(0.941176, 0.970588, 0.400000, 0.937500),
  float4(0.945098, 0.972549, 0.400000, 0.941406),
  float4(0.949020, 0.974510, 0.400000, 0.945312),
  float4(0.952941, 0.976471, 0.400000, 0.949219),
  float4(0.956863, 0.978431, 0.400000, 0.953125),
  float4(0.960784, 0.980392, 0.400000, 0.957031),
  float4(0.964706, 0.982353, 0.400000, 0.960938),
  float4(0.968627, 0.984314, 0.400000, 0.964844),
  float4(0.972549, 0.986275, 0.400000, 0.968750),
  float4(0.976471, 0.988235, 0.400000, 0.972656),
  float4(0.980392, 0.990196, 0.400000, 0.976562),
  float4(0.984314, 0.992157, 0.400000, 0.980469),
  float4(0.988235, 0.994118, 0.400000, 0.984375),
  float4(0.992157, 0.996078, 0.400000, 0.988281),
  float4(0.996078, 0.998039, 0.400000, 0.992188),
  float4(1.000000, 1.000000, 0.400000, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::AutumnTransferFunction
{
  float4(1.000000, 0.000000, 0.000000, 0.000000),
  float4(1.000000, 0.003922, 0.000000, 0.003906),
  float4(1.000000, 0.007843, 0.000000, 0.007812),
  float4(1.000000, 0.011765, 0.000000, 0.011719),
  float4(1.000000, 0.015686, 0.000000, 0.015625),
  float4(1.000000, 0.019608, 0.000000, 0.019531),
  float4(1.000000, 0.023529, 0.000000, 0.023438),
  float4(1.000000, 0.027451, 0.000000, 0.027344),
  float4(1.000000, 0.031373, 0.000000, 0.031250),
  float4(1.000000, 0.035294, 0.000000, 0.035156),
  float4(1.000000, 0.039216, 0.000000, 0.039062),
  float4(1.000000, 0.043137, 0.000000, 0.042969),
  float4(1.000000, 0.047059, 0.000000, 0.046875),
  float4(1.000000, 0.050980, 0.000000, 0.050781),
  float4(1.000000, 0.054902, 0.000000, 0.054688),
  float4(1.000000, 0.058824, 0.000000, 0.058594),
  float4(1.000000, 0.062745, 0.000000, 0.062500),
  float4(1.000000, 0.066667, 0.000000, 0.066406),
  float4(1.000000, 0.070588, 0.000000, 0.070312),
  float4(1.000000, 0.074510, 0.000000, 0.074219),
  float4(1.000000, 0.078431, 0.000000, 0.078125),
  float4(1.000000, 0.082353, 0.000000, 0.082031),
  float4(1.000000, 0.086275, 0.000000, 0.085938),
  float4(1.000000, 0.090196, 0.000000, 0.089844),
  float4(1.000000, 0.094118, 0.000000, 0.093750),
  float4(1.000000, 0.098039, 0.000000, 0.097656),
  float4(1.000000, 0.101961, 0.000000, 0.101562),
  float4(1.000000, 0.105882, 0.000000, 0.105469),
  float4(1.000000, 0.109804, 0.000000, 0.109375),
  float4(1.000000, 0.113725, 0.000000, 0.113281),
  float4(1.000000, 0.117647, 0.000000, 0.117188),
  float4(1.000000, 0.121569, 0.000000, 0.121094),
  float4(1.000000, 0.125490, 0.000000, 0.125000),
  float4(1.000000, 0.129412, 0.000000, 0.128906),
  float4(1.000000, 0.133333, 0.000000, 0.132812),
  float4(1.000000, 0.137255, 0.000000, 0.136719),
  float4(1.000000, 0.141176, 0.000000, 0.140625),
  float4(1.000000, 0.145098, 0.000000, 0.144531),
  float4(1.000000, 0.149020, 0.000000, 0.148438),
  float4(1.000000, 0.152941, 0.000000, 0.152344),
  float4(1.000000, 0.156863, 0.000000, 0.156250),
  float4(1.000000, 0.160784, 0.000000, 0.160156),
  float4(1.000000, 0.164706, 0.000000, 0.164062),
  float4(1.000000, 0.168627, 0.000000, 0.167969),
  float4(1.000000, 0.172549, 0.000000, 0.171875),
  float4(1.000000, 0.176471, 0.000000, 0.175781),
  float4(1.000000, 0.180392, 0.000000, 0.179688),
  float4(1.000000, 0.184314, 0.000000, 0.183594),
  float4(1.000000, 0.188235, 0.000000, 0.187500),
  float4(1.000000, 0.192157, 0.000000, 0.191406),
  float4(1.000000, 0.196078, 0.000000, 0.195312),
  float4(1.000000, 0.200000, 0.000000, 0.199219),
  float4(1.000000, 0.203922, 0.000000, 0.203125),
  float4(1.000000, 0.207843, 0.000000, 0.207031),
  float4(1.000000, 0.211765, 0.000000, 0.210938),
  float4(1.000000, 0.215686, 0.000000, 0.214844),
  float4(1.000000, 0.219608, 0.000000, 0.218750),
  float4(1.000000, 0.223529, 0.000000, 0.222656),
  float4(1.000000, 0.227451, 0.000000, 0.226562),
  float4(1.000000, 0.231373, 0.000000, 0.230469),
  float4(1.000000, 0.235294, 0.000000, 0.234375),
  float4(1.000000, 0.239216, 0.000000, 0.238281),
  float4(1.000000, 0.243137, 0.000000, 0.242188),
  float4(1.000000, 0.247059, 0.000000, 0.246094),
  float4(1.000000, 0.250980, 0.000000, 0.250000),
  float4(1.000000, 0.254902, 0.000000, 0.253906),
  float4(1.000000, 0.258824, 0.000000, 0.257812),
  float4(1.000000, 0.262745, 0.000000, 0.261719),
  float4(1.000000, 0.266667, 0.000000, 0.265625),
  float4(1.000000, 0.270588, 0.000000, 0.269531),
  float4(1.000000, 0.274510, 0.000000, 0.273438),
  float4(1.000000, 0.278431, 0.000000, 0.277344),
  float4(1.000000, 0.282353, 0.000000, 0.281250),
  float4(1.000000, 0.286275, 0.000000, 0.285156),
  float4(1.000000, 0.290196, 0.000000, 0.289062),
  float4(1.000000, 0.294118, 0.000000, 0.292969),
  float4(1.000000, 0.298039, 0.000000, 0.296875),
  float4(1.000000, 0.301961, 0.000000, 0.300781),
  float4(1.000000, 0.305882, 0.000000, 0.304688),
  float4(1.000000, 0.309804, 0.000000, 0.308594),
  float4(1.000000, 0.313725, 0.000000, 0.312500),
  float4(1.000000, 0.317647, 0.000000, 0.316406),
  float4(1.000000, 0.321569, 0.000000, 0.320312),
  float4(1.000000, 0.325490, 0.000000, 0.324219),
  float4(1.000000, 0.329412, 0.000000, 0.328125),
  float4(1.000000, 0.333333, 0.000000, 0.332031),
  float4(1.000000, 0.337255, 0.000000, 0.335938),
  float4(1.000000, 0.341176, 0.000000, 0.339844),
  float4(1.000000, 0.345098, 0.000000, 0.343750),
  float4(1.000000, 0.349020, 0.000000, 0.347656),
  float4(1.000000, 0.352941, 0.000000, 0.351562),
  float4(1.000000, 0.356863, 0.000000, 0.355469),
  float4(1.000000, 0.360784, 0.000000, 0.359375),
  float4(1.000000, 0.364706, 0.000000, 0.363281),
  float4(1.000000, 0.368627, 0.000000, 0.367188),
  float4(1.000000, 0.372549, 0.000000, 0.371094),
  float4(1.000000, 0.376471, 0.000000, 0.375000),
  float4(1.000000, 0.380392, 0.000000, 0.378906),
  float4(1.000000, 0.384314, 0.000000, 0.382812),
  float4(1.000000, 0.388235, 0.000000, 0.386719),
  float4(1.000000, 0.392157, 0.000000, 0.390625),
  float4(1.000000, 0.396078, 0.000000, 0.394531),
  float4(1.000000, 0.400000, 0.000000, 0.398438),
  float4(1.000000, 0.403922, 0.000000, 0.402344),
  float4(1.000000, 0.407843, 0.000000, 0.406250),
  float4(1.000000, 0.411765, 0.000000, 0.410156),
  float4(1.000000, 0.415686, 0.000000, 0.414062),
  float4(1.000000, 0.419608, 0.000000, 0.417969),
  float4(1.000000, 0.423529, 0.000000, 0.421875),
  float4(1.000000, 0.427451, 0.000000, 0.425781),
  float4(1.000000, 0.431373, 0.000000, 0.429688),
  float4(1.000000, 0.435294, 0.000000, 0.433594),
  float4(1.000000, 0.439216, 0.000000, 0.437500),
  float4(1.000000, 0.443137, 0.000000, 0.441406),
  float4(1.000000, 0.447059, 0.000000, 0.445312),
  float4(1.000000, 0.450980, 0.000000, 0.449219),
  float4(1.000000, 0.454902, 0.000000, 0.453125),
  float4(1.000000, 0.458824, 0.000000, 0.457031),
  float4(1.000000, 0.462745, 0.000000, 0.460938),
  float4(1.000000, 0.466667, 0.000000, 0.464844),
  float4(1.000000, 0.470588, 0.000000, 0.468750),
  float4(1.000000, 0.474510, 0.000000, 0.472656),
  float4(1.000000, 0.478431, 0.000000, 0.476562),
  float4(1.000000, 0.482353, 0.000000, 0.480469),
  float4(1.000000, 0.486275, 0.000000, 0.484375),
  float4(1.000000, 0.490196, 0.000000, 0.488281),
  float4(1.000000, 0.494118, 0.000000, 0.492188),
  float4(1.000000, 0.498039, 0.000000, 0.496094),
  float4(1.000000, 0.501961, 0.000000, 0.500000),
  float4(1.000000, 0.505882, 0.000000, 0.503906),
  float4(1.000000, 0.509804, 0.000000, 0.507812),
  float4(1.000000, 0.513725, 0.000000, 0.511719),
  float4(1.000000, 0.517647, 0.000000, 0.515625),
  float4(1.000000, 0.521569, 0.000000, 0.519531),
  float4(1.000000, 0.525490, 0.000000, 0.523438),
  float4(1.000000, 0.529412, 0.000000, 0.527344),
  float4(1.000000, 0.533333, 0.000000, 0.531250),
  float4(1.000000, 0.537255, 0.000000, 0.535156),
  float4(1.000000, 0.541176, 0.000000, 0.539062),
  float4(1.000000, 0.545098, 0.000000, 0.542969),
  float4(1.000000, 0.549020, 0.000000, 0.546875),
  float4(1.000000, 0.552941, 0.000000, 0.550781),
  float4(1.000000, 0.556863, 0.000000, 0.554688),
  float4(1.000000, 0.560784, 0.000000, 0.558594),
  float4(1.000000, 0.564706, 0.000000, 0.562500),
  float4(1.000000, 0.568627, 0.000000, 0.566406),
  float4(1.000000, 0.572549, 0.000000, 0.570312),
  float4(1.000000, 0.576471, 0.000000, 0.574219),
  float4(1.000000, 0.580392, 0.000000, 0.578125),
  float4(1.000000, 0.584314, 0.000000, 0.582031),
  float4(1.000000, 0.588235, 0.000000, 0.585938),
  float4(1.000000, 0.592157, 0.000000, 0.589844),
  float4(1.000000, 0.596078, 0.000000, 0.593750),
  float4(1.000000, 0.600000, 0.000000, 0.597656),
  float4(1.000000, 0.603922, 0.000000, 0.601562),
  float4(1.000000, 0.607843, 0.000000, 0.605469),
  float4(1.000000, 0.611765, 0.000000, 0.609375),
  float4(1.000000, 0.615686, 0.000000, 0.613281),
  float4(1.000000, 0.619608, 0.000000, 0.617188),
  float4(1.000000, 0.623529, 0.000000, 0.621094),
  float4(1.000000, 0.627451, 0.000000, 0.625000),
  float4(1.000000, 0.631373, 0.000000, 0.628906),
  float4(1.000000, 0.635294, 0.000000, 0.632812),
  float4(1.000000, 0.639216, 0.000000, 0.636719),
  float4(1.000000, 0.643137, 0.000000, 0.640625),
  float4(1.000000, 0.647059, 0.000000, 0.644531),
  float4(1.000000, 0.650980, 0.000000, 0.648438),
  float4(1.000000, 0.654902, 0.000000, 0.652344),
  float4(1.000000, 0.658824, 0.000000, 0.656250),
  float4(1.000000, 0.662745, 0.000000, 0.660156),
  float4(1.000000, 0.666667, 0.000000, 0.664062),
  float4(1.000000, 0.670588, 0.000000, 0.667969),
  float4(1.000000, 0.674510, 0.000000, 0.671875),
  float4(1.000000, 0.678431, 0.000000, 0.675781),
  float4(1.000000, 0.682353, 0.000000, 0.679688),
  float4(1.000000, 0.686275, 0.000000, 0.683594),
  float4(1.000000, 0.690196, 0.000000, 0.687500),
  float4(1.000000, 0.694118, 0.000000, 0.691406),
  float4(1.000000, 0.698039, 0.000000, 0.695312),
  float4(1.000000, 0.701961, 0.000000, 0.699219),
  float4(1.000000, 0.705882, 0.000000, 0.703125),
  float4(1.000000, 0.709804, 0.000000, 0.707031),
  float4(1.000000, 0.713725, 0.000000, 0.710938),
  float4(1.000000, 0.717647, 0.000000, 0.714844),
  float4(1.000000, 0.721569, 0.000000, 0.718750),
  float4(1.000000, 0.725490, 0.000000, 0.722656),
  float4(1.000000, 0.729412, 0.000000, 0.726562),
  float4(1.000000, 0.733333, 0.000000, 0.730469),
  float4(1.000000, 0.737255, 0.000000, 0.734375),
  float4(1.000000, 0.741176, 0.000000, 0.738281),
  float4(1.000000, 0.745098, 0.000000, 0.742188),
  float4(1.000000, 0.749020, 0.000000, 0.746094),
  float4(1.000000, 0.752941, 0.000000, 0.750000),
  float4(1.000000, 0.756863, 0.000000, 0.753906),
  float4(1.000000, 0.760784, 0.000000, 0.757812),
  float4(1.000000, 0.764706, 0.000000, 0.761719),
  float4(1.000000, 0.768627, 0.000000, 0.765625),
  float4(1.000000, 0.772549, 0.000000, 0.769531),
  float4(1.000000, 0.776471, 0.000000, 0.773438),
  float4(1.000000, 0.780392, 0.000000, 0.777344),
  float4(1.000000, 0.784314, 0.000000, 0.781250),
  float4(1.000000, 0.788235, 0.000000, 0.785156),
  float4(1.000000, 0.792157, 0.000000, 0.789062),
  float4(1.000000, 0.796078, 0.000000, 0.792969),
  float4(1.000000, 0.800000, 0.000000, 0.796875),
  float4(1.000000, 0.803922, 0.000000, 0.800781),
  float4(1.000000, 0.807843, 0.000000, 0.804688),
  float4(1.000000, 0.811765, 0.000000, 0.808594),
  float4(1.000000, 0.815686, 0.000000, 0.812500),
  float4(1.000000, 0.819608, 0.000000, 0.816406),
  float4(1.000000, 0.823529, 0.000000, 0.820312),
  float4(1.000000, 0.827451, 0.000000, 0.824219),
  float4(1.000000, 0.831373, 0.000000, 0.828125),
  float4(1.000000, 0.835294, 0.000000, 0.832031),
  float4(1.000000, 0.839216, 0.000000, 0.835938),
  float4(1.000000, 0.843137, 0.000000, 0.839844),
  float4(1.000000, 0.847059, 0.000000, 0.843750),
  float4(1.000000, 0.850980, 0.000000, 0.847656),
  float4(1.000000, 0.854902, 0.000000, 0.851562),
  float4(1.000000, 0.858824, 0.000000, 0.855469),
  float4(1.000000, 0.862745, 0.000000, 0.859375),
  float4(1.000000, 0.866667, 0.000000, 0.863281),
  float4(1.000000, 0.870588, 0.000000, 0.867188),
  float4(1.000000, 0.874510, 0.000000, 0.871094),
  float4(1.000000, 0.878431, 0.000000, 0.875000),
  float4(1.000000, 0.882353, 0.000000, 0.878906),
  float4(1.000000, 0.886275, 0.000000, 0.882812),
  float4(1.000000, 0.890196, 0.000000, 0.886719),
  float4(1.000000, 0.894118, 0.000000, 0.890625),
  float4(1.000000, 0.898039, 0.000000, 0.894531),
  float4(1.000000, 0.901961, 0.000000, 0.898438),
  float4(1.000000, 0.905882, 0.000000, 0.902344),
  float4(1.000000, 0.909804, 0.000000, 0.906250),
  float4(1.000000, 0.913725, 0.000000, 0.910156),
  float4(1.000000, 0.917647, 0.000000, 0.914062),
  float4(1.000000, 0.921569, 0.000000, 0.917969),
  float4(1.000000, 0.925490, 0.000000, 0.921875),
  float4(1.000000, 0.929412, 0.000000, 0.925781),
  float4(1.000000, 0.933333, 0.000000, 0.929688),
  float4(1.000000, 0.937255, 0.000000, 0.933594),
  float4(1.000000, 0.941176, 0.000000, 0.937500),
  float4(1.000000, 0.945098, 0.000000, 0.941406),
  float4(1.000000, 0.949020, 0.000000, 0.945312),
  float4(1.000000, 0.952941, 0.000000, 0.949219),
  float4(1.000000, 0.956863, 0.000000, 0.953125),
  float4(1.000000, 0.960784, 0.000000, 0.957031),
  float4(1.000000, 0.964706, 0.000000, 0.960938),
  float4(1.000000, 0.968627, 0.000000, 0.964844),
  float4(1.000000, 0.972549, 0.000000, 0.968750),
  float4(1.000000, 0.976471, 0.000000, 0.972656),
  float4(1.000000, 0.980392, 0.000000, 0.976562),
  float4(1.000000, 0.984314, 0.000000, 0.980469),
  float4(1.000000, 0.988235, 0.000000, 0.984375),
  float4(1.000000, 0.992157, 0.000000, 0.988281),
  float4(1.000000, 0.996078, 0.000000, 0.992188),
  float4(1.000000, 1.000000, 0.000000, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::WinterTransferFunction
{
  float4(0.000000, 0.000000, 1.000000, 0.000000),
  float4(0.000000, 0.003922, 0.998039, 0.003906),
  float4(0.000000, 0.007843, 0.996078, 0.007812),
  float4(0.000000, 0.011765, 0.994118, 0.011719),
  float4(0.000000, 0.015686, 0.992157, 0.015625),
  float4(0.000000, 0.019608, 0.990196, 0.019531),
  float4(0.000000, 0.023529, 0.988235, 0.023438),
  float4(0.000000, 0.027451, 0.986275, 0.027344),
  float4(0.000000, 0.031373, 0.984314, 0.031250),
  float4(0.000000, 0.035294, 0.982353, 0.035156),
  float4(0.000000, 0.039216, 0.980392, 0.039062),
  float4(0.000000, 0.043137, 0.978431, 0.042969),
  float4(0.000000, 0.047059, 0.976471, 0.046875),
  float4(0.000000, 0.050980, 0.974510, 0.050781),
  float4(0.000000, 0.054902, 0.972549, 0.054688),
  float4(0.000000, 0.058824, 0.970588, 0.058594),
  float4(0.000000, 0.062745, 0.968627, 0.062500),
  float4(0.000000, 0.066667, 0.966667, 0.066406),
  float4(0.000000, 0.070588, 0.964706, 0.070312),
  float4(0.000000, 0.074510, 0.962745, 0.074219),
  float4(0.000000, 0.078431, 0.960784, 0.078125),
  float4(0.000000, 0.082353, 0.958824, 0.082031),
  float4(0.000000, 0.086275, 0.956863, 0.085938),
  float4(0.000000, 0.090196, 0.954902, 0.089844),
  float4(0.000000, 0.094118, 0.952941, 0.093750),
  float4(0.000000, 0.098039, 0.950980, 0.097656),
  float4(0.000000, 0.101961, 0.949020, 0.101562),
  float4(0.000000, 0.105882, 0.947059, 0.105469),
  float4(0.000000, 0.109804, 0.945098, 0.109375),
  float4(0.000000, 0.113725, 0.943137, 0.113281),
  float4(0.000000, 0.117647, 0.941176, 0.117188),
  float4(0.000000, 0.121569, 0.939216, 0.121094),
  float4(0.000000, 0.125490, 0.937255, 0.125000),
  float4(0.000000, 0.129412, 0.935294, 0.128906),
  float4(0.000000, 0.133333, 0.933333, 0.132812),
  float4(0.000000, 0.137255, 0.931373, 0.136719),
  float4(0.000000, 0.141176, 0.929412, 0.140625),
  float4(0.000000, 0.145098, 0.927451, 0.144531),
  float4(0.000000, 0.149020, 0.925490, 0.148438),
  float4(0.000000, 0.152941, 0.923529, 0.152344),
  float4(0.000000, 0.156863, 0.921569, 0.156250),
  float4(0.000000, 0.160784, 0.919608, 0.160156),
  float4(0.000000, 0.164706, 0.917647, 0.164062),
  float4(0.000000, 0.168627, 0.915686, 0.167969),
  float4(0.000000, 0.172549, 0.913725, 0.171875),
  float4(0.000000, 0.176471, 0.911765, 0.175781),
  float4(0.000000, 0.180392, 0.909804, 0.179688),
  float4(0.000000, 0.184314, 0.907843, 0.183594),
  float4(0.000000, 0.188235, 0.905882, 0.187500),
  float4(0.000000, 0.192157, 0.903922, 0.191406),
  float4(0.000000, 0.196078, 0.901961, 0.195312),
  float4(0.000000, 0.200000, 0.900000, 0.199219),
  float4(0.000000, 0.203922, 0.898039, 0.203125),
  float4(0.000000, 0.207843, 0.896078, 0.207031),
  float4(0.000000, 0.211765, 0.894118, 0.210938),
  float4(0.000000, 0.215686, 0.892157, 0.214844),
  float4(0.000000, 0.219608, 0.890196, 0.218750),
  float4(0.000000, 0.223529, 0.888235, 0.222656),
  float4(0.000000, 0.227451, 0.886275, 0.226562),
  float4(0.000000, 0.231373, 0.884314, 0.230469),
  float4(0.000000, 0.235294, 0.882353, 0.234375),
  float4(0.000000, 0.239216, 0.880392, 0.238281),
  float4(0.000000, 0.243137, 0.878431, 0.242188),
  float4(0.000000, 0.247059, 0.876471, 0.246094),
  float4(0.000000, 0.250980, 0.874510, 0.250000),
  float4(0.000000, 0.254902, 0.872549, 0.253906),
  float4(0.000000, 0.258824, 0.870588, 0.257812),
  float4(0.000000, 0.262745, 0.868627, 0.261719),
  float4(0.000000, 0.266667, 0.866667, 0.265625),
  float4(0.000000, 0.270588, 0.864706, 0.269531),
  float4(0.000000, 0.274510, 0.862745, 0.273438),
  float4(0.000000, 0.278431, 0.860784, 0.277344),
  float4(0.000000, 0.282353, 0.858824, 0.281250),
  float4(0.000000, 0.286275, 0.856863, 0.285156),
  float4(0.000000, 0.290196, 0.854902, 0.289062),
  float4(0.000000, 0.294118, 0.852941, 0.292969),
  float4(0.000000, 0.298039, 0.850980, 0.296875),
  float4(0.000000, 0.301961, 0.849020, 0.300781),
  float4(0.000000, 0.305882, 0.847059, 0.304688),
  float4(0.000000, 0.309804, 0.845098, 0.308594),
  float4(0.000000, 0.313725, 0.843137, 0.312500),
  float4(0.000000, 0.317647, 0.841176, 0.316406),
  float4(0.000000, 0.321569, 0.839216, 0.320312),
  float4(0.000000, 0.325490, 0.837255, 0.324219),
  float4(0.000000, 0.329412, 0.835294, 0.328125),
  float4(0.000000, 0.333333, 0.833333, 0.332031),
  float4(0.000000, 0.337255, 0.831373, 0.335938),
  float4(0.000000, 0.341176, 0.829412, 0.339844),
  float4(0.000000, 0.345098, 0.827451, 0.343750),
  float4(0.000000, 0.349020, 0.825490, 0.347656),
  float4(0.000000, 0.352941, 0.823529, 0.351562),
  float4(0.000000, 0.356863, 0.821569, 0.355469),
  float4(0.000000, 0.360784, 0.819608, 0.359375),
  float4(0.000000, 0.364706, 0.817647, 0.363281),
  float4(0.000000, 0.368627, 0.815686, 0.367188),
  float4(0.000000, 0.372549, 0.813725, 0.371094),
  float4(0.000000, 0.376471, 0.811765, 0.375000),
  float4(0.000000, 0.380392, 0.809804, 0.378906),
  float4(0.000000, 0.384314, 0.807843, 0.382812),
  float4(0.000000, 0.388235, 0.805882, 0.386719),
  float4(0.000000, 0.392157, 0.803922, 0.390625),
  float4(0.000000, 0.396078, 0.801961, 0.394531),
  float4(0.000000, 0.400000, 0.800000, 0.398438),
  float4(0.000000, 0.403922, 0.798039, 0.402344),
  float4(0.000000, 0.407843, 0.796078, 0.406250),
  float4(0.000000, 0.411765, 0.794118, 0.410156),
  float4(0.000000, 0.415686, 0.792157, 0.414062),
  float4(0.000000, 0.419608, 0.790196, 0.417969),
  float4(0.000000, 0.423529, 0.788235, 0.421875),
  float4(0.000000, 0.427451, 0.786275, 0.425781),
  float4(0.000000, 0.431373, 0.784314, 0.429688),
  float4(0.000000, 0.435294, 0.782353, 0.433594),
  float4(0.000000, 0.439216, 0.780392, 0.437500),
  float4(0.000000, 0.443137, 0.778431, 0.441406),
  float4(0.000000, 0.447059, 0.776471, 0.445312),
  float4(0.000000, 0.450980, 0.774510, 0.449219),
  float4(0.000000, 0.454902, 0.772549, 0.453125),
  float4(0.000000, 0.458824, 0.770588, 0.457031),
  float4(0.000000, 0.462745, 0.768627, 0.460938),
  float4(0.000000, 0.466667, 0.766667, 0.464844),
  float4(0.000000, 0.470588, 0.764706, 0.468750),
  float4(0.000000, 0.474510, 0.762745, 0.472656),
  float4(0.000000, 0.478431, 0.760784, 0.476562),
  float4(0.000000, 0.482353, 0.758824, 0.480469),
  float4(0.000000, 0.486275, 0.756863, 0.484375),
  float4(0.000000, 0.490196, 0.754902, 0.488281),
  float4(0.000000, 0.494118, 0.752941, 0.492188),
  float4(0.000000, 0.498039, 0.750980, 0.496094),
  float4(0.000000, 0.501961, 0.749020, 0.500000),
  float4(0.000000, 0.505882, 0.747059, 0.503906),
  float4(0.000000, 0.509804, 0.745098, 0.507812),
  float4(0.000000, 0.513725, 0.743137, 0.511719),
  float4(0.000000, 0.517647, 0.741176, 0.515625),
  float4(0.000000, 0.521569, 0.739216, 0.519531),
  float4(0.000000, 0.525490, 0.737255, 0.523438),
  float4(0.000000, 0.529412, 0.735294, 0.527344),
  float4(0.000000, 0.533333, 0.733333, 0.531250),
  float4(0.000000, 0.537255, 0.731373, 0.535156),
  float4(0.000000, 0.541176, 0.729412, 0.539062),
  float4(0.000000, 0.545098, 0.727451, 0.542969),
  float4(0.000000, 0.549020, 0.725490, 0.546875),
  float4(0.000000, 0.552941, 0.723529, 0.550781),
  float4(0.000000, 0.556863, 0.721569, 0.554688),
  float4(0.000000, 0.560784, 0.719608, 0.558594),
  float4(0.000000, 0.564706, 0.717647, 0.562500),
  float4(0.000000, 0.568627, 0.715686, 0.566406),
  float4(0.000000, 0.572549, 0.713725, 0.570312),
  float4(0.000000, 0.576471, 0.711765, 0.574219),
  float4(0.000000, 0.580392, 0.709804, 0.578125),
  float4(0.000000, 0.584314, 0.707843, 0.582031),
  float4(0.000000, 0.588235, 0.705882, 0.585938),
  float4(0.000000, 0.592157, 0.703922, 0.589844),
  float4(0.000000, 0.596078, 0.701961, 0.593750),
  float4(0.000000, 0.600000, 0.700000, 0.597656),
  float4(0.000000, 0.603922, 0.698039, 0.601562),
  float4(0.000000, 0.607843, 0.696078, 0.605469),
  float4(0.000000, 0.611765, 0.694118, 0.609375),
  float4(0.000000, 0.615686, 0.692157, 0.613281),
  float4(0.000000, 0.619608, 0.690196, 0.617188),
  float4(0.000000, 0.623529, 0.688235, 0.621094),
  float4(0.000000, 0.627451, 0.686275, 0.625000),
  float4(0.000000, 0.631373, 0.684314, 0.628906),
  float4(0.000000, 0.635294, 0.682353, 0.632812),
  float4(0.000000, 0.639216, 0.680392, 0.636719),
  float4(0.000000, 0.643137, 0.678431, 0.640625),
  float4(0.000000, 0.647059, 0.676471, 0.644531),
  float4(0.000000, 0.650980, 0.674510, 0.648438),
  float4(0.000000, 0.654902, 0.672549, 0.652344),
  float4(0.000000, 0.658824, 0.670588, 0.656250),
  float4(0.000000, 0.662745, 0.668627, 0.660156),
  float4(0.000000, 0.666667, 0.666667, 0.664062),
  float4(0.000000, 0.670588, 0.664706, 0.667969),
  float4(0.000000, 0.674510, 0.662745, 0.671875),
  float4(0.000000, 0.678431, 0.660784, 0.675781),
  float4(0.000000, 0.682353, 0.658824, 0.679688),
  float4(0.000000, 0.686275, 0.656863, 0.683594),
  float4(0.000000, 0.690196, 0.654902, 0.687500),
  float4(0.000000, 0.694118, 0.652941, 0.691406),
  float4(0.000000, 0.698039, 0.650980, 0.695312),
  float4(0.000000, 0.701961, 0.649020, 0.699219),
  float4(0.000000, 0.705882, 0.647059, 0.703125),
  float4(0.000000, 0.709804, 0.645098, 0.707031),
  float4(0.000000, 0.713725, 0.643137, 0.710938),
  float4(0.000000, 0.717647, 0.641176, 0.714844),
  float4(0.000000, 0.721569, 0.639216, 0.718750),
  float4(0.000000, 0.725490, 0.637255, 0.722656),
  float4(0.000000, 0.729412, 0.635294, 0.726562),
  float4(0.000000, 0.733333, 0.633333, 0.730469),
  float4(0.000000, 0.737255, 0.631373, 0.734375),
  float4(0.000000, 0.741176, 0.629412, 0.738281),
  float4(0.000000, 0.745098, 0.627451, 0.742188),
  float4(0.000000, 0.749020, 0.625490, 0.746094),
  float4(0.000000, 0.752941, 0.623529, 0.750000),
  float4(0.000000, 0.756863, 0.621569, 0.753906),
  float4(0.000000, 0.760784, 0.619608, 0.757812),
  float4(0.000000, 0.764706, 0.617647, 0.761719),
  float4(0.000000, 0.768627, 0.615686, 0.765625),
  float4(0.000000, 0.772549, 0.613725, 0.769531),
  float4(0.000000, 0.776471, 0.611765, 0.773438),
  float4(0.000000, 0.780392, 0.609804, 0.777344),
  float4(0.000000, 0.784314, 0.607843, 0.781250),
  float4(0.000000, 0.788235, 0.605882, 0.785156),
  float4(0.000000, 0.792157, 0.603922, 0.789062),
  float4(0.000000, 0.796078, 0.601961, 0.792969),
  float4(0.000000, 0.800000, 0.600000, 0.796875),
  float4(0.000000, 0.803922, 0.598039, 0.800781),
  float4(0.000000, 0.807843, 0.596078, 0.804688),
  float4(0.000000, 0.811765, 0.594118, 0.808594),
  float4(0.000000, 0.815686, 0.592157, 0.812500),
  float4(0.000000, 0.819608, 0.590196, 0.816406),
  float4(0.000000, 0.823529, 0.588235, 0.820312),
  float4(0.000000, 0.827451, 0.586275, 0.824219),
  float4(0.000000, 0.831373, 0.584314, 0.828125),
  float4(0.000000, 0.835294, 0.582353, 0.832031),
  float4(0.000000, 0.839216, 0.580392, 0.835938),
  float4(0.000000, 0.843137, 0.578431, 0.839844),
  float4(0.000000, 0.847059, 0.576471, 0.843750),
  float4(0.000000, 0.850980, 0.574510, 0.847656),
  float4(0.000000, 0.854902, 0.572549, 0.851562),
  float4(0.000000, 0.858824, 0.570588, 0.855469),
  float4(0.000000, 0.862745, 0.568627, 0.859375),
  float4(0.000000, 0.866667, 0.566667, 0.863281),
  float4(0.000000, 0.870588, 0.564706, 0.867188),
  float4(0.000000, 0.874510, 0.562745, 0.871094),
  float4(0.000000, 0.878431, 0.560784, 0.875000),
  float4(0.000000, 0.882353, 0.558824, 0.878906),
  float4(0.000000, 0.886275, 0.556863, 0.882812),
  float4(0.000000, 0.890196, 0.554902, 0.886719),
  float4(0.000000, 0.894118, 0.552941, 0.890625),
  float4(0.000000, 0.898039, 0.550980, 0.894531),
  float4(0.000000, 0.901961, 0.549020, 0.898438),
  float4(0.000000, 0.905882, 0.547059, 0.902344),
  float4(0.000000, 0.909804, 0.545098, 0.906250),
  float4(0.000000, 0.913725, 0.543137, 0.910156),
  float4(0.000000, 0.917647, 0.541176, 0.914062),
  float4(0.000000, 0.921569, 0.539216, 0.917969),
  float4(0.000000, 0.925490, 0.537255, 0.921875),
  float4(0.000000, 0.929412, 0.535294, 0.925781),
  float4(0.000000, 0.933333, 0.533333, 0.929688),
  float4(0.000000, 0.937255, 0.531373, 0.933594),
  float4(0.000000, 0.941176, 0.529412, 0.937500),
  float4(0.000000, 0.945098, 0.527451, 0.941406),
  float4(0.000000, 0.949020, 0.525490, 0.945312),
  float4(0.000000, 0.952941, 0.523529, 0.949219),
  float4(0.000000, 0.956863, 0.521569, 0.953125),
  float4(0.000000, 0.960784, 0.519608, 0.957031),
  float4(0.000000, 0.964706, 0.517647, 0.960938),
  float4(0.000000, 0.968627, 0.515686, 0.964844),
  float4(0.000000, 0.972549, 0.513725, 0.968750),
  float4(0.000000, 0.976471, 0.511765, 0.972656),
  float4(0.000000, 0.980392, 0.509804, 0.976562),
  float4(0.000000, 0.984314, 0.507843, 0.980469),
  float4(0.000000, 0.988235, 0.505882, 0.984375),
  float4(0.000000, 0.992157, 0.503922, 0.988281),
  float4(0.000000, 0.996078, 0.501961, 0.992188),
  float4(0.000000, 1.000000, 0.500000, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::RedsTransferFunction
{
  float4(1.000000, 0.960784, 0.941176, 0.000000),
  float4(0.999877, 0.958201, 0.937486, 0.003906),
  float4(0.999754, 0.955617, 0.933795, 0.007812),
  float4(0.999631, 0.953033, 0.930104, 0.011719),
  float4(0.999508, 0.950450, 0.926413, 0.015625),
  float4(0.999385, 0.947866, 0.922722, 0.019531),
  float4(0.999262, 0.945283, 0.919031, 0.023438),
  float4(0.999139, 0.942699, 0.915340, 0.027344),
  float4(0.999016, 0.940115, 0.911649, 0.031250),
  float4(0.998893, 0.937532, 0.907958, 0.035156),
  float4(0.998770, 0.934948, 0.904268, 0.039062),
  float4(0.998647, 0.932364, 0.900577, 0.042969),
  float4(0.998524, 0.929781, 0.896886, 0.046875),
  float4(0.998401, 0.927197, 0.893195, 0.050781),
  float4(0.998278, 0.924614, 0.889504, 0.054688),
  float4(0.998155, 0.922030, 0.885813, 0.058594),
  float4(0.998032, 0.919446, 0.882122, 0.062500),
  float4(0.997908, 0.916863, 0.878431, 0.066406),
  float4(0.997785, 0.914279, 0.874740, 0.070312),
  float4(0.997662, 0.911695, 0.871050, 0.074219),
  float4(0.997539, 0.909112, 0.867359, 0.078125),
  float4(0.997416, 0.906528, 0.863668, 0.082031),
  float4(0.997293, 0.903945, 0.859977, 0.085938),
  float4(0.997170, 0.901361, 0.856286, 0.089844),
  float4(0.997047, 0.898777, 0.852595, 0.093750),
  float4(0.996924, 0.896194, 0.848904, 0.097656),
  float4(0.996801, 0.893610, 0.845213, 0.101562),
  float4(0.996678, 0.891027, 0.841522, 0.105469),
  float4(0.996555, 0.888443, 0.837832, 0.109375),
  float4(0.996432, 0.885859, 0.834141, 0.113281),
  float4(0.996309, 0.883276, 0.830450, 0.117188),
  float4(0.996186, 0.880692, 0.826759, 0.121094),
  float4(0.996048, 0.877862, 0.822776, 0.125000),
  float4(0.995802, 0.873310, 0.816747, 0.128906),
  float4(0.995556, 0.868758, 0.810719, 0.132812),
  float4(0.995309, 0.864206, 0.804690, 0.136719),
  float4(0.995063, 0.859654, 0.798662, 0.140625),
  float4(0.994817, 0.855102, 0.792634, 0.144531),
  float4(0.994571, 0.850550, 0.786605, 0.148438),
  float4(0.994325, 0.845998, 0.780577, 0.152344),
  float4(0.994079, 0.841446, 0.774548, 0.156250),
  float4(0.993833, 0.836893, 0.768520, 0.160156),
  float4(0.993587, 0.832341, 0.762491, 0.164062),
  float4(0.993341, 0.827789, 0.756463, 0.167969),
  float4(0.993095, 0.823237, 0.750434, 0.171875),
  float4(0.992849, 0.818685, 0.744406, 0.175781),
  float4(0.992603, 0.814133, 0.738378, 0.179688),
  float4(0.992357, 0.809581, 0.732349, 0.183594),
  float4(0.992111, 0.805029, 0.726321, 0.187500),
  float4(0.991865, 0.800477, 0.720292, 0.191406),
  float4(0.991619, 0.795925, 0.714264, 0.195312),
  float4(0.991373, 0.791373, 0.708235, 0.199219),
  float4(0.991126, 0.786820, 0.702207, 0.203125),
  float4(0.990880, 0.782268, 0.696178, 0.207031),
  float4(0.990634, 0.777716, 0.690150, 0.210938),
  float4(0.990388, 0.773164, 0.684121, 0.214844),
  float4(0.990142, 0.768612, 0.678093, 0.218750),
  float4(0.989896, 0.764060, 0.672065, 0.222656),
  float4(0.989650, 0.759508, 0.666036, 0.226562),
  float4(0.989404, 0.754956, 0.660008, 0.230469),
  float4(0.989158, 0.750404, 0.653979, 0.234375),
  float4(0.988912, 0.745852, 0.647951, 0.238281),
  float4(0.988666, 0.741300, 0.641922, 0.242188),
  float4(0.988420, 0.736747, 0.635894, 0.246094),
  float4(0.988235, 0.732072, 0.629927, 0.250000),
  float4(0.988235, 0.727028, 0.624145, 0.253906),
  float4(0.988235, 0.721984, 0.618362, 0.257812),
  float4(0.988235, 0.716940, 0.612580, 0.261719),
  float4(0.988235, 0.711895, 0.606797, 0.265625),
  float4(0.988235, 0.706851, 0.601015, 0.269531),
  float4(0.988235, 0.701807, 0.595233, 0.273438),
  float4(0.988235, 0.696763, 0.589450, 0.277344),
  float4(0.988235, 0.691719, 0.583668, 0.281250),
  float4(0.988235, 0.686674, 0.577885, 0.285156),
  float4(0.988235, 0.681630, 0.572103, 0.289062),
  float4(0.988235, 0.676586, 0.566321, 0.292969),
  float4(0.988235, 0.671542, 0.560538, 0.296875),
  float4(0.988235, 0.666497, 0.554756, 0.300781),
  float4(0.988235, 0.661453, 0.548973, 0.304688),
  float4(0.988235, 0.656409, 0.543191, 0.308594),
  float4(0.988235, 0.651365, 0.537409, 0.312500),
  float4(0.988235, 0.646321, 0.531626, 0.316406),
  float4(0.988235, 0.641276, 0.525844, 0.320312),
  float4(0.988235, 0.636232, 0.520062, 0.324219),
  float4(0.988235, 0.631188, 0.514279, 0.328125),
  float4(0.988235, 0.626144, 0.508497, 0.332031),
  float4(0.988235, 0.621100, 0.502714, 0.335938),
  float4(0.988235, 0.616055, 0.496932, 0.339844),
  float4(0.988235, 0.611011, 0.491150, 0.343750),
  float4(0.988235, 0.605967, 0.485367, 0.347656),
  float4(0.988235, 0.600923, 0.479585, 0.351562),
  float4(0.988235, 0.595879, 0.473802, 0.355469),
  float4(0.988235, 0.590834, 0.468020, 0.359375),
  float4(0.988235, 0.585790, 0.462238, 0.363281),
  float4(0.988235, 0.580746, 0.456455, 0.367188),
  float4(0.988235, 0.575702, 0.450673, 0.371094),
  float4(0.988189, 0.570704, 0.445213, 0.375000),
  float4(0.988066, 0.565782, 0.440292, 0.378906),
  float4(0.987943, 0.560861, 0.435371, 0.382812),
  float4(0.987820, 0.555940, 0.430450, 0.386719),
  float4(0.987697, 0.551019, 0.425529, 0.390625),
  float4(0.987574, 0.546098, 0.420607, 0.394531),
  float4(0.987451, 0.541176, 0.415686, 0.398438),
  float4(0.987328, 0.536255, 0.410765, 0.402344),
  float4(0.987205, 0.531334, 0.405844, 0.406250),
  float4(0.987082, 0.526413, 0.400923, 0.410156),
  float4(0.986959, 0.521492, 0.396002, 0.414062),
  float4(0.986836, 0.516571, 0.391080, 0.417969),
  float4(0.986713, 0.511649, 0.386159, 0.421875),
  float4(0.986590, 0.506728, 0.381238, 0.425781),
  float4(0.986467, 0.501807, 0.376317, 0.429688),
  float4(0.986344, 0.496886, 0.371396, 0.433594),
  float4(0.986221, 0.491965, 0.366474, 0.437500),
  float4(0.986098, 0.487043, 0.361553, 0.441406),
  float4(0.985975, 0.482122, 0.356632, 0.445312),
  float4(0.985852, 0.477201, 0.351711, 0.449219),
  float4(0.985729, 0.472280, 0.346790, 0.453125),
  float4(0.985606, 0.467359, 0.341869, 0.457031),
  float4(0.985483, 0.462438, 0.336947, 0.460938),
  float4(0.985359, 0.457516, 0.332026, 0.464844),
  float4(0.985236, 0.452595, 0.327105, 0.468750),
  float4(0.985113, 0.447674, 0.322184, 0.472656),
  float4(0.984990, 0.442753, 0.317263, 0.476562),
  float4(0.984867, 0.437832, 0.312341, 0.480469),
  float4(0.984744, 0.432910, 0.307420, 0.484375),
  float4(0.984621, 0.427989, 0.302499, 0.488281),
  float4(0.984498, 0.423068, 0.297578, 0.492188),
  float4(0.984375, 0.418147, 0.292657, 0.496094),
  float4(0.983576, 0.412795, 0.288351, 0.500000),
  float4(0.982099, 0.407013, 0.284660, 0.503906),
  float4(0.980623, 0.401230, 0.280969, 0.507812),
  float4(0.979146, 0.395448, 0.277278, 0.511719),
  float4(0.977670, 0.389666, 0.273587, 0.515625),
  float4(0.976194, 0.383883, 0.269896, 0.519531),
  float4(0.974717, 0.378101, 0.266205, 0.523438),
  float4(0.973241, 0.372318, 0.262514, 0.527344),
  float4(0.971765, 0.366536, 0.258824, 0.531250),
  float4(0.970288, 0.360754, 0.255133, 0.535156),
  float4(0.968812, 0.354971, 0.251442, 0.539062),
  float4(0.967336, 0.349189, 0.247751, 0.542969),
  float4(0.965859, 0.343406, 0.244060, 0.546875),
  float4(0.964383, 0.337624, 0.240369, 0.550781),
  float4(0.962907, 0.331842, 0.236678, 0.554688),
  float4(0.961430, 0.326059, 0.232987, 0.558594),
  float4(0.959954, 0.320277, 0.229296, 0.562500),
  float4(0.958478, 0.314494, 0.225606, 0.566406),
  float4(0.957001, 0.308712, 0.221915, 0.570312),
  float4(0.955525, 0.302930, 0.218224, 0.574219),
  float4(0.954048, 0.297147, 0.214533, 0.578125),
  float4(0.952572, 0.291365, 0.210842, 0.582031),
  float4(0.951096, 0.285582, 0.207151, 0.585938),
  float4(0.949619, 0.279800, 0.203460, 0.589844),
  float4(0.948143, 0.274018, 0.199769, 0.593750),
  float4(0.946667, 0.268235, 0.196078, 0.597656),
  float4(0.945190, 0.262453, 0.192388, 0.601562),
  float4(0.943714, 0.256671, 0.188697, 0.605469),
  float4(0.942238, 0.250888, 0.185006, 0.609375),
  float4(0.940761, 0.245106, 0.181315, 0.613281),
  float4(0.939285, 0.239323, 0.177624, 0.617188),
  float4(0.937809, 0.233541, 0.173933, 0.621094),
  float4(0.934487, 0.228681, 0.171396, 0.625000),
  float4(0.930058, 0.224375, 0.169550, 0.628906),
  float4(0.925629, 0.220069, 0.167705, 0.632812),
  float4(0.921200, 0.215763, 0.165859, 0.636719),
  float4(0.916770, 0.211457, 0.164014, 0.640625),
  float4(0.912341, 0.207151, 0.162168, 0.644531),
  float4(0.907912, 0.202845, 0.160323, 0.648438),
  float4(0.903483, 0.198539, 0.158478, 0.652344),
  float4(0.899054, 0.194233, 0.156632, 0.656250),
  float4(0.894625, 0.189927, 0.154787, 0.660156),
  float4(0.890196, 0.185621, 0.152941, 0.664062),
  float4(0.885767, 0.181315, 0.151096, 0.667969),
  float4(0.881338, 0.177009, 0.149250, 0.671875),
  float4(0.876909, 0.172703, 0.147405, 0.675781),
  float4(0.872480, 0.168397, 0.145559, 0.679688),
  float4(0.868051, 0.164091, 0.143714, 0.683594),
  float4(0.863622, 0.159785, 0.141869, 0.687500),
  float4(0.859193, 0.155479, 0.140023, 0.691406),
  float4(0.854764, 0.151173, 0.138178, 0.695312),
  float4(0.850334, 0.146867, 0.136332, 0.699219),
  float4(0.845905, 0.142561, 0.134487, 0.703125),
  float4(0.841476, 0.138255, 0.132641, 0.707031),
  float4(0.837047, 0.133948, 0.130796, 0.710938),
  float4(0.832618, 0.129642, 0.128950, 0.714844),
  float4(0.828189, 0.125336, 0.127105, 0.718750),
  float4(0.823760, 0.121030, 0.125260, 0.722656),
  float4(0.819331, 0.116724, 0.123414, 0.726562),
  float4(0.814902, 0.112418, 0.121569, 0.730469),
  float4(0.810473, 0.108112, 0.119723, 0.734375),
  float4(0.806044, 0.103806, 0.117878, 0.738281),
  float4(0.801615, 0.099500, 0.116032, 0.742188),
  float4(0.797186, 0.095194, 0.114187, 0.746094),
  float4(0.792572, 0.093287, 0.112987, 0.750000),
  float4(0.787897, 0.092180, 0.112003, 0.753906),
  float4(0.783222, 0.091073, 0.111019, 0.757812),
  float4(0.778547, 0.089965, 0.110035, 0.761719),
  float4(0.773872, 0.088858, 0.109050, 0.765625),
  float4(0.769196, 0.087751, 0.108066, 0.769531),
  float4(0.764521, 0.086644, 0.107082, 0.773438),
  float4(0.759846, 0.085536, 0.106098, 0.777344),
  float4(0.755171, 0.084429, 0.105113, 0.781250),
  float4(0.750496, 0.083322, 0.104129, 0.785156),
  float4(0.745821, 0.082215, 0.103145, 0.789062),
  float4(0.741146, 0.081107, 0.102161, 0.792969),
  float4(0.736471, 0.080000, 0.101176, 0.796875),
  float4(0.731795, 0.078893, 0.100192, 0.800781),
  float4(0.727120, 0.077785, 0.099208, 0.804688),
  float4(0.722445, 0.076678, 0.098224, 0.808594),
  float4(0.717770, 0.075571, 0.097240, 0.812500),
  float4(0.713095, 0.074464, 0.096255, 0.816406),
  float4(0.708420, 0.073356, 0.095271, 0.820312),
  float4(0.703745, 0.072249, 0.094287, 0.824219),
  float4(0.699070, 0.071142, 0.093303, 0.828125),
  float4(0.694394, 0.070035, 0.092318, 0.832031),
  float4(0.689719, 0.068927, 0.091334, 0.835938),
  float4(0.685044, 0.067820, 0.090350, 0.839844),
  float4(0.680369, 0.066713, 0.089366, 0.843750),
  float4(0.675694, 0.065606, 0.088381, 0.847656),
  float4(0.671019, 0.064498, 0.087397, 0.851562),
  float4(0.666344, 0.063391, 0.086413, 0.855469),
  float4(0.661669, 0.062284, 0.085429, 0.859375),
  float4(0.656993, 0.061176, 0.084444, 0.863281),
  float4(0.652318, 0.060069, 0.083460, 0.867188),
  float4(0.647643, 0.058962, 0.082476, 0.871094),
  float4(0.640384, 0.057209, 0.081492, 0.875000),
  float4(0.632757, 0.055363, 0.080507, 0.878906),
  float4(0.625129, 0.053518, 0.079523, 0.882812),
  float4(0.617501, 0.051672, 0.078539, 0.886719),
  float4(0.609873, 0.049827, 0.077555, 0.890625),
  float4(0.602245, 0.047982, 0.076571, 0.894531),
  float4(0.594617, 0.046136, 0.075586, 0.898438),
  float4(0.586990, 0.044291, 0.074602, 0.902344),
  float4(0.579362, 0.042445, 0.073618, 0.906250),
  float4(0.571734, 0.040600, 0.072634, 0.910156),
  float4(0.564106, 0.038754, 0.071649, 0.914062),
  float4(0.556478, 0.036909, 0.070665, 0.917969),
  float4(0.548850, 0.035063, 0.069681, 0.921875),
  float4(0.541223, 0.033218, 0.068697, 0.925781),
  float4(0.533595, 0.031373, 0.067712, 0.929688),
  float4(0.525967, 0.029527, 0.066728, 0.933594),
  float4(0.518339, 0.027682, 0.065744, 0.937500),
  float4(0.510711, 0.025836, 0.064760, 0.941406),
  float4(0.503083, 0.023991, 0.063775, 0.945312),
  float4(0.495456, 0.022145, 0.062791, 0.949219),
  float4(0.487828, 0.020300, 0.061807, 0.953125),
  float4(0.480200, 0.018454, 0.060823, 0.957031),
  float4(0.472572, 0.016609, 0.059839, 0.960938),
  float4(0.464944, 0.014764, 0.058854, 0.964844),
  float4(0.457316, 0.012918, 0.057870, 0.968750),
  float4(0.449689, 0.011073, 0.056886, 0.972656),
  float4(0.442061, 0.009227, 0.055902, 0.976562),
  float4(0.434433, 0.007382, 0.054917, 0.980469),
  float4(0.426805, 0.005536, 0.053933, 0.984375),
  float4(0.419177, 0.003691, 0.052949, 0.988281),
  float4(0.411549, 0.001845, 0.051965, 0.992188),
  float4(0.403922, 0.000000, 0.050980, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::GreensTransferFunction
{
  float4(0.968627, 0.988235, 0.960784, 0.000000),
  float4(0.966413, 0.987374, 0.958201, 0.003906),
  float4(0.964198, 0.986513, 0.955617, 0.007812),
  float4(0.961984, 0.985652, 0.953033, 0.011719),
  float4(0.959769, 0.984790, 0.950450, 0.015625),
  float4(0.957555, 0.983929, 0.947866, 0.019531),
  float4(0.955340, 0.983068, 0.945283, 0.023438),
  float4(0.953126, 0.982207, 0.942699, 0.027344),
  float4(0.950911, 0.981346, 0.940115, 0.031250),
  float4(0.948697, 0.980484, 0.937532, 0.035156),
  float4(0.946482, 0.979623, 0.934948, 0.039062),
  float4(0.944268, 0.978762, 0.932364, 0.042969),
  float4(0.942053, 0.977901, 0.929781, 0.046875),
  float4(0.939839, 0.977040, 0.927197, 0.050781),
  float4(0.937624, 0.976178, 0.924614, 0.054688),
  float4(0.935409, 0.975317, 0.922030, 0.058594),
  float4(0.933195, 0.974456, 0.919446, 0.062500),
  float4(0.930980, 0.973595, 0.916863, 0.066406),
  float4(0.928766, 0.972734, 0.914279, 0.070312),
  float4(0.926551, 0.971872, 0.911696, 0.074219),
  float4(0.924337, 0.971011, 0.909112, 0.078125),
  float4(0.922122, 0.970150, 0.906528, 0.082031),
  float4(0.919908, 0.969289, 0.903945, 0.085938),
  float4(0.917693, 0.968428, 0.901361, 0.089844),
  float4(0.915479, 0.967566, 0.898777, 0.093750),
  float4(0.913264, 0.966705, 0.896194, 0.097656),
  float4(0.911050, 0.965844, 0.893610, 0.101562),
  float4(0.908835, 0.964983, 0.891027, 0.105469),
  float4(0.906621, 0.964121, 0.888443, 0.109375),
  float4(0.904406, 0.963260, 0.885859, 0.113281),
  float4(0.902191, 0.962399, 0.883276, 0.117188),
  float4(0.899977, 0.961538, 0.880692, 0.121094),
  float4(0.897578, 0.960600, 0.877939, 0.125000),
  float4(0.893887, 0.959123, 0.874002, 0.128906),
  float4(0.890196, 0.957647, 0.870065, 0.132812),
  float4(0.886505, 0.956171, 0.866128, 0.136719),
  float4(0.882814, 0.954694, 0.862191, 0.140625),
  float4(0.879123, 0.953218, 0.858255, 0.144531),
  float4(0.875433, 0.951742, 0.854318, 0.148438),
  float4(0.871742, 0.950265, 0.850381, 0.152344),
  float4(0.868051, 0.948789, 0.846444, 0.156250),
  float4(0.864360, 0.947313, 0.842507, 0.160156),
  float4(0.860669, 0.945836, 0.838570, 0.164062),
  float4(0.856978, 0.944360, 0.834633, 0.167969),
  float4(0.853287, 0.942884, 0.830696, 0.171875),
  float4(0.849596, 0.941407, 0.826759, 0.175781),
  float4(0.845905, 0.939931, 0.822822, 0.179688),
  float4(0.842215, 0.938454, 0.818885, 0.183594),
  float4(0.838524, 0.936978, 0.814948, 0.187500),
  float4(0.834833, 0.935502, 0.811011, 0.191406),
  float4(0.831142, 0.934025, 0.807074, 0.195312),
  float4(0.827451, 0.932549, 0.803137, 0.199219),
  float4(0.823760, 0.931073, 0.799200, 0.203125),
  float4(0.820069, 0.929596, 0.795263, 0.207031),
  float4(0.816378, 0.928120, 0.791326, 0.210938),
  float4(0.812687, 0.926644, 0.787389, 0.214844),
  float4(0.808997, 0.925167, 0.783453, 0.218750),
  float4(0.805306, 0.923691, 0.779516, 0.222656),
  float4(0.801615, 0.922215, 0.775579, 0.226562),
  float4(0.797924, 0.920738, 0.771642, 0.230469),
  float4(0.794233, 0.919262, 0.767705, 0.234375),
  float4(0.790542, 0.917785, 0.763768, 0.238281),
  float4(0.786851, 0.916309, 0.759831, 0.242188),
  float4(0.783160, 0.914833, 0.755894, 0.246094),
  float4(0.779223, 0.913233, 0.751803, 0.250000),
  float4(0.774548, 0.911265, 0.747251, 0.253906),
  float4(0.769873, 0.909296, 0.742699, 0.257812),
  float4(0.765198, 0.907328, 0.738147, 0.261719),
  float4(0.760523, 0.905359, 0.733595, 0.265625),
  float4(0.755848, 0.903391, 0.729043, 0.269531),
  float4(0.751173, 0.901423, 0.724491, 0.273438),
  float4(0.746498, 0.899454, 0.719938, 0.277344),
  float4(0.741822, 0.897486, 0.715386, 0.281250),
  float4(0.737147, 0.895517, 0.710834, 0.285156),
  float4(0.732472, 0.893549, 0.706282, 0.289062),
  float4(0.727797, 0.891580, 0.701730, 0.292969),
  float4(0.723122, 0.889612, 0.697178, 0.296875),
  float4(0.718447, 0.887643, 0.692626, 0.300781),
  float4(0.713772, 0.885675, 0.688074, 0.304688),
  float4(0.709097, 0.883706, 0.683522, 0.308594),
  float4(0.704421, 0.881738, 0.678970, 0.312500),
  float4(0.699746, 0.879769, 0.674418, 0.316406),
  float4(0.695071, 0.877801, 0.669865, 0.320312),
  float4(0.690396, 0.875832, 0.665313, 0.324219),
  float4(0.685721, 0.873864, 0.660761, 0.328125),
  float4(0.681046, 0.871895, 0.656209, 0.332031),
  float4(0.676371, 0.869927, 0.651657, 0.335938),
  float4(0.671696, 0.867958, 0.647105, 0.339844),
  float4(0.667020, 0.865990, 0.642553, 0.343750),
  float4(0.662345, 0.864022, 0.638001, 0.347656),
  float4(0.657670, 0.862053, 0.633449, 0.351562),
  float4(0.652995, 0.860085, 0.628897, 0.355469),
  float4(0.648320, 0.858116, 0.624344, 0.359375),
  float4(0.643645, 0.856148, 0.619792, 0.363281),
  float4(0.638970, 0.854179, 0.615240, 0.367188),
  float4(0.634295, 0.852211, 0.610688, 0.371094),
  float4(0.629296, 0.850012, 0.606136, 0.375000),
  float4(0.623760, 0.847428, 0.601584, 0.378906),
  float4(0.618224, 0.844844, 0.597032, 0.382812),
  float4(0.612687, 0.842261, 0.592480, 0.386719),
  float4(0.607151, 0.839677, 0.587928, 0.390625),
  float4(0.601615, 0.837093, 0.583376, 0.394531),
  float4(0.596078, 0.834510, 0.578824, 0.398438),
  float4(0.590542, 0.831926, 0.574271, 0.402344),
  float4(0.585006, 0.829343, 0.569719, 0.406250),
  float4(0.579469, 0.826759, 0.565167, 0.410156),
  float4(0.573933, 0.824175, 0.560615, 0.414062),
  float4(0.568397, 0.821592, 0.556063, 0.417969),
  float4(0.562860, 0.819008, 0.551511, 0.421875),
  float4(0.557324, 0.816424, 0.546959, 0.425781),
  float4(0.551788, 0.813841, 0.542407, 0.429688),
  float4(0.546251, 0.811257, 0.537855, 0.433594),
  float4(0.540715, 0.808674, 0.533303, 0.437500),
  float4(0.535179, 0.806090, 0.528750, 0.441406),
  float4(0.529642, 0.803506, 0.524198, 0.445312),
  float4(0.524106, 0.800923, 0.519646, 0.449219),
  float4(0.518570, 0.798339, 0.515094, 0.453125),
  float4(0.513033, 0.795755, 0.510542, 0.457031),
  float4(0.507497, 0.793172, 0.505990, 0.460938),
  float4(0.501961, 0.790588, 0.501438, 0.464844),
  float4(0.496424, 0.788005, 0.496886, 0.468750),
  float4(0.490888, 0.785421, 0.492334, 0.472656),
  float4(0.485352, 0.782837, 0.487782, 0.476562),
  float4(0.479815, 0.780254, 0.483230, 0.480469),
  float4(0.474279, 0.777670, 0.478677, 0.484375),
  float4(0.468743, 0.775087, 0.474125, 0.488281),
  float4(0.463206, 0.772503, 0.469573, 0.492188),
  float4(0.457670, 0.769919, 0.465021, 0.496094),
  float4(0.451765, 0.767090, 0.461207, 0.500000),
  float4(0.445490, 0.764014, 0.458131, 0.503906),
  float4(0.439216, 0.760938, 0.455056, 0.507812),
  float4(0.432941, 0.757862, 0.451980, 0.511719),
  float4(0.426667, 0.754787, 0.448904, 0.515625),
  float4(0.420392, 0.751711, 0.445829, 0.519531),
  float4(0.414118, 0.748635, 0.442753, 0.523438),
  float4(0.407843, 0.745559, 0.439677, 0.527344),
  float4(0.401569, 0.742484, 0.436601, 0.531250),
  float4(0.395294, 0.739408, 0.433526, 0.535156),
  float4(0.389020, 0.736332, 0.430450, 0.539062),
  float4(0.382745, 0.733256, 0.427374, 0.542969),
  float4(0.376471, 0.730181, 0.424298, 0.546875),
  float4(0.370196, 0.727105, 0.421223, 0.550781),
  float4(0.363922, 0.724029, 0.418147, 0.554688),
  float4(0.357647, 0.720953, 0.415071, 0.558594),
  float4(0.351373, 0.717878, 0.411995, 0.562500),
  float4(0.345098, 0.714802, 0.408920, 0.566406),
  float4(0.338824, 0.711726, 0.405844, 0.570312),
  float4(0.332549, 0.708651, 0.402768, 0.574219),
  float4(0.326275, 0.705575, 0.399692, 0.578125),
  float4(0.320000, 0.702499, 0.396617, 0.582031),
  float4(0.313725, 0.699423, 0.393541, 0.585938),
  float4(0.307451, 0.696348, 0.390465, 0.589844),
  float4(0.301176, 0.693272, 0.387389, 0.593750),
  float4(0.294902, 0.690196, 0.384314, 0.597656),
  float4(0.288627, 0.687120, 0.381238, 0.601562),
  float4(0.282353, 0.684045, 0.378162, 0.605469),
  float4(0.276078, 0.680969, 0.375087, 0.609375),
  float4(0.269804, 0.677893, 0.372011, 0.613281),
  float4(0.263529, 0.674817, 0.368935, 0.617188),
  float4(0.257255, 0.671742, 0.365859, 0.621094),
  float4(0.252595, 0.668128, 0.362860, 0.625000),
  float4(0.248904, 0.664191, 0.359908, 0.628906),
  float4(0.245213, 0.660254, 0.356955, 0.632812),
  float4(0.241522, 0.656317, 0.354002, 0.636719),
  float4(0.237832, 0.652380, 0.351050, 0.640625),
  float4(0.234141, 0.648443, 0.348097, 0.644531),
  float4(0.230450, 0.644506, 0.345144, 0.648438),
  float4(0.226759, 0.640569, 0.342191, 0.652344),
  float4(0.223068, 0.636632, 0.339239, 0.656250),
  float4(0.219377, 0.632695, 0.336286, 0.660156),
  float4(0.215686, 0.628758, 0.333333, 0.664062),
  float4(0.211995, 0.624821, 0.330381, 0.667969),
  float4(0.208304, 0.620884, 0.327428, 0.671875),
  float4(0.204614, 0.616947, 0.324475, 0.675781),
  float4(0.200923, 0.613010, 0.321522, 0.679688),
  float4(0.197232, 0.609073, 0.318570, 0.683594),
  float4(0.193541, 0.605136, 0.315617, 0.687500),
  float4(0.189850, 0.601200, 0.312664, 0.691406),
  float4(0.186159, 0.597263, 0.309712, 0.695312),
  float4(0.182468, 0.593326, 0.306759, 0.699219),
  float4(0.178777, 0.589389, 0.303806, 0.703125),
  float4(0.175087, 0.585452, 0.300854, 0.707031),
  float4(0.171396, 0.581515, 0.297901, 0.710938),
  float4(0.167705, 0.577578, 0.294948, 0.714844),
  float4(0.164014, 0.573641, 0.291995, 0.718750),
  float4(0.160323, 0.569704, 0.289043, 0.722656),
  float4(0.156632, 0.565767, 0.286090, 0.726562),
  float4(0.152941, 0.561830, 0.283137, 0.730469),
  float4(0.149250, 0.557893, 0.280185, 0.734375),
  float4(0.145559, 0.553956, 0.277232, 0.738281),
  float4(0.141869, 0.550019, 0.274279, 0.742188),
  float4(0.138178, 0.546082, 0.271326, 0.746094),
  float4(0.134025, 0.542330, 0.268281, 0.750000),
  float4(0.129719, 0.538639, 0.265206, 0.753906),
  float4(0.125413, 0.534948, 0.262130, 0.757812),
  float4(0.121107, 0.531257, 0.259054, 0.761719),
  float4(0.116801, 0.527566, 0.255978, 0.765625),
  float4(0.112495, 0.523875, 0.252903, 0.769531),
  float4(0.108189, 0.520185, 0.249827, 0.773438),
  float4(0.103883, 0.516494, 0.246751, 0.777344),
  float4(0.099577, 0.512803, 0.243676, 0.781250),
  float4(0.095271, 0.509112, 0.240600, 0.785156),
  float4(0.090965, 0.505421, 0.237524, 0.789062),
  float4(0.086659, 0.501730, 0.234448, 0.792969),
  float4(0.082353, 0.498039, 0.231373, 0.796875),
  float4(0.078047, 0.494348, 0.228297, 0.800781),
  float4(0.073741, 0.490657, 0.225221, 0.804688),
  float4(0.069435, 0.486967, 0.222145, 0.808594),
  float4(0.065129, 0.483276, 0.219070, 0.812500),
  float4(0.060823, 0.479585, 0.215994, 0.816406),
  float4(0.056517, 0.475894, 0.212918, 0.820312),
  float4(0.052211, 0.472203, 0.209842, 0.824219),
  float4(0.047905, 0.468512, 0.206767, 0.828125),
  float4(0.043599, 0.464821, 0.203691, 0.832031),
  float4(0.039293, 0.461130, 0.200615, 0.835938),
  float4(0.034987, 0.457439, 0.197539, 0.839844),
  float4(0.030681, 0.453749, 0.194464, 0.843750),
  float4(0.026374, 0.450058, 0.191388, 0.847656),
  float4(0.022068, 0.446367, 0.188312, 0.851562),
  float4(0.017762, 0.442676, 0.185236, 0.855469),
  float4(0.013456, 0.438985, 0.182161, 0.859375),
  float4(0.009150, 0.435294, 0.179085, 0.863281),
  float4(0.004844, 0.431603, 0.176009, 0.867188),
  float4(0.000538, 0.427912, 0.172933, 0.871094),
  float4(0.000000, 0.423037, 0.170719, 0.875000),
  float4(0.000000, 0.417993, 0.168627, 0.878906),
  float4(0.000000, 0.412949, 0.166536, 0.882812),
  float4(0.000000, 0.407905, 0.164444, 0.886719),
  float4(0.000000, 0.402860, 0.162353, 0.890625),
  float4(0.000000, 0.397816, 0.160261, 0.894531),
  float4(0.000000, 0.392772, 0.158170, 0.898438),
  float4(0.000000, 0.387728, 0.156078, 0.902344),
  float4(0.000000, 0.382684, 0.153987, 0.906250),
  float4(0.000000, 0.377639, 0.151895, 0.910156),
  float4(0.000000, 0.372595, 0.149804, 0.914062),
  float4(0.000000, 0.367551, 0.147712, 0.917969),
  float4(0.000000, 0.362507, 0.145621, 0.921875),
  float4(0.000000, 0.357463, 0.143529, 0.925781),
  float4(0.000000, 0.352418, 0.141438, 0.929688),
  float4(0.000000, 0.347374, 0.139346, 0.933594),
  float4(0.000000, 0.342330, 0.137255, 0.937500),
  float4(0.000000, 0.337286, 0.135163, 0.941406),
  float4(0.000000, 0.332241, 0.133072, 0.945312),
  float4(0.000000, 0.327197, 0.130980, 0.949219),
  float4(0.000000, 0.322153, 0.128889, 0.953125),
  float4(0.000000, 0.317109, 0.126797, 0.957031),
  float4(0.000000, 0.312065, 0.124706, 0.960938),
  float4(0.000000, 0.307020, 0.122614, 0.964844),
  float4(0.000000, 0.301976, 0.120523, 0.968750),
  float4(0.000000, 0.296932, 0.118431, 0.972656),
  float4(0.000000, 0.291888, 0.116340, 0.976562),
  float4(0.000000, 0.286844, 0.114248, 0.980469),
  float4(0.000000, 0.281799, 0.112157, 0.984375),
  float4(0.000000, 0.276755, 0.110065, 0.988281),
  float4(0.000000, 0.271711, 0.107974, 0.992188),
  float4(0.000000, 0.266667, 0.105882, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::BluesTransferFunction
{
  float4(0.968627, 0.984314, 1.000000, 0.000000),
  float4(0.965552, 0.982345, 0.999016, 0.003906),
  float4(0.962476, 0.980377, 0.998032, 0.007812),
  float4(0.959400, 0.978408, 0.997047, 0.011719),
  float4(0.956324, 0.976440, 0.996063, 0.015625),
  float4(0.953249, 0.974471, 0.995079, 0.019531),
  float4(0.950173, 0.972503, 0.994095, 0.023438),
  float4(0.947097, 0.970534, 0.993110, 0.027344),
  float4(0.944022, 0.968566, 0.992126, 0.031250),
  float4(0.940946, 0.966597, 0.991142, 0.035156),
  float4(0.937870, 0.964629, 0.990158, 0.039062),
  float4(0.934794, 0.962661, 0.989173, 0.042969),
  float4(0.931719, 0.960692, 0.988189, 0.046875),
  float4(0.928643, 0.958724, 0.987205, 0.050781),
  float4(0.925567, 0.956755, 0.986221, 0.054688),
  float4(0.922491, 0.954787, 0.985236, 0.058594),
  float4(0.919416, 0.952818, 0.984252, 0.062500),
  float4(0.916340, 0.950850, 0.983268, 0.066406),
  float4(0.913264, 0.948881, 0.982284, 0.070312),
  float4(0.910188, 0.946913, 0.981299, 0.074219),
  float4(0.907113, 0.944944, 0.980315, 0.078125),
  float4(0.904037, 0.942976, 0.979331, 0.082031),
  float4(0.900961, 0.941007, 0.978347, 0.085938),
  float4(0.897885, 0.939039, 0.977363, 0.089844),
  float4(0.894810, 0.937070, 0.976378, 0.093750),
  float4(0.891734, 0.935102, 0.975394, 0.097656),
  float4(0.888658, 0.933133, 0.974410, 0.101562),
  float4(0.885582, 0.931165, 0.973426, 0.105469),
  float4(0.882507, 0.929196, 0.972441, 0.109375),
  float4(0.879431, 0.927228, 0.971457, 0.113281),
  float4(0.876355, 0.925260, 0.970473, 0.117188),
  float4(0.873280, 0.923291, 0.969489, 0.121094),
  float4(0.870219, 0.921323, 0.968504, 0.125000),
  float4(0.867266, 0.919354, 0.967520, 0.128906),
  float4(0.864314, 0.917386, 0.966536, 0.132812),
  float4(0.861361, 0.915417, 0.965552, 0.136719),
  float4(0.858408, 0.913449, 0.964567, 0.140625),
  float4(0.855456, 0.911480, 0.963583, 0.144531),
  float4(0.852503, 0.909512, 0.962599, 0.148438),
  float4(0.849550, 0.907543, 0.961615, 0.152344),
  float4(0.846597, 0.905575, 0.960631, 0.156250),
  float4(0.843645, 0.903606, 0.959646, 0.160156),
  float4(0.840692, 0.901638, 0.958662, 0.164062),
  float4(0.837739, 0.899669, 0.957678, 0.167969),
  float4(0.834787, 0.897701, 0.956694, 0.171875),
  float4(0.831834, 0.895732, 0.955709, 0.175781),
  float4(0.828881, 0.893764, 0.954725, 0.179688),
  float4(0.825928, 0.891795, 0.953741, 0.183594),
  float4(0.822976, 0.889827, 0.952757, 0.187500),
  float4(0.820023, 0.887859, 0.951772, 0.191406),
  float4(0.817070, 0.885890, 0.950788, 0.195312),
  float4(0.814118, 0.883922, 0.949804, 0.199219),
  float4(0.811165, 0.881953, 0.948820, 0.203125),
  float4(0.808212, 0.879985, 0.947835, 0.207031),
  float4(0.805260, 0.878016, 0.946851, 0.210938),
  float4(0.802307, 0.876048, 0.945867, 0.214844),
  float4(0.799354, 0.874079, 0.944883, 0.218750),
  float4(0.796401, 0.872111, 0.943898, 0.222656),
  float4(0.793449, 0.870142, 0.942914, 0.226562),
  float4(0.790496, 0.868174, 0.941930, 0.230469),
  float4(0.787543, 0.866205, 0.940946, 0.234375),
  float4(0.784591, 0.864237, 0.939962, 0.238281),
  float4(0.781638, 0.862268, 0.938977, 0.242188),
  float4(0.778685, 0.860300, 0.937993, 0.246094),
  float4(0.775240, 0.858301, 0.936824, 0.250000),
  float4(0.770319, 0.856209, 0.935102, 0.253906),
  float4(0.765398, 0.854118, 0.933379, 0.257812),
  float4(0.760477, 0.852026, 0.931657, 0.261719),
  float4(0.755556, 0.849935, 0.929935, 0.265625),
  float4(0.750634, 0.847843, 0.928212, 0.269531),
  float4(0.745713, 0.845752, 0.926490, 0.273438),
  float4(0.740792, 0.843660, 0.924767, 0.277344),
  float4(0.735871, 0.841569, 0.923045, 0.281250),
  float4(0.730950, 0.839477, 0.921323, 0.285156),
  float4(0.726028, 0.837386, 0.919600, 0.289062),
  float4(0.721107, 0.835294, 0.917878, 0.292969),
  float4(0.716186, 0.833203, 0.916155, 0.296875),
  float4(0.711265, 0.831111, 0.914433, 0.300781),
  float4(0.706344, 0.829020, 0.912710, 0.304688),
  float4(0.701423, 0.826928, 0.910988, 0.308594),
  float4(0.696501, 0.824837, 0.909266, 0.312500),
  float4(0.691580, 0.822745, 0.907543, 0.316406),
  float4(0.686659, 0.820654, 0.905821, 0.320312),
  float4(0.681738, 0.818562, 0.904098, 0.324219),
  float4(0.676817, 0.816471, 0.902376, 0.328125),
  float4(0.671895, 0.814379, 0.900654, 0.332031),
  float4(0.666974, 0.812288, 0.898931, 0.335938),
  float4(0.662053, 0.810196, 0.897209, 0.339844),
  float4(0.657132, 0.808105, 0.895486, 0.343750),
  float4(0.652211, 0.806013, 0.893764, 0.347656),
  float4(0.647289, 0.803922, 0.892042, 0.351562),
  float4(0.642368, 0.801830, 0.890319, 0.355469),
  float4(0.637447, 0.799739, 0.888597, 0.359375),
  float4(0.632526, 0.797647, 0.886874, 0.363281),
  float4(0.627605, 0.795556, 0.885152, 0.367188),
  float4(0.622684, 0.793464, 0.883429, 0.371094),
  float4(0.617255, 0.790865, 0.881845, 0.375000),
  float4(0.610980, 0.787420, 0.880492, 0.378906),
  float4(0.604706, 0.783975, 0.879139, 0.382812),
  float4(0.598431, 0.780531, 0.877785, 0.386719),
  float4(0.592157, 0.777086, 0.876432, 0.390625),
  float4(0.585882, 0.773641, 0.875079, 0.394531),
  float4(0.579608, 0.770196, 0.873725, 0.398438),
  float4(0.573333, 0.766751, 0.872372, 0.402344),
  float4(0.567059, 0.763306, 0.871019, 0.406250),
  float4(0.560784, 0.759862, 0.869666, 0.410156),
  float4(0.554510, 0.756417, 0.868312, 0.414062),
  float4(0.548235, 0.752972, 0.866959, 0.417969),
  float4(0.541961, 0.749527, 0.865606, 0.421875),
  float4(0.535686, 0.746082, 0.864252, 0.425781),
  float4(0.529412, 0.742637, 0.862899, 0.429688),
  float4(0.523137, 0.739193, 0.861546, 0.433594),
  float4(0.516863, 0.735748, 0.860192, 0.437500),
  float4(0.510588, 0.732303, 0.858839, 0.441406),
  float4(0.504314, 0.728858, 0.857486, 0.445312),
  float4(0.498039, 0.725413, 0.856132, 0.449219),
  float4(0.491765, 0.721968, 0.854779, 0.453125),
  float4(0.485490, 0.718524, 0.853426, 0.457031),
  float4(0.479216, 0.715079, 0.852072, 0.460938),
  float4(0.472941, 0.711634, 0.850719, 0.464844),
  float4(0.466667, 0.708189, 0.849366, 0.468750),
  float4(0.460392, 0.704744, 0.848012, 0.472656),
  float4(0.454118, 0.701299, 0.846659, 0.476562),
  float4(0.447843, 0.697855, 0.845306, 0.480469),
  float4(0.441569, 0.694410, 0.843952, 0.484375),
  float4(0.435294, 0.690965, 0.842599, 0.488281),
  float4(0.429020, 0.687520, 0.841246, 0.492188),
  float4(0.422745, 0.684075, 0.839892, 0.496094),
  float4(0.417086, 0.680631, 0.838231, 0.500000),
  float4(0.412042, 0.677186, 0.836263, 0.503906),
  float4(0.406997, 0.673741, 0.834295, 0.507812),
  float4(0.401953, 0.670296, 0.832326, 0.511719),
  float4(0.396909, 0.666851, 0.830358, 0.515625),
  float4(0.391865, 0.663406, 0.828389, 0.519531),
  float4(0.386820, 0.659962, 0.826421, 0.523438),
  float4(0.381776, 0.656517, 0.824452, 0.527344),
  float4(0.376732, 0.653072, 0.822484, 0.531250),
  float4(0.371688, 0.649627, 0.820515, 0.535156),
  float4(0.366644, 0.646182, 0.818547, 0.539062),
  float4(0.361599, 0.642737, 0.816578, 0.542969),
  float4(0.356555, 0.639293, 0.814610, 0.546875),
  float4(0.351511, 0.635848, 0.812641, 0.550781),
  float4(0.346467, 0.632403, 0.810673, 0.554688),
  float4(0.341423, 0.628958, 0.808704, 0.558594),
  float4(0.336378, 0.625513, 0.806736, 0.562500),
  float4(0.331334, 0.622068, 0.804767, 0.566406),
  float4(0.326290, 0.618624, 0.802799, 0.570312),
  float4(0.321246, 0.615179, 0.800830, 0.574219),
  float4(0.316201, 0.611734, 0.798862, 0.578125),
  float4(0.311157, 0.608289, 0.796894, 0.582031),
  float4(0.306113, 0.604844, 0.794925, 0.585938),
  float4(0.301069, 0.601399, 0.792957, 0.589844),
  float4(0.296025, 0.597955, 0.790988, 0.593750),
  float4(0.290980, 0.594510, 0.789020, 0.597656),
  float4(0.285936, 0.591065, 0.787051, 0.601562),
  float4(0.280892, 0.587620, 0.785083, 0.605469),
  float4(0.275848, 0.584175, 0.783114, 0.609375),
  float4(0.270804, 0.580730, 0.781146, 0.613281),
  float4(0.265759, 0.577286, 0.779177, 0.617188),
  float4(0.260715, 0.573841, 0.777209, 0.621094),
  float4(0.256286, 0.570012, 0.775163, 0.625000),
  float4(0.252226, 0.565952, 0.773072, 0.628906),
  float4(0.248166, 0.561892, 0.770980, 0.632812),
  float4(0.244106, 0.557832, 0.768889, 0.636719),
  float4(0.240046, 0.553772, 0.766797, 0.640625),
  float4(0.235986, 0.549712, 0.764706, 0.644531),
  float4(0.231926, 0.545652, 0.762614, 0.648438),
  float4(0.227866, 0.541592, 0.760523, 0.652344),
  float4(0.223806, 0.537532, 0.758431, 0.656250),
  float4(0.219746, 0.533472, 0.756340, 0.660156),
  float4(0.215686, 0.529412, 0.754248, 0.664062),
  float4(0.211626, 0.525352, 0.752157, 0.667969),
  float4(0.207566, 0.521292, 0.750065, 0.671875),
  float4(0.203506, 0.517232, 0.747974, 0.675781),
  float4(0.199446, 0.513172, 0.745882, 0.679688),
  float4(0.195386, 0.509112, 0.743791, 0.683594),
  float4(0.191326, 0.505052, 0.741699, 0.687500),
  float4(0.187266, 0.500992, 0.739608, 0.691406),
  float4(0.183206, 0.496932, 0.737516, 0.695312),
  float4(0.179146, 0.492872, 0.735425, 0.699219),
  float4(0.175087, 0.488812, 0.733333, 0.703125),
  float4(0.171027, 0.484752, 0.731242, 0.707031),
  float4(0.166967, 0.480692, 0.729150, 0.710938),
  float4(0.162907, 0.476632, 0.727059, 0.714844),
  float4(0.158847, 0.472572, 0.724967, 0.718750),
  float4(0.154787, 0.468512, 0.722876, 0.722656),
  float4(0.150727, 0.464452, 0.720784, 0.726562),
  float4(0.146667, 0.460392, 0.718693, 0.730469),
  float4(0.142607, 0.456332, 0.716601, 0.734375),
  float4(0.138547, 0.452272, 0.714510, 0.738281),
  float4(0.134487, 0.448212, 0.712418, 0.742188),
  float4(0.130427, 0.444152, 0.710327, 0.746094),
  float4(0.127105, 0.440185, 0.707497, 0.750000),
  float4(0.124029, 0.436248, 0.704421, 0.753906),
  float4(0.120953, 0.432311, 0.701346, 0.757812),
  float4(0.117878, 0.428374, 0.698270, 0.761719),
  float4(0.114802, 0.424437, 0.695194, 0.765625),
  float4(0.111726, 0.420500, 0.692118, 0.769531),
  float4(0.108651, 0.416563, 0.689043, 0.773438),
  float4(0.105575, 0.412626, 0.685967, 0.777344),
  float4(0.102499, 0.408689, 0.682891, 0.781250),
  float4(0.099423, 0.404752, 0.679815, 0.785156),
  float4(0.096348, 0.400815, 0.676740, 0.789062),
  float4(0.093272, 0.396878, 0.673664, 0.792969),
  float4(0.090196, 0.392941, 0.670588, 0.796875),
  float4(0.087120, 0.389004, 0.667512, 0.800781),
  float4(0.084045, 0.385067, 0.664437, 0.804688),
  float4(0.080969, 0.381130, 0.661361, 0.808594),
  float4(0.077893, 0.377193, 0.658285, 0.812500),
  float4(0.074817, 0.373256, 0.655210, 0.816406),
  float4(0.071742, 0.369319, 0.652134, 0.820312),
  float4(0.068666, 0.365383, 0.649058, 0.824219),
  float4(0.065590, 0.361446, 0.645982, 0.828125),
  float4(0.062514, 0.357509, 0.642907, 0.832031),
  float4(0.059439, 0.353572, 0.639831, 0.835938),
  float4(0.056363, 0.349635, 0.636755, 0.839844),
  float4(0.053287, 0.345698, 0.633679, 0.843750),
  float4(0.050211, 0.341761, 0.630604, 0.847656),
  float4(0.047136, 0.337824, 0.627528, 0.851562),
  float4(0.044060, 0.333887, 0.624452, 0.855469),
  float4(0.040984, 0.329950, 0.621376, 0.859375),
  float4(0.037908, 0.326013, 0.618301, 0.863281),
  float4(0.034833, 0.322076, 0.615225, 0.867188),
  float4(0.031757, 0.318139, 0.612149, 0.871094),
  float4(0.031373, 0.314095, 0.606490, 0.875000),
  float4(0.031373, 0.310035, 0.600461, 0.878906),
  float4(0.031373, 0.305975, 0.594433, 0.882812),
  float4(0.031373, 0.301915, 0.588404, 0.886719),
  float4(0.031373, 0.297855, 0.582376, 0.890625),
  float4(0.031373, 0.293795, 0.576348, 0.894531),
  float4(0.031373, 0.289735, 0.570319, 0.898438),
  float4(0.031373, 0.285675, 0.564291, 0.902344),
  float4(0.031373, 0.281615, 0.558262, 0.906250),
  float4(0.031373, 0.277555, 0.552234, 0.910156),
  float4(0.031373, 0.273495, 0.546205, 0.914062),
  float4(0.031373, 0.269435, 0.540177, 0.917969),
  float4(0.031373, 0.265375, 0.534148, 0.921875),
  float4(0.031373, 0.261315, 0.528120, 0.925781),
  float4(0.031373, 0.257255, 0.522092, 0.929688),
  float4(0.031373, 0.253195, 0.516063, 0.933594),
  float4(0.031373, 0.249135, 0.510035, 0.937500),
  float4(0.031373, 0.245075, 0.504006, 0.941406),
  float4(0.031373, 0.241015, 0.497978, 0.945312),
  float4(0.031373, 0.236955, 0.491949, 0.949219),
  float4(0.031373, 0.232895, 0.485921, 0.953125),
  float4(0.031373, 0.228835, 0.479892, 0.957031),
  float4(0.031373, 0.224775, 0.473864, 0.960938),
  float4(0.031373, 0.220715, 0.467835, 0.964844),
  float4(0.031373, 0.216655, 0.461807, 0.968750),
  float4(0.031373, 0.212595, 0.455779, 0.972656),
  float4(0.031373, 0.208535, 0.449750, 0.976562),
  float4(0.031373, 0.204475, 0.443722, 0.980469),
  float4(0.031373, 0.200415, 0.437693, 0.984375),
  float4(0.031373, 0.196355, 0.431665, 0.988281),
  float4(0.031373, 0.192295, 0.425636, 0.992188),
  float4(0.031373, 0.188235, 0.419608, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::PurplesTransferFunction
{
  float4(0.988235, 0.984314, 0.992157, 0.000000),
  float4(0.986636, 0.982591, 0.991173, 0.003906),
  float4(0.985037, 0.980869, 0.990188, 0.007812),
  float4(0.983437, 0.979146, 0.989204, 0.011719),
  float4(0.981838, 0.977424, 0.988220, 0.015625),
  float4(0.980238, 0.975702, 0.987236, 0.019531),
  float4(0.978639, 0.973979, 0.986251, 0.023438),
  float4(0.977040, 0.972257, 0.985267, 0.027344),
  float4(0.975440, 0.970534, 0.984283, 0.031250),
  float4(0.973841, 0.968812, 0.983299, 0.035156),
  float4(0.972241, 0.967090, 0.982314, 0.039062),
  float4(0.970642, 0.965367, 0.981330, 0.042969),
  float4(0.969043, 0.963645, 0.980346, 0.046875),
  float4(0.967443, 0.961922, 0.979362, 0.050781),
  float4(0.965844, 0.960200, 0.978378, 0.054688),
  float4(0.964245, 0.958478, 0.977393, 0.058594),
  float4(0.962645, 0.956755, 0.976409, 0.062500),
  float4(0.961046, 0.955033, 0.975425, 0.066406),
  float4(0.959446, 0.953310, 0.974441, 0.070312),
  float4(0.957847, 0.951588, 0.973456, 0.074219),
  float4(0.956248, 0.949865, 0.972472, 0.078125),
  float4(0.954648, 0.948143, 0.971488, 0.082031),
  float4(0.953049, 0.946421, 0.970504, 0.085938),
  float4(0.951449, 0.944698, 0.969519, 0.089844),
  float4(0.949850, 0.942976, 0.968535, 0.093750),
  float4(0.948251, 0.941253, 0.967551, 0.097656),
  float4(0.946651, 0.939531, 0.966567, 0.101562),
  float4(0.945052, 0.937809, 0.965582, 0.105469),
  float4(0.943453, 0.936086, 0.964598, 0.109375),
  float4(0.941853, 0.934364, 0.963614, 0.113281),
  float4(0.940254, 0.932641, 0.962630, 0.117188),
  float4(0.938654, 0.930919, 0.961646, 0.121094),
  float4(0.936932, 0.929120, 0.960631, 0.125000),
  float4(0.934348, 0.926782, 0.959400, 0.128906),
  float4(0.931765, 0.924444, 0.958170, 0.132812),
  float4(0.929181, 0.922107, 0.956940, 0.136719),
  float4(0.926597, 0.919769, 0.955709, 0.140625),
  float4(0.924014, 0.917432, 0.954479, 0.144531),
  float4(0.921430, 0.915094, 0.953249, 0.148438),
  float4(0.918847, 0.912757, 0.952018, 0.152344),
  float4(0.916263, 0.910419, 0.950788, 0.156250),
  float4(0.913679, 0.908082, 0.949558, 0.160156),
  float4(0.911096, 0.905744, 0.948328, 0.164062),
  float4(0.908512, 0.903406, 0.947097, 0.167969),
  float4(0.905928, 0.901069, 0.945867, 0.171875),
  float4(0.903345, 0.898731, 0.944637, 0.175781),
  float4(0.900761, 0.896394, 0.943406, 0.179688),
  float4(0.898178, 0.894056, 0.942176, 0.183594),
  float4(0.895594, 0.891719, 0.940946, 0.187500),
  float4(0.893010, 0.889381, 0.939715, 0.191406),
  float4(0.890427, 0.887043, 0.938485, 0.195312),
  float4(0.887843, 0.884706, 0.937255, 0.199219),
  float4(0.885260, 0.882368, 0.936025, 0.203125),
  float4(0.882676, 0.880031, 0.934794, 0.207031),
  float4(0.880092, 0.877693, 0.933564, 0.210938),
  float4(0.877509, 0.875356, 0.932334, 0.214844),
  float4(0.874925, 0.873018, 0.931103, 0.218750),
  float4(0.872341, 0.870681, 0.929873, 0.222656),
  float4(0.869758, 0.868343, 0.928643, 0.226562),
  float4(0.867174, 0.866005, 0.927413, 0.230469),
  float4(0.864591, 0.863668, 0.926182, 0.234375),
  float4(0.862007, 0.861330, 0.924952, 0.238281),
  float4(0.859423, 0.858993, 0.923722, 0.242188),
  float4(0.856840, 0.856655, 0.922491, 0.246094),
  float4(0.853979, 0.854010, 0.921107, 0.250000),
  float4(0.850288, 0.850442, 0.919262, 0.253906),
  float4(0.846597, 0.846874, 0.917416, 0.257812),
  float4(0.842907, 0.843306, 0.915571, 0.261719),
  float4(0.839216, 0.839739, 0.913725, 0.265625),
  float4(0.835525, 0.836171, 0.911880, 0.269531),
  float4(0.831834, 0.832603, 0.910035, 0.273438),
  float4(0.828143, 0.829035, 0.908189, 0.277344),
  float4(0.824452, 0.825467, 0.906344, 0.281250),
  float4(0.820761, 0.821899, 0.904498, 0.285156),
  float4(0.817070, 0.818331, 0.902653, 0.289062),
  float4(0.813379, 0.814764, 0.900807, 0.292969),
  float4(0.809689, 0.811196, 0.898962, 0.296875),
  float4(0.805998, 0.807628, 0.897116, 0.300781),
  float4(0.802307, 0.804060, 0.895271, 0.304688),
  float4(0.798616, 0.800492, 0.893426, 0.308594),
  float4(0.794925, 0.796924, 0.891580, 0.312500),
  float4(0.791234, 0.793356, 0.889735, 0.316406),
  float4(0.787543, 0.789789, 0.887889, 0.320312),
  float4(0.783852, 0.786221, 0.886044, 0.324219),
  float4(0.780161, 0.782653, 0.884198, 0.328125),
  float4(0.776471, 0.779085, 0.882353, 0.332031),
  float4(0.772780, 0.775517, 0.880507, 0.335938),
  float4(0.769089, 0.771949, 0.878662, 0.339844),
  float4(0.765398, 0.768381, 0.876817, 0.343750),
  float4(0.761707, 0.764814, 0.874971, 0.347656),
  float4(0.758016, 0.761246, 0.873126, 0.351562),
  float4(0.754325, 0.757678, 0.871280, 0.355469),
  float4(0.750634, 0.754110, 0.869435, 0.359375),
  float4(0.746943, 0.750542, 0.867589, 0.363281),
  float4(0.743253, 0.746974, 0.865744, 0.367188),
  float4(0.739562, 0.743406, 0.863899, 0.371094),
  float4(0.735871, 0.739562, 0.861822, 0.375000),
  float4(0.732180, 0.735256, 0.859362, 0.378906),
  float4(0.728489, 0.730950, 0.856901, 0.382812),
  float4(0.724798, 0.726644, 0.854441, 0.386719),
  float4(0.721107, 0.722338, 0.851980, 0.390625),
  float4(0.717416, 0.718032, 0.849519, 0.394531),
  float4(0.713725, 0.713725, 0.847059, 0.398438),
  float4(0.710035, 0.709419, 0.844598, 0.402344),
  float4(0.706344, 0.705113, 0.842138, 0.406250),
  float4(0.702653, 0.700807, 0.839677, 0.410156),
  float4(0.698962, 0.696501, 0.837216, 0.414062),
  float4(0.695271, 0.692195, 0.834756, 0.417969),
  float4(0.691580, 0.687889, 0.832295, 0.421875),
  float4(0.687889, 0.683583, 0.829835, 0.425781),
  float4(0.684198, 0.679277, 0.827374, 0.429688),
  float4(0.680508, 0.674971, 0.824913, 0.433594),
  float4(0.676817, 0.670665, 0.822453, 0.437500),
  float4(0.673126, 0.666359, 0.819992, 0.441406),
  float4(0.669435, 0.662053, 0.817532, 0.445312),
  float4(0.665744, 0.657747, 0.815071, 0.449219),
  float4(0.662053, 0.653441, 0.812611, 0.453125),
  float4(0.658362, 0.649135, 0.810150, 0.457031),
  float4(0.654671, 0.644829, 0.807689, 0.460938),
  float4(0.650980, 0.640523, 0.805229, 0.464844),
  float4(0.647289, 0.636217, 0.802768, 0.468750),
  float4(0.643599, 0.631911, 0.800308, 0.472656),
  float4(0.639908, 0.627605, 0.797847, 0.476562),
  float4(0.636217, 0.623299, 0.795386, 0.480469),
  float4(0.632526, 0.618993, 0.792926, 0.484375),
  float4(0.628835, 0.614687, 0.790465, 0.488281),
  float4(0.625144, 0.610381, 0.788005, 0.492188),
  float4(0.621453, 0.606075, 0.785544, 0.496094),
  float4(0.617762, 0.602138, 0.783453, 0.500000),
  float4(0.614072, 0.598570, 0.781730, 0.503906),
  float4(0.610381, 0.595002, 0.780008, 0.507812),
  float4(0.606690, 0.591434, 0.778285, 0.511719),
  float4(0.602999, 0.587866, 0.776563, 0.515625),
  float4(0.599308, 0.584298, 0.774840, 0.519531),
  float4(0.595617, 0.580730, 0.773118, 0.523438),
  float4(0.591926, 0.577163, 0.771396, 0.527344),
  float4(0.588235, 0.573595, 0.769673, 0.531250),
  float4(0.584544, 0.570027, 0.767951, 0.535156),
  float4(0.580854, 0.566459, 0.766228, 0.539062),
  float4(0.577163, 0.562891, 0.764506, 0.542969),
  float4(0.573472, 0.559323, 0.762784, 0.546875),
  float4(0.569781, 0.555755, 0.761061, 0.550781),
  float4(0.566090, 0.552188, 0.759339, 0.554688),
  float4(0.562399, 0.548620, 0.757616, 0.558594),
  float4(0.558708, 0.545052, 0.755894, 0.562500),
  float4(0.555017, 0.541484, 0.754171, 0.566406),
  float4(0.551326, 0.537916, 0.752449, 0.570312),
  float4(0.547636, 0.534348, 0.750727, 0.574219),
  float4(0.543945, 0.530780, 0.749004, 0.578125),
  float4(0.540254, 0.527213, 0.747282, 0.582031),
  float4(0.536563, 0.523645, 0.745559, 0.585938),
  float4(0.532872, 0.520077, 0.743837, 0.589844),
  float4(0.529181, 0.516509, 0.742115, 0.593750),
  float4(0.525490, 0.512941, 0.740392, 0.597656),
  float4(0.521799, 0.509373, 0.738670, 0.601562),
  float4(0.518108, 0.505805, 0.736947, 0.605469),
  float4(0.514418, 0.502238, 0.735225, 0.609375),
  float4(0.510727, 0.498670, 0.733502, 0.613281),
  float4(0.507036, 0.495102, 0.731780, 0.617188),
  float4(0.503345, 0.491534, 0.730058, 0.621094),
  float4(0.500269, 0.486813, 0.727643, 0.625000),
  float4(0.497562, 0.481399, 0.724814, 0.628906),
  float4(0.494856, 0.475986, 0.721984, 0.632812),
  float4(0.492149, 0.470573, 0.719154, 0.636719),
  float4(0.489443, 0.465160, 0.716324, 0.640625),
  float4(0.486736, 0.459746, 0.713495, 0.644531),
  float4(0.484029, 0.454333, 0.710665, 0.648438),
  float4(0.481323, 0.448920, 0.707835, 0.652344),
  float4(0.478616, 0.443506, 0.705006, 0.656250),
  float4(0.475909, 0.438093, 0.702176, 0.660156),
  float4(0.473203, 0.432680, 0.699346, 0.664062),
  float4(0.470496, 0.427266, 0.696517, 0.667969),
  float4(0.467789, 0.421853, 0.693687, 0.671875),
  float4(0.465083, 0.416440, 0.690857, 0.675781),
  float4(0.462376, 0.411027, 0.688028, 0.679688),
  float4(0.459669, 0.405613, 0.685198, 0.683594),
  float4(0.456963, 0.400200, 0.682368, 0.687500),
  float4(0.454256, 0.394787, 0.679539, 0.691406),
  float4(0.451549, 0.389373, 0.676709, 0.695312),
  float4(0.448843, 0.383960, 0.673879, 0.699219),
  float4(0.446136, 0.378547, 0.671050, 0.703125),
  float4(0.443429, 0.373133, 0.668220, 0.707031),
  float4(0.440723, 0.367720, 0.665390, 0.710938),
  float4(0.438016, 0.362307, 0.662561, 0.714844),
  float4(0.435310, 0.356893, 0.659731, 0.718750),
  float4(0.432603, 0.351480, 0.656901, 0.722656),
  float4(0.429896, 0.346067, 0.654072, 0.726562),
  float4(0.427190, 0.340654, 0.651242, 0.730469),
  float4(0.424483, 0.335240, 0.648412, 0.734375),
  float4(0.421776, 0.329827, 0.645582, 0.738281),
  float4(0.419070, 0.324414, 0.642753, 0.742188),
  float4(0.416363, 0.319000, 0.639923, 0.746094),
  float4(0.413656, 0.313772, 0.637370, 0.750000),
  float4(0.410950, 0.308604, 0.634910, 0.753906),
  float4(0.408243, 0.303437, 0.632449, 0.757812),
  float4(0.405536, 0.298270, 0.629988, 0.761719),
  float4(0.402830, 0.293103, 0.627528, 0.765625),
  float4(0.400123, 0.287935, 0.625067, 0.769531),
  float4(0.397416, 0.282768, 0.622607, 0.773438),
  float4(0.394710, 0.277601, 0.620146, 0.777344),
  float4(0.392003, 0.272434, 0.617686, 0.781250),
  float4(0.389296, 0.267266, 0.615225, 0.785156),
  float4(0.386590, 0.262099, 0.612764, 0.789062),
  float4(0.383883, 0.256932, 0.610304, 0.792969),
  float4(0.381176, 0.251765, 0.607843, 0.796875),
  float4(0.378470, 0.246597, 0.605383, 0.800781),
  float4(0.375763, 0.241430, 0.602922, 0.804688),
  float4(0.373057, 0.236263, 0.600461, 0.808594),
  float4(0.370350, 0.231096, 0.598001, 0.812500),
  float4(0.367643, 0.225928, 0.595540, 0.816406),
  float4(0.364937, 0.220761, 0.593080, 0.820312),
  float4(0.362230, 0.215594, 0.590619, 0.824219),
  float4(0.359523, 0.210427, 0.588158, 0.828125),
  float4(0.356817, 0.205260, 0.585698, 0.832031),
  float4(0.354110, 0.200092, 0.583237, 0.835938),
  float4(0.351403, 0.194925, 0.580777, 0.839844),
  float4(0.348697, 0.189758, 0.578316, 0.843750),
  float4(0.345990, 0.184591, 0.575855, 0.847656),
  float4(0.343283, 0.179423, 0.573395, 0.851562),
  float4(0.340577, 0.174256, 0.570934, 0.855469),
  float4(0.337870, 0.169089, 0.568474, 0.859375),
  float4(0.335163, 0.163922, 0.566013, 0.863281),
  float4(0.332457, 0.158754, 0.563552, 0.867188),
  float4(0.329750, 0.153587, 0.561092, 0.871094),
  float4(0.327151, 0.148743, 0.558847, 0.875000),
  float4(0.324567, 0.143945, 0.556632, 0.878906),
  float4(0.321984, 0.139146, 0.554418, 0.882812),
  float4(0.319400, 0.134348, 0.552203, 0.886719),
  float4(0.316817, 0.129550, 0.549988, 0.890625),
  float4(0.314233, 0.124752, 0.547774, 0.894531),
  float4(0.311649, 0.119954, 0.545559, 0.898438),
  float4(0.309066, 0.115156, 0.543345, 0.902344),
  float4(0.306482, 0.110358, 0.541130, 0.906250),
  float4(0.303899, 0.105559, 0.538916, 0.910156),
  float4(0.301315, 0.100761, 0.536701, 0.914062),
  float4(0.298731, 0.095963, 0.534487, 0.917969),
  float4(0.296148, 0.091165, 0.532272, 0.921875),
  float4(0.293564, 0.086367, 0.530058, 0.925781),
  float4(0.290980, 0.081569, 0.527843, 0.929688),
  float4(0.288397, 0.076770, 0.525629, 0.933594),
  float4(0.285813, 0.071972, 0.523414, 0.937500),
  float4(0.283230, 0.067174, 0.521200, 0.941406),
  float4(0.280646, 0.062376, 0.518985, 0.945312),
  float4(0.278062, 0.057578, 0.516770, 0.949219),
  float4(0.275479, 0.052780, 0.514556, 0.953125),
  float4(0.272895, 0.047982, 0.512341, 0.957031),
  float4(0.270311, 0.043183, 0.510127, 0.960938),
  float4(0.267728, 0.038385, 0.507912, 0.964844),
  float4(0.265144, 0.033587, 0.505698, 0.968750),
  float4(0.262561, 0.028789, 0.503483, 0.972656),
  float4(0.259977, 0.023991, 0.501269, 0.976562),
  float4(0.257393, 0.019193, 0.499054, 0.980469),
  float4(0.254810, 0.014394, 0.496840, 0.984375),
  float4(0.252226, 0.009596, 0.494625, 0.988281),
  float4(0.249642, 0.004798, 0.492411, 0.992188),
  float4(0.247059, 0.000000, 0.490196, 1.000000)
};

std::array<float4, 256> OpenGLEnergyVolumeRenderedSurface::OrangesTransferFunction
{
  float4(1.000000, 0.960784, 0.921569, 0.000000),
  float4(0.999877, 0.958939, 0.918001, 0.003906),
  float4(0.999754, 0.957093, 0.914433, 0.007812),
  float4(0.999631, 0.955248, 0.910865, 0.011719),
  float4(0.999508, 0.953403, 0.907297, 0.015625),
  float4(0.999385, 0.951557, 0.903729, 0.019531),
  float4(0.999262, 0.949712, 0.900161, 0.023438),
  float4(0.999139, 0.947866, 0.896594, 0.027344),
  float4(0.999016, 0.946021, 0.893026, 0.031250),
  float4(0.998893, 0.944175, 0.889458, 0.035156),
  float4(0.998770, 0.942330, 0.885890, 0.039062),
  float4(0.998647, 0.940484, 0.882322, 0.042969),
  float4(0.998524, 0.938639, 0.878754, 0.046875),
  float4(0.998401, 0.936794, 0.875186, 0.050781),
  float4(0.998278, 0.934948, 0.871619, 0.054688),
  float4(0.998155, 0.933103, 0.868051, 0.058594),
  float4(0.998032, 0.931257, 0.864483, 0.062500),
  float4(0.997908, 0.929412, 0.860915, 0.066406),
  float4(0.997785, 0.927566, 0.857347, 0.070312),
  float4(0.997662, 0.925721, 0.853779, 0.074219),
  float4(0.997539, 0.923875, 0.850211, 0.078125),
  float4(0.997416, 0.922030, 0.846644, 0.082031),
  float4(0.997293, 0.920185, 0.843076, 0.085938),
  float4(0.997170, 0.918339, 0.839508, 0.089844),
  float4(0.997047, 0.916494, 0.835940, 0.093750),
  float4(0.996924, 0.914648, 0.832372, 0.097656),
  float4(0.996801, 0.912803, 0.828804, 0.101562),
  float4(0.996678, 0.910957, 0.825236, 0.105469),
  float4(0.996555, 0.909112, 0.821669, 0.109375),
  float4(0.996432, 0.907266, 0.818101, 0.113281),
  float4(0.996309, 0.905421, 0.814533, 0.117188),
  float4(0.996186, 0.903576, 0.810965, 0.121094),
  float4(0.996063, 0.901622, 0.807166, 0.125000),
  float4(0.995940, 0.898916, 0.801753, 0.128906),
  float4(0.995817, 0.896209, 0.796340, 0.132812),
  float4(0.995694, 0.893502, 0.790927, 0.136719),
  float4(0.995571, 0.890796, 0.785513, 0.140625),
  float4(0.995448, 0.888089, 0.780100, 0.144531),
  float4(0.995325, 0.885383, 0.774687, 0.148438),
  float4(0.995202, 0.882676, 0.769273, 0.152344),
  float4(0.995079, 0.879969, 0.763860, 0.156250),
  float4(0.994956, 0.877263, 0.758447, 0.160156),
  float4(0.994833, 0.874556, 0.753033, 0.164062),
  float4(0.994710, 0.871849, 0.747620, 0.167969),
  float4(0.994587, 0.869143, 0.742207, 0.171875),
  float4(0.994464, 0.866436, 0.736794, 0.175781),
  float4(0.994341, 0.863729, 0.731380, 0.179688),
  float4(0.994218, 0.861023, 0.725967, 0.183594),
  float4(0.994095, 0.858316, 0.720554, 0.187500),
  float4(0.993972, 0.855609, 0.715140, 0.191406),
  float4(0.993849, 0.852903, 0.709727, 0.195312),
  float4(0.993725, 0.850196, 0.704314, 0.199219),
  float4(0.993602, 0.847489, 0.698900, 0.203125),
  float4(0.993479, 0.844783, 0.693487, 0.207031),
  float4(0.993356, 0.842076, 0.688074, 0.210938),
  float4(0.993233, 0.839369, 0.682661, 0.214844),
  float4(0.993110, 0.836663, 0.677247, 0.218750),
  float4(0.992987, 0.833956, 0.671834, 0.222656),
  float4(0.992864, 0.831250, 0.666421, 0.226562),
  float4(0.992741, 0.828543, 0.661007, 0.230469),
  float4(0.992618, 0.825836, 0.655594, 0.234375),
  float4(0.992495, 0.823130, 0.650181, 0.238281),
  float4(0.992372, 0.820423, 0.644767, 0.242188),
  float4(0.992249, 0.817716, 0.639354, 0.246094),
  float4(0.992157, 0.814641, 0.633602, 0.250000),
  float4(0.992157, 0.810458, 0.626836, 0.253906),
  float4(0.992157, 0.806275, 0.620069, 0.257812),
  float4(0.992157, 0.802091, 0.613303, 0.261719),
  float4(0.992157, 0.797909, 0.606536, 0.265625),
  float4(0.992157, 0.793725, 0.599769, 0.269531),
  float4(0.992157, 0.789542, 0.593003, 0.273438),
  float4(0.992157, 0.785359, 0.586236, 0.277344),
  float4(0.992157, 0.781176, 0.579469, 0.281250),
  float4(0.992157, 0.776993, 0.572703, 0.285156),
  float4(0.992157, 0.772810, 0.565936, 0.289062),
  float4(0.992157, 0.768627, 0.559170, 0.292969),
  float4(0.992157, 0.764444, 0.552403, 0.296875),
  float4(0.992157, 0.760261, 0.545636, 0.300781),
  float4(0.992157, 0.756078, 0.538870, 0.304688),
  float4(0.992157, 0.751895, 0.532103, 0.308594),
  float4(0.992157, 0.747712, 0.525336, 0.312500),
  float4(0.992157, 0.743529, 0.518570, 0.316406),
  float4(0.992157, 0.739346, 0.511803, 0.320312),
  float4(0.992157, 0.735163, 0.505037, 0.324219),
  float4(0.992157, 0.730980, 0.498270, 0.328125),
  float4(0.992157, 0.726797, 0.491503, 0.332031),
  float4(0.992157, 0.722614, 0.484737, 0.335938),
  float4(0.992157, 0.718431, 0.477970, 0.339844),
  float4(0.992157, 0.714248, 0.471203, 0.343750),
  float4(0.992157, 0.710065, 0.464437, 0.347656),
  float4(0.992157, 0.705882, 0.457670, 0.351562),
  float4(0.992157, 0.701699, 0.450904, 0.355469),
  float4(0.992157, 0.697516, 0.444137, 0.359375),
  float4(0.992157, 0.693333, 0.437370, 0.363281),
  float4(0.992157, 0.689150, 0.430604, 0.367188),
  float4(0.992157, 0.684967, 0.423837, 0.371094),
  float4(0.992157, 0.680830, 0.417439, 0.375000),
  float4(0.992157, 0.676770, 0.411657, 0.378906),
  float4(0.992157, 0.672710, 0.405875, 0.382812),
  float4(0.992157, 0.668651, 0.400092, 0.386719),
  float4(0.992157, 0.664591, 0.394310, 0.390625),
  float4(0.992157, 0.660531, 0.388527, 0.394531),
  float4(0.992157, 0.656471, 0.382745, 0.398438),
  float4(0.992157, 0.652411, 0.376963, 0.402344),
  float4(0.992157, 0.648351, 0.371180, 0.406250),
  float4(0.992157, 0.644291, 0.365398, 0.410156),
  float4(0.992157, 0.640231, 0.359616, 0.414062),
  float4(0.992157, 0.636171, 0.353833, 0.417969),
  float4(0.992157, 0.632111, 0.348051, 0.421875),
  float4(0.992157, 0.628051, 0.342268, 0.425781),
  float4(0.992157, 0.623991, 0.336486, 0.429688),
  float4(0.992157, 0.619931, 0.330704, 0.433594),
  float4(0.992157, 0.615871, 0.324921, 0.437500),
  float4(0.992157, 0.611811, 0.319139, 0.441406),
  float4(0.992157, 0.607751, 0.313356, 0.445312),
  float4(0.992157, 0.603691, 0.307574, 0.449219),
  float4(0.992157, 0.599631, 0.301792, 0.453125),
  float4(0.992157, 0.595571, 0.296009, 0.457031),
  float4(0.992157, 0.591511, 0.290227, 0.460938),
  float4(0.992157, 0.587451, 0.284444, 0.464844),
  float4(0.992157, 0.583391, 0.278662, 0.468750),
  float4(0.992157, 0.579331, 0.272880, 0.472656),
  float4(0.992157, 0.575271, 0.267097, 0.476562),
  float4(0.992157, 0.571211, 0.261315, 0.480469),
  float4(0.992157, 0.567151, 0.255532, 0.484375),
  float4(0.992157, 0.563091, 0.249750, 0.488281),
  float4(0.992157, 0.559031, 0.243968, 0.492188),
  float4(0.992157, 0.554971, 0.238185, 0.496094),
  float4(0.991419, 0.550727, 0.232772, 0.500000),
  float4(0.989942, 0.546298, 0.227728, 0.503906),
  float4(0.988466, 0.541869, 0.222684, 0.507812),
  float4(0.986990, 0.537439, 0.217639, 0.511719),
  float4(0.985513, 0.533010, 0.212595, 0.515625),
  float4(0.984037, 0.528581, 0.207551, 0.519531),
  float4(0.982561, 0.524152, 0.202507, 0.523438),
  float4(0.981084, 0.519723, 0.197463, 0.527344),
  float4(0.979608, 0.515294, 0.192418, 0.531250),
  float4(0.978131, 0.510865, 0.187374, 0.535156),
  float4(0.976655, 0.506436, 0.182330, 0.539062),
  float4(0.975179, 0.502007, 0.177286, 0.542969),
  float4(0.973702, 0.497578, 0.172241, 0.546875),
  float4(0.972226, 0.493149, 0.167197, 0.550781),
  float4(0.970750, 0.488720, 0.162153, 0.554688),
  float4(0.969273, 0.484291, 0.157109, 0.558594),
  float4(0.967797, 0.479862, 0.152065, 0.562500),
  float4(0.966321, 0.475433, 0.147020, 0.566406),
  float4(0.964844, 0.471003, 0.141976, 0.570312),
  float4(0.963368, 0.466574, 0.136932, 0.574219),
  float4(0.961892, 0.462145, 0.131888, 0.578125),
  float4(0.960415, 0.457716, 0.126844, 0.582031),
  float4(0.958939, 0.453287, 0.121799, 0.585938),
  float4(0.957463, 0.448858, 0.116755, 0.589844),
  float4(0.955986, 0.444429, 0.111711, 0.593750),
  float4(0.954510, 0.440000, 0.106667, 0.597656),
  float4(0.953033, 0.435571, 0.101622, 0.601562),
  float4(0.951557, 0.431142, 0.096578, 0.605469),
  float4(0.950081, 0.426713, 0.091534, 0.609375),
  float4(0.948604, 0.422284, 0.086490, 0.613281),
  float4(0.947128, 0.417855, 0.081446, 0.617188),
  float4(0.945652, 0.413426, 0.076401, 0.621094),
  float4(0.943253, 0.409227, 0.073126, 0.625000),
  float4(0.940300, 0.405167, 0.070911, 0.628906),
  float4(0.937347, 0.401107, 0.068697, 0.632812),
  float4(0.934394, 0.397047, 0.066482, 0.636719),
  float4(0.931442, 0.392987, 0.064268, 0.640625),
  float4(0.928489, 0.388927, 0.062053, 0.644531),
  float4(0.925536, 0.384867, 0.059839, 0.648438),
  float4(0.922584, 0.380807, 0.057624, 0.652344),
  float4(0.919631, 0.376747, 0.055409, 0.656250),
  float4(0.916678, 0.372687, 0.053195, 0.660156),
  float4(0.913725, 0.368627, 0.050980, 0.664062),
  float4(0.910773, 0.364567, 0.048766, 0.667969),
  float4(0.907820, 0.360507, 0.046551, 0.671875),
  float4(0.904867, 0.356448, 0.044337, 0.675781),
  float4(0.901915, 0.352388, 0.042122, 0.679688),
  float4(0.898962, 0.348328, 0.039908, 0.683594),
  float4(0.896009, 0.344268, 0.037693, 0.687500),
  float4(0.893057, 0.340208, 0.035479, 0.691406),
  float4(0.890104, 0.336148, 0.033264, 0.695312),
  float4(0.887151, 0.332088, 0.031050, 0.699219),
  float4(0.884198, 0.328028, 0.028835, 0.703125),
  float4(0.881246, 0.323968, 0.026621, 0.707031),
  float4(0.878293, 0.319908, 0.024406, 0.710938),
  float4(0.875340, 0.315848, 0.022191, 0.714844),
  float4(0.872388, 0.311788, 0.019977, 0.718750),
  float4(0.869435, 0.307728, 0.017762, 0.722656),
  float4(0.866482, 0.303668, 0.015548, 0.726562),
  float4(0.863529, 0.299608, 0.013333, 0.730469),
  float4(0.860577, 0.295548, 0.011119, 0.734375),
  float4(0.857624, 0.291488, 0.008904, 0.738281),
  float4(0.854671, 0.287428, 0.006690, 0.742188),
  float4(0.851719, 0.283368, 0.004475, 0.746094),
  float4(0.846275, 0.280692, 0.004106, 0.750000),
  float4(0.840000, 0.278478, 0.004352, 0.753906),
  float4(0.833725, 0.276263, 0.004598, 0.757812),
  float4(0.827451, 0.274048, 0.004844, 0.761719),
  float4(0.821176, 0.271834, 0.005090, 0.765625),
  float4(0.814902, 0.269619, 0.005336, 0.769531),
  float4(0.808627, 0.267405, 0.005582, 0.773438),
  float4(0.802353, 0.265190, 0.005829, 0.777344),
  float4(0.796078, 0.262976, 0.006075, 0.781250),
  float4(0.789804, 0.260761, 0.006321, 0.785156),
  float4(0.783529, 0.258547, 0.006567, 0.789062),
  float4(0.777255, 0.256332, 0.006813, 0.792969),
  float4(0.770980, 0.254118, 0.007059, 0.796875),
  float4(0.764706, 0.251903, 0.007305, 0.800781),
  float4(0.758431, 0.249689, 0.007551, 0.804688),
  float4(0.752157, 0.247474, 0.007797, 0.808594),
  float4(0.745882, 0.245260, 0.008043, 0.812500),
  float4(0.739608, 0.243045, 0.008289, 0.816406),
  float4(0.733333, 0.240830, 0.008535, 0.820312),
  float4(0.727059, 0.238616, 0.008781, 0.824219),
  float4(0.720784, 0.236401, 0.009027, 0.828125),
  float4(0.714510, 0.234187, 0.009273, 0.832031),
  float4(0.708235, 0.231972, 0.009519, 0.835938),
  float4(0.701961, 0.229758, 0.009765, 0.839844),
  float4(0.695686, 0.227543, 0.010012, 0.843750),
  float4(0.689412, 0.225329, 0.010258, 0.847656),
  float4(0.683137, 0.223114, 0.010504, 0.851562),
  float4(0.676863, 0.220900, 0.010750, 0.855469),
  float4(0.670588, 0.218685, 0.010996, 0.859375),
  float4(0.664314, 0.216471, 0.011242, 0.863281),
  float4(0.658039, 0.214256, 0.011488, 0.867188),
  float4(0.651765, 0.212042, 0.011734, 0.871094),
  float4(0.646782, 0.210150, 0.011872, 0.875000),
  float4(0.641984, 0.208305, 0.011995, 0.878906),
  float4(0.637186, 0.206459, 0.012118, 0.882812),
  float4(0.632388, 0.204614, 0.012241, 0.886719),
  float4(0.627589, 0.202768, 0.012364, 0.890625),
  float4(0.622791, 0.200923, 0.012488, 0.894531),
  float4(0.617993, 0.199077, 0.012611, 0.898438),
  float4(0.613195, 0.197232, 0.012734, 0.902344),
  float4(0.608397, 0.195386, 0.012857, 0.906250),
  float4(0.603599, 0.193541, 0.012980, 0.910156),
  float4(0.598800, 0.191695, 0.013103, 0.914062),
  float4(0.594002, 0.189850, 0.013226, 0.917969),
  float4(0.589204, 0.188005, 0.013349, 0.921875),
  float4(0.584406, 0.186159, 0.013472, 0.925781),
  float4(0.579608, 0.184314, 0.013595, 0.929688),
  float4(0.574810, 0.182468, 0.013718, 0.933594),
  float4(0.570012, 0.180623, 0.013841, 0.937500),
  float4(0.565213, 0.178777, 0.013964, 0.941406),
  float4(0.560415, 0.176932, 0.014087, 0.945312),
  float4(0.555617, 0.175087, 0.014210, 0.949219),
  float4(0.550819, 0.173241, 0.014333, 0.953125),
  float4(0.546021, 0.171396, 0.014456, 0.957031),
  float4(0.541223, 0.169550, 0.014579, 0.960938),
  float4(0.536424, 0.167705, 0.014702, 0.964844),
  float4(0.531626, 0.165859, 0.014825, 0.968750),
  float4(0.526828, 0.164014, 0.014948, 0.972656),
  float4(0.522030, 0.162168, 0.015071, 0.976562),
  float4(0.517232, 0.160323, 0.015194, 0.980469),
  float4(0.512434, 0.158478, 0.015317, 0.984375),
  float4(0.507636, 0.156632, 0.015440, 0.988281),
  float4(0.502837, 0.154787, 0.015563, 0.992188),
  float4(0.498039, 0.152941, 0.015686, 1.000000)
};
